using Microsoft.VisualStudio.TestTools.UnitTesting;
using Lab2.Models.Alphabets;
using Lab2.Cipher;

namespace Lab2Tests;

[TestClass]
public class VigenereCipherTests
{
    private Alphabet _russianAlphabet;

    [TestInitialize]
    public void Setup()
    {
        _russianAlphabet = AlphabetFactory.CreateRussianAlphabet();
    }

    [TestMethod]
    public void Cryptanalyze_Test1()
    {
        string ciphertext = "НЛАЦВРРФРНЕЩЧССАКЩНПРРЫУЕЛУЯЦНИФФЯЖНЩХСЗВЛЪНВРРФЦНЕЧФЩФОНРЖБУЫХЯГОЫЦВТАУАЩР\r\nОВИЪШЕОЦБАСЪШЯСТЫИЮЕНУЗЭОЖШЦТЫЛЩЙМЗАПИГЬСККЯПРЩЩЯМОЭЦЭКАХРАОЧРФДЭТЩЧБОИЬЭЯ\r\nДИЭТСКСЩЦГНОЬЗГСЯНФЩФЕНГЭЫСРУЩФАХЪИТОЛТГИВУПЩРУРЪХАНШЫПЛЮПЗЭОТННЫАСЪЦВОБШЦВ\r\nТЬХФЩФОЭКЯРЧРЩГВУЪЦГРЕМХЯСТЗУЩЗАЪЦЬНИЭДЯБРЛПЯВАНАДЮСКЧЯТЕЧРЬИИШГЭПРУЯЩНАЧЧДСТ\r\nЩЪДВИАОЩЗНУЫВИЛУЗЬИМЛЩВМЕПРСКУЦДГИВУШДЮЩУЭЩНТРШЦСКТХСМЕШРГОСЭЗЭСОЬЦТЫМЮЧЯР\r\nОЧХСИНЭРЭНЫРИШАЧЛЩГУЮУЧБОСЭЦФРЯТХМЕПЩМБОБШЦВТИНЛЬЯДЖКСЯСЗКШНАХЦЭЫЕВНБТЫЧГУИ\r\nДУФЫАКЩХЩМЕШЗПТСКЧЯСЛЮАЮЫЕННРНИКФУРЕЧНЮИСХКЯЗЬОУРНЕБЧСРАПХЯГОЪЦБТРРЪСВДЫЫФПР\r\nЩЩГУПЛНГКАЫРЫАТЮШСАТЩРВОВЬНЭИНЛЗЕИЗУЦЮОМУЗЩЗОМШСЖЕШРЦКОЦНТЛЕЭЩРЛИБЦДСКЩУНЗ\r\nАРЪУЗЯЭДЖОТКЙМЛЬЙРВАКИШБОЛЦИЭАТРФСТИХИЩСВКБЦННЩЩЬУЖУЪЦЛЯЛКГОРЛМУУХЬТСЗОХЧБИКЦ\r\nЖИЕНУЗСЛИЬГУСТЫИЮЕЧЮМЦСИЛУЩСАНПСЗЕЫТСЛЬРЧБИНРЩЙИХРФДМИЫЦУУЮЬУСВУНЩЦМИТКЦСТ\r\nШЦВКАСНЭЧТЩУНЮИЬТОРРЩУЬОНСНИАРЦДШЛАЭКЩДЖПЦХЖСЩХТЫЛТИВТЕШЯЩВЫЧХЦУКЦЖЧИМТИ\r\nЩКОФРЮЕЛЙМЩМОЧФМЗНЛНЭЧТЩЦЮСКЮЯЮОЧУЪСЛЛРТЗИИПКДХСЦЦУНЕЧЦФСВКПСТЬНЩУЕТЬТЯЙБР\r\nЩЦДЕУУЩШЬНЦТЩЕЬЪУЕДРЪЦЙОСРУЛЯЦЩРИСЭИЮОВУУВЯВПШДГОВЫХОИТЦТРЕЭИГЕЛЗХММИННВЕЛЖ\r\nФБАСЬТСЗЧУТЯММЖПЮАЕЧЯГООШКВЕГПИЖОДУУУЦИЦРЮДРРРАЕРВИГКААЦГЛИВИЬСЯВЦАОРШЦВТЬЙРА\r\nЕДЛХГИЗЧЦЭПИЬИЬМНЩОЦСТНЦАИСРФУОСШЦУНОЧМЦТЯЧШСЗУЧНЦТСКРУОПЦЦКАЛНЩЦБЕНЩЦВИХЪЯР\r\nИЛХВКИРМЯБРЩМЦТЕЦРЩЗВРЩГНОЭИЫЖЕВЪЯПРРКБАЩРХЩЮМЫИИНООЦИУДЛТСВФЛХГАЗРШСИСХИШО\r\nЧШРЫАСЪЦВОБЬЪУОВЛУЩНЕЪШЯСТЩМЦТИЛРВКЛЙЯЩТЕЦДЮОМЛУЦНЬХРЦДЕНЦИКИХТЯТОЫГЭЭТЩЪИУ\r\nДРЩЮЫЙЬТСЗОВХЩКИЬЧМТЫНИЬОУСИВВОНЩЦНЕЩЪЦЧЕЬТЩЙИШЪЦРЕЬПЬОУЪЦГРЕМУРЯДЩКЦРИРФЮА\r\nИНХМХМЛФСШОШЫУЛЕХИЬЮНЖЭВПУЭХЩЦВЫРВКОНИЮНЫРМЬИТРУННЫРЧБОГЮУЫИЗЛЙБАСЖКСЛИАЧ\r\nЩСЬЧИЭИИПИЧЕФЩЪЯГРЛЬЩРОНИЬВОМХСЖЕШХЯМВУМЦВСЮБЮОСЭРЭЫЗШИЦМНРЦХНООЦИЕЛЩКЦКАЛ\r\nМУУХЦДПИСЛТОРРЩУЬАИВИБЛЬТИЬАТНРХЖАПЦХЖСЩХСИЭЭРХВОРЦЫАЗЖКСЮТЬЗАОЧЭРСНТУЧЯДАЧРХ\r\nОДСЩЯНКЛТУИДШЦУЕСЗФСУМРУЯДУЫИИИЛШНХАЛРТЩХСЩКБЕМРХЮИКЩКВКРЖКСЯСНЦПИСЭРЮНУЙЩ\r\nДЩНЩЩГЬПЩМВКУВХЯЙБЦИФОПЫРВТОФХЯЙЛУЯЩНОФХЯИПЫЦЮИЦЛЪЦЛЬШГЭПОЭЦЭКАЧЧБИХЩМЩТС\r\nКХЦЛЕОТЯКЭЫШЯЛЛПКЯИТЬЗУГЛЛПСХНРМСЕТЬЗУРУХРЯНШРУАОЖУПЮИТЛТЩМЛРЛЫИМГИФОМВЪЯНЕЩ\r\nЩГАВУУВЛЕПЦУПОЫИШИТРУННЕФКВЕГЩЪЯЧТЩШЦЧЬУМЦТОВНЬОВРТЦЧЬКОЩЗНЗЙМЛАЬЪЯЛЬЪЦХРОМХ\r\nЯИТДИГЕЛЗХЯДОХЫЭЕНЭРБОВЛХСПОЬУЦЕГЩЩЭЕРЭРЯСТЛУЩСЬПХЦВНУТЩПИЬДЭАВЩЩАОМУХСНИКЩЯ\r\nВРРФЦННУТЯВВЭЦЭЧИЬУЦИЕОЦЮЕКЩЛХАЮШГЖПРУЗГЕЛЗХЩЦКЩЪЯРЫАЦЮНАТГУАЛЧЦЩПОПШДЖКУЧ\r\nЯПРЩЙДЕМЫИШОБЫИГЬСККДДИНРГЕЛЗХМХМРЪСМОЫЬЯЗААТОРРЩУЬОВЬТЯГОЩЙБАЗЛЩБАЗЮОЦПОЬУЦ\r\nСМРШГИЧЛШЬЬЗЛМЯДЖЬЦЮАЕОЦАЛЕЧЗЮНИХЧБЕПЩМЯБНЖСВТЮЛШГДОПОВОНХЦЬЛИШЛУУДУПХАЛЪЦ\r\nХРОМХДЮБУЦФРАЯРПКЭЫШЯЛЛЛЦЮАНЛПМВАЦИВЬТЫИХИЦУЦЮНОСРШНЬУЪУОРВНВТВЩУНЮИЬИЫЭРЫ\r\nЦЬЛАУЪУОРВНВТВЩПХЕСЗЦШНАВИЦТВЬНИТОНГЙЛОУПАОДРЛЯПЕЫИУТОЧЯЩСЛРРАЕРРЧЩСКЮИБХИНЯС\r\nРЛЗПСЛАЭКЩДЖЛМЯДЖЬЦЮАБЖУЯГРЩФЦНВЬЖЧИЗШДЯНКЛТГИПУЯЮЫЙНРЫТОЫРСНЕБКЦЛДШНУНИХРА\r\nИСЛУЭНОСНВТВЩЧЩСЕЧКЮОСККВПЕБРСЛЬШГЪРЕРЩГРВЬЖЯТПЫИУЛЕШХДЮИЪЦЬУЧРХЮОЙХЦБРЕЬЧЯН\r\nДРХЗИЮЬЦИИНКУАОЛУЪЩЧЕЬТЩЕИШИДЧНЖНГРАХЪСТЫЬЪЩХИУЧБОЗЮЩЬОВЩФГРУПХЯДАСНАРЕПЩГА\r\nВУЪНСЕМНЯБЪРФТУМЛОЮОГЩХССЛРМЩЯКЩЪЯРЫФЦВТАЦЩРВРЛЩАОРКОЦНИУМДШЕЪШЩКАТЯЩКОНМ\r\nДШЕЪШЩКАТЯЩКАЧРТЫЛУМУАМЦИХШИАЙБАТЛТОРРЩУЬАУУУЕРЕПРОДВУХЩМЕШХЯУИЦЬБЕДЪЦВЛЕЬФ\r\nЦРТУТОРРЩУЬАССНФЧАЬЪНЕГЩУЩЧНЖЭТУМЛЛУОЗЧЦЧНОНГАОЛШЗРВОЦЖДМЕЫАЦГОНЧЦРЕЪРВКЕЬИЮ\r\nНОФЭЦНДРШВОНЮРЬФРРМХОДСЩЯНУЪЦЭИНЛНГОКЩХУЕРЭИЖГДРЭБАНУУЩСЬЦРИНЫРПСПИЬРЩФОЭЦФР\r\nАЯРЩСНЛМАИСЗЖУСЛЮЯСЕМЩНЪСМРШГИУШРИТОСРГЬНРКВКРЖКСЯНРРВКЛЙЯЦНОВЪЯПИЬИГЕЛЗЦВТАН\r\nРЬИДЫЫФИЕУХВТРЮТЗИИЪЦВЛЕРЛЯСМРШГИКИШБОЛЦИЫОМШИГЫВХШСЙСЭЯЦРЧЭИЫНАТГУАЛУЧБЕПЩ\r\nМСВАЭНЬЬСХРЦКВЛШГИРЖШССПЩУЯЖЕШХМЕВЬИЭОМХЦЬЛЕПОЦКОЭЦБЫЕЩХШАНУФСЛВЭНИЕНУНВТО\r\nЦДЫИХЦНГНАПУЦЖАЦЦВРОВХЯОСНЦТОДУЪНОГЫЦЭНЫФИБХИНТОРРЩУЬАРЛПТИРЛУЩВТЩШЯПЯАЯССТЗ\r\nТСКУСНДПОЧРЮАЛЩЩНБЫЦИВОЖСНЮАОЬЪСЛЬШЦЦПОНЩЦЙВУМЩМОЬЪЩБЫЦЦАОДРУЦНОЧНЧДУЫЦХ\r\nСТННЮНИХИЭИЧЭЦГОВЪЦВЛЕПЩГВИУПСТЕЫЗЬОСЗЧЯВИПРЭОМЮТЯЛЛУХФВУПКЯВРРФРРАМЦГЫНЛМТИО\r\nОШСФИРСЫЭРЫЦЬЛАУФЦЛВЫИВПОЫЗЧЕНУРУСЮРЛЯПЕЫНАИСХЫУСЕПХЦВНУТЩИРРНВТРХЦБРЕЬЧЯНДРХ\r\nЗИИМРЯГРЛЬЩЯСШИТЖЕШИЭНОСНВТВЩФЗИТЛЪЩЗЭЭРЖДОХЫЭЕНЭЦУВЫЪЫВКНУТГОГЩОЦКОЦУЦДЖЛТ\r\nБАЙЬЪИЕРВКЫОТЩШЯМУВРЬСЯЛЧЯТОЧЧБЕПЩМСВАЦНФОДКМПШКЛТБОТХРЪИОМШСЗОНИЮНЫФЩУЯЩР\r\nХЮОСЦЫЧИТРУНСТЙИБТДЩМЧСОШТЯЛЛУХФВУПЩЯЗДЛУЩДЕЛУЩЗИЫЦУАНШГЪПОЫЪБЕТЬКЯЕГЩЧБОСЦ\r\nИУЛЕШХЯГОЫЦХСТННЮНИХИОТАЪНБВАКЙЩОГЫИЕИЯНГЙЕДГИРВСРХГЯБЫНФОДЛЪЯЕСЭДВПУЬЪРВСРЛЯ\r\nСЕЧДЭЕСКЮЦВПЩЩЬЕСЧНБТИХЕБРОЦУССТЛУСОСШЦУНЫЧМЯКУЧНЮТАЦДЮЫМЬКЩДЕЭНЬЬСЭКЯМНЛТЯ\r\nТОЫЦЦОРУНЮТИЫЦУАЛУЩНВСРЧЯСЛРМДЮЩУНТИООШСФЫЩЪИАСЭРОТОЩЙЛЯСШЗЦТСКЪЦМЧЭЦАИСЗ\r\nФСИДШНУНИХРЫЭРЫЦЬЛАШНТЫЛУМЯСТЮЧЮЫПЩЩЬЕДЮЖКИМУЩВЛЕПЦУАТРУРМВЩКВЕЙЪЦЬНОЭНЮ\r\nОКЩХЦЧНЩМЦЛОШНГОЛЗТЯВЭЭЦЭВЕХЩЯЗДЛУВВОФФЩФОХЕБРОЦУЦМИЯЦГОМВЪЯБЫЦЦХОРЩЛЯВИХЪЯ\r\nРИЛХВКОФИЮГЛУРЯДОМШЯТЕУЕЫСЦРХГРИВХЯСТУЦФЛУМЦЫОЙЫНЬИГУЦШНОЬЪЩИУПРУИТРУННОЧЖЭ\r\nОРРЦВТРЩЛЯЙИЫИШМЕЫНЮНОФОЩЗНУРШРЕПТСПРРШМВАРФЯЙКЩШЯТКУФЩИНЭНЬЛЕХЪДАЛЗХММИХ\r\nИЮИКЮУСМИОТИЕСЭНБТОШКЯВРРФРКОЭЦБЫХУЙМЛИШИАИСЛХМСКЛПЫИОМИЬИСРРЮЕКЩЪЯРЫРМБУГ\r\nУНАРОУПУЕДРХЩЯКЩУЬИНОКДДВЬКЯЕЙХХЩГЕЪШЩВОПРГПРЩХЩКНЩКЦННЖНЯТЗЖКМСОНШЦМЕШХЩ\r\nКОНЦЫЭРЫЦЬЛЕКЩБАДЩЩГЬЮНЩАОМУХСЮИШИЙИСРШНЕЗШГЦБЕЬНХЫИЭЦЫАКННЬИКЩУЦПНЩРХОБЦ\r\nНВТНЩЦЮИСЪЦЬЬЗЩКСЛЮЧЦБДЛКЪЯГОВЪЯБЫЪШЩВЛРЯНВНУФСНИРФЮОЖРЩГВАЦЖХЕЙУНФОЛЙЙЯВЬ\r\nХМЦТЯЧЧБОСЭЦГУЕОЦВЕРПЮСЗАМЦГУОЬУДГААНФОДЮЭЯВНЮЖШАБЩЪДОНУЭАИШРЪЯДИШМБУГЩСУС\r\nПЩФЩНАРЪГУСЭЦБОНЮНФОНЛЪДРЫХЦГОРЛЗАРЕПЩГАВЦЗЦТБЩУНШИФРЮТЕЫНВИБЩУЦЕЗЛЩЬУЖУКСЕ\r\nТЭЦФОЧЭЦТЫОШНЪПОЧХЩЛИШНЧЕЛУМСЖЕРЛЯПОЫИШИТРУННЫФРИАРЮЖКИЙЙФЯРЯУФЦЮВНРХУЕОЦ\r\nФЛУМЦЫОЕЬЦИУВЬЪУИЕНЩЦМСЭШСЖДЮБЩМИШЫЧДАЙБЩМСКЦЮНЕЬТЯЛЬХЦБАЗЪШЩХОПРЬКОЧХЦПО\r\nПНЬАМЧРЬОСРШХИЯУЗУСЮСРШНЬЮЯЩЛСКЫЮЕГЩЛЯТОНХЯСТУЧЯМОВДЬЮДКФУБЕПНЦГОМНВКОШНИН\r\nОФБЦДРЩЩГИИМНВКОШНИНОЧЫГЕРЪНЮИЮЪНБЕДЦРЗОМЩАЩБОХРТЕЗЫИВСУПЩГВТЫНГИЙЩЪЭЕЧЛНГ\r\nЧТЩЪСЧУЭДЬИНРЩГРАШХСЯПЫЦВТОЭИСПОЫЦЪНЕЪШЩТВЩШЮАЯУЪБОГЛЪЦЛЬШИРДЕЭЩЫОСЭДЫОТЩ\r\nШСЯОЭУЩЧАЦИЦГОНЦУСЕАЦТЛАЬЪРХМЖЩЬИПЫЦРВЛКУССЬННФОЛЙЙУИКПНГЯМУКЩХЛЙЙУИКШНЭУВР\r\nЛЯБОКПЮИПЫРИИНУЪНБОЦДЬЮБЩФДЖИНЦЭУСЮБЦСТНЫУПРРМЩСЛЩКЩИКЩУЬИНОКДДЛЛТЯНИВХЯПР\r\nРМУАРКНГЭТУРЭНООРЦДРЮЛЩЕПЩМЯБНЖНУОСЪЦЭИНЛХЩЯСЩКБЕМРХЮИКЩКЫЭРЫЦЬЛАЬУЯВАЧРДЗН\r\nЛЪНЕГЩПЮАЧУУЯЕГЩЧЯЛЮМРГЬ\r\n";
        string key = "алиса";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test2()
    {
        string ciphertext = "ЯЬЫСЪПОЦЪТЫТЗЮЫШЛЧВТРУЬЯЫУОДЪХКРЯОГХНЫРУЪСЪЦНУОТИНЬШТЦЕЩАЧЫФОИЛКАФТТИЧГТПТЭК\r\nАЬШТЫОДЙЗЯЯБДУАЧТЮТЮПМЙВЪЫЙЫВЭОСЕПТРЫВТЧОДХЮЧИБКПДСЧХЗНЬТХЙААЯПТИПЭЧВНЧЕЧЦСМ\r\nИТХЯКЬЦЪДЫОПМЦЪДИЧЧЛМЪШЯЯФТЩОЪЕЧНХЬЩУОЩАФЭЯЬЦСЕЭТГЬЯЧННОЮЯЕЯЫЭУСТТЭЕЯДЪХЧГЫД\r\nКЮГШУЗБХМДХШЛНПАШПЦПЯПКЩЕЩМЦЫТХИРННЮСЫГЪНЫЬЪНУОЯТКОЛХЧНВЬИМОЙХЩТТДОИФОЮЙ\r\nЦОЦЪНАЬХШРЛШТЖШОКЯЕФУППНЫВЫЧМУПШЦОАУДЯСФРЬМЭАТТДСХЙВЪХФЭЩЩИНАШШНСЯЫЪЧЕПЮ\r\nПХЪЧИЦОРАТХЫКТЧНЬЫЛХЭКУЩУЧАТХФЪЦХКЫШНЫЮЫФЧРЧНРЮРЙКСДТШЙЫВЬЦОВЮЧУРЯЬЦФЬЧЫЦК\r\nВЬШЙДИХФЫГШФЛГЭЫЖАЮШПЙТЫМКРЯЫУДШНШЗЬЯЫУОДЪХКРЯОГЧНЫВУЯЮШЯСТНШУОЯТЭШРЫЭУЧ\r\nЯМЦЪООТТЪЯЩЫБКХЪЦЧЯНЦШОЩЪГЧСФМЧСЯЫКПВФРТПЫЮФТЙЧЦЛЫВЫЙХЬЧИЪЦТЪШНБЬРЪТХДКЮЫ\r\nШЛЧКШАЖНАЪРЖТЫЩУЪЮПМЧБХЭЕШВЙМЙЖТСУЮЦЪННИЪИВЮГЪИНЫРСКЫЧТМЙЛДЯКГСЫЪЙКНЪЗЫХ\r\nЕЩЫОШЙЛТЫКООТЮМЧЭСОРЯИЫЪТИЪФИУИЯЫЧПЫШЪЧРЫЩЙЫЬРХЙКАЬЕЯНЫЗНУЕНФЫЫШСЦИЧНФТБМ\r\nГОДТПДЯНОХОЙЮПУХЖСИМРЫОТИЖЫТСТНЪНЦХШЩЫОТПЦЧЩУЦЪТНЪЕПЬТКЙЛЮМШЮСЦЦМОЧЭЕМЙК\r\nЛЙЭЯНПФСЬШСОЯПЪЫХКТЙКЮТОДСЫКСЖАТИЫЭПАУОПНЧИЪЫЖЩТАЧЦАГЭУЬЮБХИАБЭРЪКАШЕЮГШН\r\nФИГЫЦЭЦОТЧЙХЮЗТГХЦТБЫЭУСЯУРМЛАОУЧЩЦРМЛНФТХЗКФСИРЫРЫВШФУОЯЫХЫЭЭЩЙМНМУЮЩЩУЧ\r\nСЯЙФЭЩОИЛАШНТАГЪЗЦОЦХМШЯМНВИЦЫЧЯЦЧЦУЧХЯЕШЮПФЦОУЧУЯЯЪЦШЯЮЙНЧСФЙДПЭЫЦТТЙПЦА\r\nЩТТХГЭЖЧДАМТТДОНЩЖНШФНЭЙЪЕЮПЬКЭЦОИАЕСЫЦЯЯПКЪКЫРУПВПЭНЕЯНРТЪЬЦМОУТЦЯЯФЦМОНЧЧ\r\nНЫШЪЧРИЩЗПЯОРФСМПТЫУЭЖПИФЪБСБПКЦИЦХШСЦУЙЬДАЖЕМЧПШЫВНСКЭЦМЗЦНЫЦФХЬЕЧЧМЪЛЧЫЬ\r\nЖТЧЧЯЫЗФСФУЗЧХЯКШНЧЦХСЯХЪТФХИМОШЫСУФТЩОРСГЕШПОНТДЫЮЧЫЦМЩУИЦЪКФСЛРЩАШПЗТБЯ\r\nТЙКСТРНЬТРЦЫТДЧТЗЕИНАУТПНЫЬЦЧПНСЕШГКТАТЫАТТФШЧЧЛАДЕШВЙХОПЭХПНШКЩУОЭТКЬБПМЪКН\r\nФЕЪЩПРШРХЯУЩЮПКОСТШУТСЦГЫОЯЫИССММЛАСГЕЯНХНЫПЭТЙЮГККФЯШХЦТТПЧЩОЭЫПЫУБЫЫЬДЯ\r\nУЪЦЫЦЯИНШНЮГКФСПЭЫХЫЫТКДХЫСНШЩЭХЙСРЫЧЫУПХЕКХЩНЬБЙФЧИФШЕОЯЪИЫОЭХНДГШЙДНТЩ\r\nКСЬПХЦОУТФЭЩЫЪЬПХЯБЧВКФЧМАЪЕЮГШЗВЕЩАЙТЬЭЪЙКДЯУКГШЪЦОПИОЫВЭОНЕЪЪАЦЧПЯЕСТЭЙГСХ\r\nЖНЕЦХФЭЩЗЪЧМЯПКЭХШПЦАЛЖНЦИЬЦЬГЫШБПВПШНЦТЬХТЧОНЛСТРУЩДБРЫЕШЙТНРМНВЬЬЭНФЮКЖЪ\r\nЬЪТСНЬШЪЙКХЪЕЮВЦЫВАШРРНУЧЦОМИЪНЧСФХОМЫРРХАЪРХИЭХЧЙЦНЦЪООЭЕФЯЦЧССНЯКШРФЦЫОЭИ\r\nОФСХНЫПТЭКСГПФЪАЩЬУЮГЪИНАШФЕХЮЬНЩЕЮЧЩНЬКХЪТТЭКЬЯХЫААШНЦЙЫКТЙЯЯЫЙПЯУЩЫВТЪТ\r\nЫВЬДЫЕЬТХЙАЪИЛДНДКЭЦСФЦОРЫРТГЩШЧРЫЧЙЫВЬЦОВЮЧУРЯОУИМТЪДМВЧНОМНШУЯЯНЦЪАЩЫКЬД\r\nВТСНЮЧУТВЬРЮОЯПУЭЦЧРООЮПКЖСПЪХНТЯКЬЦЪДОГЫЯЗЫББНЪТПЫФЭЯЪЦУДЫЮЧЫЦМЩУОРЫУЯЮИМ\r\nЕНТЬХЫАШКОДЪХПХЮПЫАИЯТРЙУЫНМОЩТТТЦМХОМАУПЫЮПЯЦОЩТЦЮЩКХСЗЩНВЯЯЫТЧРТТЦЪЯМРН\r\nЕГХСАИПХСККЯУКАТУОПЯХПСЯФЦЫОЭЫИЫХПСЪТПХЧТЬЖХЧСЯЙЙЫЖШМСТШХЭЙТШУОЗЪТТЪЯШЩЫРИ\r\nЩНАЫШУЙМХТЦШЩШХКЕЭТЧЪСЫНКЯРЭКВЩЦРЩАКЯУЯАЪЦЩОЧЯУПЯМЩОНТЬУЯЯЦЫАТЫОАКГШЛЧХЫ\r\nЯКШЩХРАТЫОАТЭЭЪЙКУНРЙТЕУЧЭЯЫИЫВФЦЩБЪЫИЫИПУЧВТДКЮГМИЙЛХЕБЬЯЬЦХУДЯУЪЦЦЦПЕЯЪКОБ\r\nПФОНХЯБЮРПЛЧМАЧЕЩЩФИУНТЩУУЦЬЦКРНЖКЪЮКЗУСЫШТГДХЫЦАЪТЗОЩЪИЫЬПЮКОРЫЦФНТДТИЖХ\r\nЫАЕЦ";
        string key = "анненский";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test3()
    {
        string ciphertext = "ЦОБПЫКЮКШЕШМСИЯЕХЬБЧПЦХККРТАЬЫЮТТЛЮПЪРРУЧЕШМПНЮТЧАПЕШНЧСКНФХНЪЫЛЫТРДЧХХГКП\r\nЮЦПЗЖЕЧАГЙХКХТПЛМТЫСУИСНШСШИСШПЙФУДНЭИЩИБЕЯНШЯШКЮЧЫШЫЙМРЮЦЮРХУЦАЫЬХКНЛТ\r\nДЮРРРТГШДЛЕШНЧСКНФХНУЙВШВЭЕОГШАЦРХЖТХЧОЦВБКЩДТТШЛБЧИЭХКШГФЕТСХСЩОЫТХУЫСЖВБК\r\nРЦШИВЬЫКЯКТЛТКШОЫЪТЦЧАЧТНЯХЛПЕЯХНКЫПЪЕХСЪРГЕУВБКВЩПОТХРЗЯЦЭСФИЕНШРЯЕЪАВШЭХИХ\r\nЩРРЗЬЦЮЛПСЬКЭЪХОЛОЦЕТФЫГШСЛТНКННПЧЪНОЦШЬВЕТЦТЛЫЛПВВУШЩЯОУЛОЖХУСОБЬРРТТЮАЧДА\r\nШЩУНДВАПУЪИЬОЫЛХЙЪРТДПСПЧЙУТТРИЧТХУЙВКНШПЫУНЕМИЗЕОГШАЫНШСЪНЫТХУЗТЫШНЗЛИАЕШ\r\nИЫТАОТЦЧРТРЭКЮФХЩХИЩОБЧТЧТНЧОБЧНУНПШВХХТХЪОУВЮЗЮНВЕНОФКШИВКШГФЕЬРЮАЬЕЫБЭНЕИ\r\nХПЮПХХАТЖЯБТАЖЬОХЯЭШТЛЫСШПАУПЦУДКЛВУШДЧОШДШТДУТНЫЕЬБХФШАОШРДСЦДЬШНРФЭЦУИХ\r\nАЯУХЩЯИЧЕЯУСКХЖЧИЗКЮТАЮРИЧТЙХЫНКРЮЙХХТВЫСБХХФМАХЕЪЦНХСРЕТЮРЮЪЫЙМСХИСИОЫХОЧ\r\nЕЧШИТШТАНРЦСАЧАДХЫХЯАЯПХХПЦЦМТРЮЗЫСПОУНЛЬХХЬОХКЮЗЪРЧАЦЕФНГРЪСФОЩЦШЫУБЕДТЕРН\r\nЫРНИПЕЬЦЯОЦРХЗЫУЛЦТЯЫШОЗЪККОФНЪРФППРТАВЩЫВПТБПХЭЧОЧЦЫЕРНЭЕУОБЗЫЙЫЖОЕЭНТЙШАНО\r\nФЕЭЗВООАВЕЦЩЯВЭЯБТЫЧЫЛЙНБПХЭЧРПСВБМХКМТГАЕГРМЖТЗЭБПЗЬОЧИШЗЮАНРКБЮЧНЧЫОЪГРТХПН\r\nЦТИВУШЩЯОМСЪУРЦБОЧДРЗЩЛЫДЭВЮЦЬЦШЬСОТЕПАХСЖПАНРУНШПНШКЩЧЭОБИВЕЯДГИФЛЫКЧЮХЙК\r\nЛХПЮИЪДЪАВУШЩЯАЙНРЗЮНРДКПЮПХХАЛКРЮЦЮРЛОЛОБТЫКНВВИББЮХНЧКЛРЗМЧЫНТИРМНЪТММС\r\nЮКСРЪЕЧНЛЪЕЪНТКХВЕЩЦЪАСАЭНЩИШАЫЬЯУЩЦЖЬИЭЬНРШННЬАЬЦЫПСАМАЫЕЕТЫЛЕБЮРЙХХЦЕПАН\r\nЛЪИВНГТТЙЖЦОЪКХЧЫУЮТКЯЮЦЪЦПАХАСРНЛЫТМОАНЯНШЬЧЫЩЩЫХССЬАТНПАХЙЫЕСКПТНЧПСВЗТЩ\r\nНМЕХЯКЭКИХСАФЕДЧЫМШЩМЦЫКТТЫКШСЮЦШДКТРСЬЦЬАМШШСПЧШЕЧВДНЪЩЧУИВЮОЪЫЮТКЛШТЮ\r\nТНЯЧЕВКЭЧХМШСВБЧЧШЕЧУЯУЮЪНВТЛРЦЫКТТЫКШЪОЦЦЦШВЭЕЧШНЙНОЫУСХЫЙЫМХХЯРХМЧИЪЧЫХТ\r\nПШМЮИНУЧРШМХЧЫУЮТШВБПЫЛЫФШНФЕПГЩНШГЮКПНЭОЙТЭУЮУИШТТХУОЦРАЬСВЗТИЩЕЪИЪНЪЦ\r\nАКХАФМСНЕНПЙЦНФХХВЕРРМАФТЕЬСПФЭНССЬАТНЯДЮЕЛЕЭКЩЦУЕЬЕТКСДЮАЦОХИШИПНШЕЧЙТЩЙЭЬ\r\nОВУДЪЫЕЫЛШРЛМХЖТВГЧДНЮТЧОВУЫХХЧЭВБЧПЫЛТЫЕСДПЧЫЛЧОЩЖТПЫПКСЭУЮЪХНТКВУЪРЧОНДРТ\r\nТЧЭИВЬХЧПИЩОЛВШТТХХЕЩОБЧНЪЙЕУНШПЯЦЪЕЩОИРТЪПАЫНРФЫУАГШЛЮЙЪЦТСЭЩХЦЯКЫВКНШКХЪ\r\nМЖФИЩЧЭЫСВЫСЛРЧЫХЛТВВГЭДЩУТЛШТНЦЮВШЕЭНТЮТЛТНЭАВПТМПЛМРЛМХМШГГЧАНВАЬЬТЙЭЫРО\r\nУШВЕЯКСРЭГГГЮЪЭАЧУЯКЭНЩЕЧИВБЭИООЬУЪШЬРЯЬТЛШФЭЦСАЬЬФУЩЦЯКЪЫВБЮКЫЕЩРХЙЬШХЯЬИХИ\r\nЫУЫСШВРЧЙПНКШГЮЪЫЪМТТОВПЭГЯОТБХМЪИЧАСАЭТЫТЭИЬИЪУПИЯЬОЕЩЦЯКХЯКМХХХТННЫКЮИЫЧ\r\nЭАМИВКШДЮТМАШФЭНФИОЕЭЧНУЛДТСТУОЦСНЕРГЦЮТЫЕСААШОНУЬПНХМНЙИЛШСТУТСЭООИЭАЩГПС\r\nПГФЕСЫЕОУСТЕЩРЪАЪОФТЫСФЕЦЛХСИКТРТМЗЧЫХНСЬУЯНЯМТНЖКЮИСИПРШСБНХЛЭЯЧЕВХТКЫЛИЦШД\r\nЪИЭООСРСХПОЕЪЕВЦПЦТПЪАТНЯНШЬЫТТУЧЦРДКДХОЮЪПИЬЕЫБЪЦЫТФРЮГЯЩМВЫЕВГЭДЩЫТПАНЪЫС\r\nИЬЕЫБЪГТЛКГХХМРЮОМСХЪЮЪЫРШНШМЮРОИЪИБЦТКТРКРЮЦЮРХВПРЭШЯЩМКЫЕЬБМФЩОЪАЫБЪЦХФ\r\nТЗШЬТЩЧИТЗЬУУМТНЧЫХТЫЩХЛЖНЛКСЫВОЦПЮРХЪХЧПСЪНТЩЮЫХЬЭАТТЫГОАЮЖЗЗПЯЬНХТНЙАМКГ\r\nХЕЪИСЕХЕТЦТЪТСМОСУСГЧОЬОААТФИИЦЕХСЯНЬЕЪЬЭЕФИЬАОЕШСИКТРТМЗЧЫККТШТФКЪДЩЫЪУБЦЧРТИ\r\nМЧРЦЯХЫСЬИВУШЩЯОМСЪНЦЬЫНОСЬУУНЩСНОАЙЫЩЯЬИСЪЕФИЯЬБТЮНЩГПНПСЫНЮКЫЮЧЕСУШДЕУИ\r\nЛХФЯЫЪАШСТУОЦУДПНШКЭЦСИЧЫУУПЦЭИХАРРТТЮАЧДАЕЯЦШСЬАПТНШНДТОБЗЫЙЫДКУЬКЭУНДШЧМЧ\r\nЫУЮТШГЮЗПЦФРКСВКШНЯИЬОЫБЧЦЯЕЩЕАБЮЧАСЬЯЬТЫЛЫЛПТЯУЮУТЕПСЬКЭЪХПКМПЧЙЦЪЕУНРЬХХН\r\nЮЬЧВНЯДХНКРЮЙХХТВНОФШОГШИСДРТОРЫГЪАДНДНЮКТЙАУЩИЪОЧЕЩПЭЫЯЫПДЮХЫЛХАХЕЪЦНХСРЕ\r\nТЮРЮЪЫЙТВЮЧЯНЬЕЪЬТАЕУНЕГЕЮЙЪИЧНТГРТНКТРЧЯЪЕЪНЬОЫЛХЙЪЗМПШТЮСАЯЯОТНВКЭНЮРШСБНМ\r\nХЧДШСХРТХТИСВХЦЯХЫЙТМРРТТЮАЧДАКЯЦШСЬОЩЗЮНЭАЫТХЧ";
        string key = "каренина";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test4()
    {
        string ciphertext = "МПСЭПШЫЪИОФБЪЙПСОНЕПНЪЕМЫЩНШЫТЪРНКСЭУЖЧЖШТСЭХРНТНЧТСЩУШНЪНСОБУЧЫИРНРШХМТР\r\nЦГПОЫДУРГАХЦСВММЗОАДЦБЖЛЫЬРСАМЦЪТСНЦМДЧЫЛИЪЙФЪТЗГЭПЪТШОФДГЦЮЧРИЩЙЪЙЫБУИИФНЯ\r\nЕУРШНЭТЗРННХЫРИИЩПЭЭННЛКЩРТЮЯЕМПФТЩАХНСРНШЬРГЖПЪНКЛНЖЩАЖЕФЪГЦПННЛЗГЩТУАОТЙ\r\nНТТТЦИМНЯИБЮУЙШЫФДГХЬЧЫСРЦЛБФПТЩЛЧПЮТЪНИНСННШИКЦГИШЫТЪРНЩЫОРГКЩРЦЮЯРИШИЯЙ\r\nНСКФЖУХЗРДПЩЯНВГУБЩЙЧРЦЛМИМЧОЙИОИМЧОУЦВТНХЗТЦЕАШМПЮХБЙХЯАВКТЗЧЫЙЗШЖЙТСЕРДЯЦ\r\nОЭЫЕТЙКИЕИЕЦЛЙХЮЕУХБЗЮАМСЯЛИШНКЛШПКНЪНЮСЛЦУННЮСЛЦЕТЛИТЕУМХГСУПТСПАХШЙТЫШЕЪ\r\nТБЛТЫРЖРЙЦСХНРИМНЪЯОЪТЖЩПМЗНИРРЮТМРНТТЫШЬНЦХЦЯЫГУИХРЦЬОЪННЫЯЫМГФБХТЫТЗИМИХВ\r\nМРНЕУМНЛЯЙПФНЯООРОНЪЭАЕРМИЮЙСИЙЖХНЪИШЪПУХЮНЛФЙЩПМЗГХЬТНЧИИЪПХТЬРЛЗУХИТВСЩРЦ\r\nЩХНГХЙЗМЯАНРОНАСОФЫЗРШЮЯЦПОИЯЙПУРШРЪАНЛТПЛСННИУЯЙХШРГЩТЧЭНШЛКБЪЙОЛЛПЛРВШЮЗ\r\nНКМЫПООДТЪПАЯФДУНЩДТСЦОРЮЫОДББУХЩНИЩБФХОЫОЦУИЩТЩИХЖФНШОЕЩАТЫЦВФЗШРЪИСОЦН\r\nИЪЪОИЩУШНАССКПНЬТРСХЖТЫРДГЫЛШНЕАЕАЖНЩЫЮПЫЩТТЯЕУЩЛЫЛЕЛВЧФЯТЭЕТИЦЦПИЙЖШЖЙТЪ\r\nЬНШПАТДНЮСРНЭШАПЫУШЫПЫМЪЖИЯЭАОДОГЦОИРЦЛУЙЪЕУИТТЭИВГЖЪРЦЮЯЕНЖШХЩОВЧПУЫЮАХ\r\nИАФШНДИХШНЮЧАВШБЩЬНШСХЛИЪНПЦЛПКХГАШХЖКТЮТЯПБЯТЩПУРУИЖХВЫИАЩМФАПХПСПЮТГШ\r\nПЩЯЙМГЪЭЦЯЪОФРМИЮЙКАЪПФАВРГХЙУХЖУДНИКЮМКЛЭТИЪЯИПНОЪЫПСХЦЙЪЧЫРСЙЛИЪНШНИХЫЪ\r\nХКСФФХТЩЕЫИЖЪЪАИТЫТЪЙЮТСРУЦЪНРЮУБЩЙПНИСПЯТЪЬУНЕТЫДТСЙЬМЫЮТГЪЭЯЯЫТСХФОЪЫЕПИ\r\nТТНЭАЗХЬСОХНСТМДОХСИШОЫЛЮУПЦШТАСЛВЩЫНЩЫКИНРШХМТИУЭХХГЕПИМНЪЙКССЛРЪЫАНЪСРЮ\r\nТКГТФЖЪХБЦМЭЦЮЫБЦЖЙЛЫШКЦММЗЕХТЯЗАЩЪМЛТГМДЪЫМЦИСЦПАЮНЦСЦОЧУФЦЩТНБАТШПЪТЭТУ\r\nЗРТЫЦИСЪЛШИШВФНРШТСМИЪЬЦЧНЗГУЙЩЙЪАПНТЪТЧРСФЖТЫШЕЪНЛКЫФМСООЦЫЪИДГМРОЭОЫНОГП\r\nЯИЖНМДЪЫВССЗРФЪИСЪШРЩНВЛМВРЮТРРЦКЩАЩОЪТЙТНЧВФНДМНСОФЪБКХШУЗЦГЦШЙСХКЙНЫЪАДГ\r\nМИЬЫЛСЩБЪНМКГОЕИМЬООЦТТНЮВСНДЦГПЕХИЛШНЮНГЗТРЪМЯОРМЦПНЯДНМИМДЕУХБЗХЬРЛЗУХЫЩЯ\r\nОИТДПШАЗЦОРМЬОЗНСОНШВУЫЛИВПСИЧСНСЩЕХГОЦДАВФЪГРЯТЛЯХЬНЧЫНЪРЛРЬНЛЯЮЖКЪТОХПЬКНШ\r\nИФДОИХВСЦЙТЪНЪЦЛЖОРРШАЗТПФАЬЕУУБФАЯРЦЙЙХЫЧЛВХЙЩАВОМЦТЪХЮТУИФЩЫПОЖЦРНЭННЛУБТ\r\nХЭОЕИОХЫЦКСОЖТЫЕЕОДЛИСШЯЛЛПУЫЧИЖУБПЫЮТГКБУЮМРГКОЦСАШИХЛИЧХРЦТБФТЪЯРНУШЫЪУОР\r\nНЦШЫДЮННИЩХНЮЬПЪЫРРГЬЙРЯТПИШЭЗЬЫНВУРЦДТМЦЦОИХВНИУЯЙХШАТШЙЩВЫДФЪГНДТРХКОРВЪ\r\nЕДГМЦЩНМЛХПСЮАТЛЩУШНЪНСЯУЦМЪЕКИННДНЛАЪПЛЫЭАРДЩНСПАЖНПШРХЯОРЩРШХСЯМБОТЯОЖ\r\nЦУЫЮЧЛСЛПЙШТСНИЛЦЯЫРЮСПХХТЩИЩПЭЭННВУЙТЫРДГЗРЦЮШЕЗХЙСЭНЗКИДУМСЫЕИМКЧЫРСЙЛЫЩ\r\nНТСКЬНЬЫЗИУЖХТПШЛНФЪЭНТЛКЩРТЬОЪНУХИЦВИЩОИРЭАЗГПХХПЫЖУАМТШИОИУЫЪЪЫПРРЦССЕОТБ\r\nФХЧАНЩБФЫЪАЖШБМИЮЕЖЦЕХМЕНИЛПЯАДЕОДОЦРЫКГПБЯТЮТЕИГЩТЪАККБХЪИЕЕНЪРХЪЕРИИКНЪНЮ\r\nНОНХЩЕОРОРЧНКСЛПЦЯЪОЫНОРМЧМГЪЖШХХМСНКЪЫЮКИЧПХТЦВСЩЛШТЮИХДПЙЭНЗПИУНЭХЧИШЖП\r\nЩНТИШЙИШЙНЮНИХНЧИИНТЫЖТСХКПКНЪИВТБТМПЫУИИРШЮЯФХЖЧЫЪЯХХЬФПТЛИШЖЯХТМПХЖХТА\r\nДГУПЩЙЩАПГГТЫЭОДТЖХТЫКГПБУЫЮЬТРТДЩНБЮУЙЧТЭЕЕЗИИЪИЧИШОЦЦЕЕОТПКЫЦЛИХУЦДЧОМЗСИ\r\nФЫРЕИМНТЭАФЧСЗЩХЛЕНСЭЪХЙНЦОКТЭТИНВУНРОУЦЕРЛЧСИХЙРЪХКСУБНПЪЕНШБЩЫПСНЦКПЪНЧЛУП\r\nЩЙЪАНЦОКТЭТИМБФЫММГЪЭЙИШАДУБЛЫЭОЗРЖФХЫСХИМИЮЙИПКДЫЖТССКЖЪЮЧОЖЦЦИЩЮТЕИОЫД\r\nЯОТРЩЫЯТЕДУБЛЫЭОЗРЯЧЫТСХНТЪПТНРЦНЫЬЮИШЦМЦРХЧИЩЛЦЩАХСМФЗПИНЦУРРЮЙМСРИНСХНФЪГ\r\nНЪЪОЖЦЛЦЪПЕУЪБЙТФАЗШЖЩНЯАНОЖКЩНГГПЙХТШЮЗРВНЭАТХЦУЛНШСХЫЛТЫЯОУГКРЩТЕХЩАКЫС\r\nНСФЮТФТМТУАШТХТСУЭТЫКТЛЛБУЮЯУНРТЦЮЯАЕУАЖЯЩАФЩПКАЛПУЦЕЫЧГИБЙЖПНСРИЩОЦТЬИФДН\r\nЦЮЬЕУКБШНЮСХШЖУМШОПНОЗАШОЙРГХНЩЕУЪГЦФНТИФГНЭЪУОЦТЦПЮЕПКЙХАЛЖЛПОДЧЫРСЙЛИЪТ\r\nБЮУБФАЮОУХЬФМЖИНЦНЦЪНХУИОРШНСЦЪЭ\r\n";
        string key = "нагибин";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test5()
    {
        string ciphertext = "ЧИРТЖЙМЫМШТУНЦНМАОЭОМЫХШНМРИПЦОЦШНЙСЮКАЗЧЙЮЦМБЭРЙЬШПХУДОЪЪЮЮЛНЯХРЫДНЕЫН\r\nФТРЫУУНЭШШЫУПТХЧЙФДОЯДЦЦУДОЯТЬЮУУХБИХКШОТНШФУУВЧФУКСЛЕЫПНЧЬХКХЫЛТЩРНОХПМУЬ\r\nТЦЫЛШЯЩЛННЪКЯЭРЙЪИСОЧИЩННЬСЫЕХХЪКЮЭИФШНЪЦФСУХСЫОЦЮЫФКШЫКТУЫУШШЩЛЙБШКЫБИ\r\nИДЪТАЪАХМЪЖСРРЧТКМУЦИУЫСЩУЫВЧЦФТЮЩВЧЦКШЧШЫЧСРЧЪУЛФХЦЧАЫИЪЯИЬЙЬУКХЪЕГЧНЧУНЫ\r\nАНАЩНХПЫЖХСХЩФОЦЕАТХЧЙАВЪЬЦЦЦШАОЯЦЩБЬТЧЕНЧЫЖЙЪТКПЮЬТЩНХЕРЩЙЦНЧЪЬГЛЙЮФПЮВЕ\r\nХЬЦЩЬЦЯХХЛШЮЩДЙЩШШЯЬИСЮНЪПУИКТУЖСУИШЫУЖЖУРЬЩГЧЦУГЩТЮТЦЧАУТМШЫУИАТШЧЬОО\r\nЩХРХЦЭВДХУКАНИСПНХЦХОКЭРЬОШИЪЯИХОСЕЩЯКШЧМЕЪЬЦГОПНЧЦЧШТНОНЪЦУПЦОУНМЕЪЦНЬОРЬЙ\r\nАРЙЪНЧЙАИСЮТКЩРЧОЪХЕГШАЭЭЦЧАЛХКТЩБЦЬЛОЪХШУЧНЧУНЫАНОЬЩНЪЖУХЧЯЛШЩЩДЙХЩЬЮЛДЙ\r\nЪРУРЭЫФАФШЮРКЩЫКТЭЩТЧЧРЫЩРЗЙПЩЬЮЩВОЪЛЪЦКРЙФККЩУЛЙЮДЧУНЫНТШРОНИЪЬГЬОШИИЫЛЧ\r\nУЧОКТЩФЮЩВФТХЧОКГОЭФКЫУЯФТОКЩЛУЦЫЛЩЬМЕНХЪПЩРЙЛЮЗПРЫОШНЫЫУКНЙЬИЦНЭНСЧИЦЦОЕ\r\nЩЫЗЦЦЬТЩНМКЩЗЦЙЩЧПЮНОТЩРЪЬНОТХЩФЩЙЧОЪРПЮЩСЪХЗЧЦЩДЦЫЛШЪЩНЬЩНЧАЛНСЫМЧЬФУ\r\nЮЫОПЫШОТЩЦНЦЦЫШЭРЫЬНЕЫЮТШЧНЛЙЮЪТРЩЙЦАЦЛИКВСШРТЪЪЕЩХИХЦЬТСДНЫШЩЙЦТЩЩЮЛВ\r\nОСУТРЩЙССЦЫАЩЙЦЫСМЯКЧОЮТШСЩОЪАООУШИИПЦУЫЛПЧЬИХОНТОЪДШШЭЯКЭДЫШЩЙЩТКШЩЙЦ\r\nСХЦЧУФСЫЭНЦЦЦИЪЙПКПЖТЕЬШТХШАЛНУТЯЗДЛНРЫШЦЮАТХТНШАЧОБПЪЧРЙДХШЪЯОЦТЩЩЮЛВОСУ\r\nТРЛВЧТХЧОКБЧЭДЛОМЕФЙЛТЦУСОЭЙТЦШОЖЯРОРЛСЧОГЬЦКРЙФЫЦУРТЪМХПЪЩГФХРСЪРНСЯДШПДУЗЮЫ\r\nЪЬНОУЭРЬЦВЕЪЧЫИЬБЕЦЧЫЫУФЧЙЮЦЬЪРЧЙТЪЫНЬТЩТФХУШИОППНЩКНЬЯДЧОУСЫЫШТМЪЕЩПЦУЪУРЧ\r\nПЦУПРЗУШИЫЯЩВДВАШЮУДЙЯДПЧНСОЮЪШЮЩНЦЛЖЯОЫАУЯНЪЦЬТСЧЫЭФРБЧШДВУПЕЪМЪТЩРТЪАБП\r\nЯЭВЬТЪМЫЛШОЦЩЬЮЛНОНЩЫЬБИЙГРЙЦЬТЧЭРФЬНПОЭКШЧЧИЩЫКШЧНОТЪГПУЭРЬСИЦЦУЛСЮНПБВАЪЯ\r\nРПЪЪОНРЦЬЬНЛОЪГЫЬЦИНЪГПЦТДЙЪРЙЭЫОЛТМПЫЖМЦЫЛШЕУСФТХЧЙРВЪЯШПЕУИУЫХЮУЫЕЦГРТРЭО\r\nХДРЫЩРМОУМЭЫЛРЧСХЕУЪРОУХТЧЩДЦЫЩЬЬЫОЦЪРУЭЩДЮЫМФЫРЙХЫОЧЬЬЧСЯИЬКЪРОЫМШЩРНЦИФ\r\nЩУЫВЙМФТЮЩВЙМЧЪУПСЫННЬШЛКИПУПЫУЕЯХКТЩУЗЙГРШЫШОМЫШКХЧАЮНРЩЬЫЯНЧИНЮЛНЕЩНР\r\nТЮЭШЫЭКЪУПЩЫУШСЬТЧШНЬЦКНЙДИХЬШОЛТСВУФИЪЯЦЪЦУЧОШЦМУВЕЪЯККЬШАЦНУШФУЛЙЫЪЩУВ\r\nАЫЫТЧОНСОЮЪШЮЩНДТЛШЯЮЩОЮЪМЬНАЦХЗЦЦЫОЛЫСЩЮЛВЧЬЦЪНПОУКТШЫЩМСЧЫЫЬБИЙШДЧЬЪ\r\nОФХЪТЕРСУЫНЪОТВСЯРПШЮЛЕЯЫЪБНХЧСНМУПУВХЭЫННСЫЭИЧУПИЪЧЫЫЯУЙЙЪИХЦТАУЫШШАХОМЫ\r\nРОЩУНЦЫЛШЭРРСЫМШРНЫРЭНМОШИИЬШПТЪОЪИУШШЪЕЩПЦУЪУРЧПЦУРЬТЙТЪТРЩПЩЫЩШРЩЗХЫОЧ\r\nЬЬТСНУЖАРРЦНЪТРШОМЫЧЭАУРЙФКТАУЯЪЫЙЕАУЙХХХЭННСОШНЧЯХУЗСШКЪЮГМСУЙЪУРЙПЮПЩЩМС\r\nСУЙЮЩСЪХРМЬЬОКТХЧЬЬТСЮЯТЯЭОЖЧЦЧЬЧИАТЩФЬФТЧДТТХЫЕЦХЗЪЬЬССМХПЬЭНЧЮРХОЬЬУДРЫЩЮТ\r\nОВЧЪЬЧЫБШНЧЫЖХСБРЧОШСЧПГЯСУГЙЪЪШРЪРЧЯРМЬЫЕАХЗЦУСДЬЧЦЬЬЫЫХХКПЩУКХХШШРЩМЬЮЪШ\r\nЩХНЧПНЧЦЙОЫЩНБОРТЙПРНЫЛТЕТКЧЬНЫРЫКАУШТЩНУЖЫЖХНТШРОНПОЯНЪПЮРМПЩПАЛКСЬШТЫКЛ\r\nСЫЙДНЬНОЪРПШЫООЯЩЙЭЫЕПСНМЯРГЧПРЦЭРРЪЧЦЦЪРНЫНУТАРТОЭЦЫЯУЙЪЧРЯЭЫАЛМБТГХРЬРЦМРЬУ\r\nВЪЦЫАУПЩЫМПЩЛНЦИНТЯЬЛОСЦМОШИИЬЦФОТЫЛНЖЬЕЭОЛОЦХКГИЦЮЪМУЬЛЬДИПРЪРЧЯРМЬЫЕАХЗЧО\r\nУМШТШТОЦИЪЯРБУЬКЧЦЧШЕНЕЛЯЦЦЕУСФТТШЩЩНСНУЖЫЖЕЧЯХИТЗНООГХЦЭАУХФТБСАКЮЦХМЭНЧЮ\r\nЪШЭЫОЯТХЬЫЩАЦЯИНЬШИЪЯРБУЬКСЩРЧУЪРСЩРЪЦЧЫХХЧШАЩМЬЯЦМЕЛСЫЪЦЫАУРОФЦЧЫЩБДШЦЛЙ\r\nЬТЙПРЬКНОШЭЦЫЬЬУКЗНФАУВЦИЭЮОХТЧЭИЯЬМЭФТФПЫЭАЮЮУЭЕЛЙЦЫЩЬЦЩБЬЮУШРУВБХЭФЬШФФХ\r\nТЬЫЩЕЩНПМЦЭИО\r\n";
        string key = "николай";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test6()
    {
        string ciphertext = "ВЧТУЯФАЯГНТТВНАФЯОЙЪЯФАЩЬЕЯРЦУДКЮКЩНЭТАСЗНФРЬНЩИЗНЪЧБНЦНГПЯИЭФАШСЙЪЦЩЙЧЖАУЪ\r\nЩЫЕВИХНАЩЩИЯИЬУФРЮАЗШСМЕФЮАЗЩДЮЧЩГЗАЙЯЦЯЦУЕЭРАДДДХКГЗГРЧЪЮЕЩИХЙШТЯПЬЦЮНЪЬ\r\nЩРЪЧЭУВШЩЦАХЯТЪЦЗКЯРЬНГЫККГЪУУФИУЭЪНУЧЧЛЯЙНЪЦЪЯРИКГТЩКФЦШСАОЮУГЪЩХТМЩУДНЬКГ\r\nТЯФАКЫЕЬМЯЦДИГУЙХМКЦУРВДЦЪМТМСЬЪРХЕШНАХЧМЬУШРЬНЯИИЕДДАУЪЩЫНЯИЫУЯТБКДХЯОФЦЬТЧ\r\nМЬНЯЦЪЙФИХЫТЪНУЦРЮЦЮХСЗАУЮКЪПЬШЙНЮНСФЦЛЩКЦМЦХЯИАКЯЙАШЯЙТЩУУРЩГЕДДПСАУЯЙНН\r\nЕНЩРЫНЩИЫРРЯЩРЪЪСПДШДЙЯЦЯЫЧХЩЧОКЦХАЗГТАЩГБЕЩАКЗИЮУЧЩЬНЯНАХАРШЗАМЩЧОЧЯНГТЯЗ\r\nГЦУЦЧФГУФНБУСЪЮУГЪНШГЧЦЪТШСЗЯИЮШЭЖОЧТРХКСКХУЗХЯЗЪУСХТМЩУТЩГХАХЯСАКАУЪЩЫНВИ\r\nШШЮХМЪГРФТТУЯЗУГЬНЯИИЕДГАУЙЪЩЦВИШШШНЫЦЧЛЯЙЯЗЙТЧФДЙЯЖАХАМЦРТХСТЧФСРТЗБЕУЦГЕБЦ\r\nАХАЛБЕЮФЦПАЪЯХТЗАУЩКЯРСНГЗГНЭЛЧУСГЛРЭВЯЪДМЪИВЧТФЩЦБЦЬБЩЦУЕДДВЗАРЬНЙХМКЬЦЭФОЖГК\r\nВГХРСИЮЕЭРШЕЬЦВСЪЯЦЦЬРЖХТМЩУГРФТТУЯЗЯИОЧАЪСТТУЩМЩИГХТЯЦТАКВШЮФЦЖАУЦКЦКДЪЮУ\r\nЮРЧЪАХАЮЦЦГЦБТАЛЯЗВНЭКЯРАХЧМАХЪХЩСТЖГЦСЧЯФНЪЫНБЦЩЦЬИЩЗЦШДИЪЭХНТЧСМАХСЪЪПЬШЙ\r\nНЮНСХСФВРЭКВКЯФДРИКГТЯСХМЦФЧШЦЙТЪИНЬЦЭСАОЦЧГУДЛЪЪНСАБЮАЫУСМЧШСФВРЦСЯРЫУЮТБШ\r\nБХМОДНЬКГТЯФПЪСХТЙЯЧТЙЦМЕЩЬУФХЯЖЕМЦЧБШЯЙАУЧЕДДВДЯЦЦКАЪБНИИГКЭДЮАЫХСЦЧЛЯЙЯЗЙТ\r\nЪСХКЯДБКЩЫЬБДИГМТЩГЕФУРКДШСЦГФСЧВРУЕДДЩЙВЫФНЧЩГХТЪЦИЪРАУЪЩЫЕЯНЬБЩЗВПТПСЧОЯГУ\r\nЦЦВНЗЧЯХПЪСФВЦТРЧФСТЧЦТЦЕОХЕЭИВБЯНБЕЩКМЦЬИШАФИЬНГДВУЮХЦТЪЗУВЖЬЦПДРУТАЩГНЬЦВСЪ\r\nЯЦЦЬЦЪХТМЩУГКРМЪФЦЛЩКЦМЦХЯКБШЯЦДШСТГЪУУЩИАУЭХЦТАНВЧЧЩГЗЧХЮАЮРБЕЦРЯФАФЦЪТФЩ\r\nФАЕГУЮЫХЗЕЩГУВЦЮТЪСЯЖЮНЮХТМЩУХШССЮИЭНБЦХЪАМЩЧЭРЙБЦУРПАШЯЧЬРЖЦАЦТЮЧХЩОДРА\r\nЕЮГВШЛНВЧФЫЦСЮГШЙЧЩНТАРАХЪЕГУЮКЯМЮЦЧКЯУЩЭОХСТЧЙЯРОАЩЪБЦЭКШПУКЩМЮАЮФСЦКЪС\r\nЖТФБЕГЩГУСХЩДЗМСЛЧТТРЪОСОКНЪМФНШЙЧШСЙЪЦВНХХСРЦЦТНВИЦЧГЗИКДГБКХЦХЕЧЩЬНФНВЧЪМЩ\r\nЕЭЦФЗВНЧНЮНЫУВЦГПЪЭУУБШЯЦАКЩУДКЦЧАКГУЯИАХАМДПДРУТНСХНТУЯИЕСХШДЪМЦСЯЦРЧЪЩДБЦ\r\nОЧАФДРЕЯЙКЕОВХТПДЦАЦТЮЪЪННЮКВКЙЪЯСНПЮЕЧФЯЧБШСЗЪЪНЦЕЧЦХПХЗНЬУЯФЧМЩГЪОХЕДДСТТУ\r\nЯИЪЯЮУХЦАУГУСТЪЗЯЧЯРЖТАМЬДБНБКГГЬПЪЦТЯЧФЩЦДГЖЩТСЬУФЧЯХТМЩУДШЦЖЕЖГЦСУЩЖАХЦЗЧ\r\nШЯДДХЯСАБЮАЧЧЦХЧМСЧЙРЫНЭРТУЯНАХЪНЭРЧФЯЖАУНЭТЗХРЪЪЦРОХЯЦДДАКВНХЕЙРЭКДЦХАЩИАНГР\r\nВУАЙККЯРЪШКУЩЦЧЛЯЙЯЗХЕЭНЫУФЧЦХЧМАУГШСЗЯНЮНРЩВКЮРХКГЗГАЮРФУЦИЭНЬЦФЙТЙМРЪЧЯЦД\r\nИУРЧХМФЧШУАЧРХУГРЖФАШЦЙЪХВЧФНЮТННОПГЧЦХЪФЦТДГУУУУСЦДРЫУГФЩЬЧЩЫУЫЙДЧНУЯЬЯЦЪ\r\nФАЯГАФЪЦИАММПТТЩМФНВЧЯЦИКДГБКТФЦХЪТСТГТЩЪЮНЧФЭИЮКДХМЪЩЦЮЙТЧЯПЪХДРЪЧБКЦНЬАГ\r\nЦЬТЧЯЮУЫЩЩЦДНЭАБРЯТЧШММТЧДЮЧХЮАЧКФИЪКЯДЦОЦХНПСФЕБЦТЯГЦЗХЦТРЧЪЦЗФХЦЭЯРЦФЭИЮК\r\nДГЯТЪКМХФИЬНГДЩМБЦЬДБШЩЧСОЦТЪЗВУЭХЗЕЪЪЦФЧШНШЦИЬДРЪВДФЛЬШУРЮАХИЬЕЬЪЩПЪКАХЪХЗ\r\nНБНЦЦДДЙЕЯЩИЧАЦЮНЬЦФЙТХЩЖЕМНФАЧСЙЕЪУХЕТЩХТПДСЯГЖЦЕБЦЦДКАУПЪЯСЕТСЛЦГЪНЩХЩЪЯН\r\nВКДХСЦЧЙЦЦБНЗНТУНТАНАУГУСТЪНУТЕЪБНБРЯТЧШЯЗЩИЬУШНЮАЯНТУЭДЙНЧФЦЧТУЬНЙНВПЪНАРТЩГ\r\nНЯТЩЦФГФХТКЩХАКСТЯЦЪТТХЩЪФРШНДХЯОЬИБЧАЯЫУЫПЦСЭЗЮЦАМЦХШИККЫХСЭХИЬЕЬЪЩЬЧЩЫН\r\nЫЦТХТЪЮАЫИХХЧЩАУГЫГНПЪЯУЦХСПТШГНЯТСХТПЭКВЦЭЦЮЦТНЭЬЯЧАЧЯЦЭИЮНЧЦГФВИУРЧХЮУЧЯЦ\r\nХЧПАДДДЬКДЩУУСМЧКВИЭНЩХСЬЪЪЦРОХЯЖАУЦКАЙЛКЮХЯКЬИЧЙНСЩМТЧАЕВИГУФХЦЦЧЪЮЕГНТКЬШ\r\nДИЭЫПЕЭЖЭНЯРЦЗЕЖЫУВЦТПЕКЮШДШЩПАЪЯХАСЬКШИГФАПЯРАЯЦТЯГЦЙЭЗВУЗШСТЯЦВЧЪКЩЙЧЦХНГ\r\nТЩТТХЩЪЬУСЦГРИКГТЩСПМЩЦАХЯЗГТЩСГЧЯЦАЙЯСЩИАНГИЮАГЪСЧЪЯЦЦЬРЖНЩЦТХТОЦТЪСВРТСХУФ\r\nХСПАЪЯХНЭВУУШСТНКСЛЯНЪЭЪНЮЕЕЯЮАЧМСТЯГЦНЩЦТХТОЦТЪЗШКЮУЩКЧФСЧЧШЩПАКБЕЩУЩЬЯГЦ\r\nРТХХЭТЬГАГЮЦТНРШЛЪПЮНШРУУДХМЪЪЯЦРАКЦПТРЖЕЯИГУЮРИКГТЯКГЪБУЧХЩКЪЙЩУЗРЭНЙНВПТЗВЧ\r\nВЫЫЧЕШСЗЬУПЬТЗЭУЭНЫШЭЫХТЬТБУЮНГУХЦЮЕЯРЖКГЪНМФЫЫНКНАУДФСЧЧШЩНБУСЬВНТКЯТСИАУЯ\r\nЦТЧГНИРШЗЧШЦОЯИАХЪФЦХБНВТЪТЩЧАКЙШЮКЦЧВИЩЙАОХДХШЯЪАЪУШЭТСТАКЩМЧФЬКДШРЦЧХЩО\r\nКЫБЭТХЩКБНВПТРАХЪЙЯОАТЦЕЯИЦЦДДХЕШНШЗЕТАУИНЬШСТЯЧАШМОГКХУЗХЯЗЧХЩКЮЧБУЪПУКЭРДЬ\r\nТЩГТЪТЩЦАПХЕЯРРЗЪМЦУЦРВПТЧЯЙВЫЫУФЦХЦДКЯСЬЩСИТХСЬЧУЯЗЧЯЦЦЬИРХЧЯНФВНХЦДИУРЧХСТТ\r\nМЩЦЬНЫУВЦГПЪФЩФВРУКДЩГЗЪЗЭНЯИРМНТСЪЯИБУЦЦУСЪШСЦЕБЦЦДКЦТЯЫПЬТЩГББЦВРТХЩДГЦВЧТ\r\nКЬДРЪЭШЩГЫЕЭДЮАЧПСФЪЩЩТТМЩЦЬНВУГНХЦДКДГДЙСЪЮЦЗЕВЪТКДЭЯЗЧХЬШЪИБСГЪБУЯЛИЕЬЙЦХВ\r\nРЩТТШЯЙЯИРСЕПМПТФЮУХРЖЦДШСТТКГУВИЭФАЩМРЬРЮЕФЦРЙШНБЕЗЧЯЧВНТУФИЬУГДЩМВЗХТАНЮЕ\r\nБШРЛЧХЩКГРЬЬДЦТАГЦВЧТКЩЧОРДСЧЩГНДДУУУВЦСЧЦХТАСФХТФАРТЩГНЯТЩКЮТЯКЪЫБЕФХЯЗЧАЦТЯ\r\nЦЦФАЩЬЕЯРЦТЧКЦЙАФМСУШСЧОЗЭФАШСМЕФДУДУЩЫТКВКЗПЦСЭЗЮФВРОЧАФУТЕЪБКЯХЩОИНЮМАШ\r\nШЕГЪСЗЪУЩЪАЪЫЕЩИГБГЗЯЧЬИЫУХЦЬНУЦДФАФЩТТХЩДАКЯОЯИЖЗЯИХКШМЦЬДЦЫУХМСНЗЧЯЦЭИЮН\r\nЧМЯЖЧШЦЧГЗХУЯНУКЦЦЭАЗИХХЧЩСЧАКСВДЦХКГЗГПЪЪМЦСЯЬКДЩУУЫХССЪХСМЧФЬКЕОЦЖЕМЦЧБЦЫУ\r\nЯЯЦТАХЯМТЧБУКНХЭЪНГХЪМЦЦСЪЩРЧЪЩДБУЯЧЯЦВЧОЫАЕЬЦУПЪРЮЩАШЭЕИРЩФАКМЦЪУСЦОХССЯЦФ\r\nУБЦБДЦТЯЗБЦОЧАФДЦЧЛЯЙЯЗДЛЧФЯЛЯЦЮКЭЦЭЕДДФУЭЦУШЯИХЦАМЦХШИЮНЧФАУГУСТЪЗСФВЦВЧАЦГ\r\nФВИУНДДЩСФЩПФЪЩНСЧХЮШРРОРЧТГХАХЮШРРЮЩАШЭЕИРПЦАПХЕЯХДГЙНЬУФНИКГЪУУЮЕГУЯНГЕЬ\r\nЫЧНЮХЯИАКВКХЦХКГЗГБФКЯЦЧФЮЕЦЮСЧАСВЧЧЧЦТЪЙСОДЧДЦДДИНДИПЧГФЯЧВЗГЦЭЫЙЕРЪЩШЩХСГД\r\nЦЮЕГКВКЙЪЯМТЭЯЧСЪЦЦЭРЯТЪЧБНПЪЯСЯНАУДНБДРЪЫТТФДЗТОЦТЪЗГУЮЦЧТАХСЙЧЗГБГЗЮЕАЪУКДХЯК\r\nБЦВРТХЩКДЦФУШНБУЦИ\r\n";
        string key = "сети";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test7()
    {
        string ciphertext = "МЗЮНЮХУЭЮРРЗХЦШКЩЙОПЮЖКЗКВХПГЗДПВЩКЪМЯМДППУЩБЫЦКЛЕЦУЖЪИЕВПУЩПДЙЗНВЫУЖЬЫЙЛ\r\nДЦЫЮАЦБЕПНАМНЫПЭУЯХЮЭИСЩДОЧМЕНПЯРЧЦЬЧКЗФВЮЦЪЭИГЭТРУЛЦКРЭОЬЧНЖЗЛЛОЯЧЩЗУДЪФЬО\r\nМЗУНЯВРЖЛЫЧНЯЗЮУРЫХНФВЮЦЪЭМЯНДЦШЛЫКРВЕТЛЯСУБВНЦХКЙМПИЭЯУЯДШНБВАМЩБЦБНЗЪКИДЛ\r\nГЭРЫМЩБФЯИЗЫЗИЮФЗЛЩУШЪДМЗКРШУКВИКЩЩЦХМВНЛРГЙЦМШЩДАРЦЦЖЙОДЯРЯРКТУДПМЬОВЦЫЛ\r\nВТЩЛГЩЦЛЭФКУПИШЯКПЬЩЛЕЦЦПКЫУХЫЛНКЗЪЩБШЩОЛОЫУРТЦМВЛШЫМВНЙНРРЛРЮХЯЗРАЩОДСНК\r\nВБЧГЖУЯВЗЕРОГЦВЛГОЫУЦЪМЛЕЬЪЙЦЪЫЬКУРОЦЙНФЗСЩПИЦКЕМОХЮАЦВЛФЬШГДЙЪФВЧШМЩЦТОФЮ\r\nЩЗЗЪБЭРЫЩПИИКОБРАМБЦГКРЪММБДЧЛОТЩКЫЛГВСЬНЖЪРЛЛОБНПЫРНПЗДУПЫЩСНЭЬВГГДДАРЩЙЯЮУ\r\nЗКРЩЙЯЮУЗЯУАУЙЫЪНАРЫРЙЦЩЙЛДЬОМШШДЙЗЫУЖИЦИЙБСХМЩЦБЛТНЬИЙЧНЖПОИКДЮЗЕУАЫЮГГД\r\nАРЪЛЙДОЯИЗЩУЖВХНАРРЩПЕРСШДОЦЖДХБОСЬЧЖГИКЗВШНУДМЮЯМЬЧЛЦЪТАЖУШЮЛЦГЕНОЬЪЫЛНОЗЯ\r\nЭОЦКРВЕТЛПЕШЯХКРЛЙЗНАЬВХЛХИЦНКВЯРЗНИРКВЕШГИЧННКДЛРТФДКБЭЩРДФЬПРСЩЛЫЫБВТУШЛДЛНЯ\r\nУУМГЖЦАЗРСЩКЦУЫФКШЛМИМЯИКРГИДУТЕФОЧМГЙЪИРТУЛДТНКСЙЭЮБЩЮМРЩЮХЮЪЫТРАЗЛЫФМЛЕ\r\nЬЦЬЧКЗЕРТЩЯЖНМЕБШЩРДШЪТЗЪЮРЦТМВЧРЛРЦУНБРЪЛЖГЦВБВЦШГШЧНИПУВГЗЪМШОЦЬОЫМРПДОЧЖЕ\r\nЦЛКАПЮВЙЯЗВЫУЩХЫХЫЙВЩРЛТТЗЙООЦЪНРЙЛОННМЖЦБЭННМЙДТЗЯУОПСНЪНЮЭЯШЮЧОЯПЮЦЧЖГН\r\nРЗРЩЗИЮЭЛЭНКВЖАЦБЕОЬЦМЪГФИАТРЗЬРБХКГНИДЪСВЖФРНДЩНОЗТЬРШЫМЛСЮРДЪНЦВОЬЭВЦЪЫЕОШ\r\nЫЮЪНМШЗЭЦМЪГЮТДОЬРБРБЛСЬХЮЭГБЭНЦЧИЦТАШУАЫМХЫЛВАПРБЦЪЫЕМОХЫИЦМЕХТУАЮЪДИЮЫЩ\r\nЭЗЦБВТЖРЛГЦМВСЬШЖВИКПРСЩХИЦЗДХЪЦГГРДЕДЬЬРДШВМРЭЩАДМТЙРУФПЕЦРЛГЫЩПИРАШУАЫМЧНВ\r\nЭФКЩЛЮКЪНВФЛЙЮЩСЛЛАЩЙТТНУЗЩЗЬНЪНЮЭЭЩЙЙЯЗПЮНМЙДТЗКРНАМЖЦЧЛСЬЧЛФКЙЭМЬРАДЩФЕ\r\nЫУШЖЫЧПЕДЬПЖБЦЛВПНУУЭИЮЯНУШЖЫЯСЛРЫУЛЮТНАЖОШГШРГВНЦЧЮБДЦЕМОХМИЦПШЛПЖРЦТА\r\nШУАЫМЧНВЭНЦПМВИЗЯЪШЩЙЫНВЛУЕУРЦУЗЯЗЯЗКЦПЯРТНПЛСФЛЭНКВЖАЦЛОФЬКАОРЛЯКЫЭГБУДЗФБЛЙ\r\nТХНЙРАШМОНМЕКЭЩДЦУТЖЖОСГГРЕВУЮРВГНВЛХЮЩАГЗЬПРУЧСЕЗСКВТБЮИРКВФЫРКЙМЯНДЦШСДЪДУ\r\nУШЛЕЦУСШПЦЩХЫФМВЖБЧЮЫАЫЗТЬЧГДЭНПЭЯЩЯЦТЗИРРЦЖАШЪОФЙЩНДПННКЖЗПЫЙЮЕДЯЙЛЦАТОЗ\r\nЪЗЬДХОЛОЫУЙУЪЗОНЬНЮШЩЭГКХШЪЮКОЕУОЦЖЛКРЯРМЛАИЦАЕРСЫЮКРЭОРЭЫМШЦГЕДЭЫЮШМЯПВШ\r\nУКЖИЖЧБЯШГГРДЙРАРФВЦИБРПЫГЯАЗЖДЪУОЫЯДИРРРИЕИЛЬФКЩИДЪННРЪЧЛЫЙДОМЬШГНХНБРЮЩБЦЛ\r\nНЯРЮКЫИЦАШНРРОДЗСКРЯРОЪРСКВЪРЛХРМВУЬНПЫФРМТОНГЪУЗЯВРШГЗТНИЮШУУВРКЬЧЬЭУДУНБПЬОМ\r\nЪЦЛЭЖОЫАЮХНЯПОАМЪРКЕУКПАЫКДОЗЩЖГЙЩЯБЮПЖМЙЕМЛДЦНГЪОБРЖЬНМКРХЕВЩЗЛДЫРЭЖКМЮД\r\nЫЬКРРШЮЭГБЭНОЬЪШЫГТВБТЛДКРВЙРЛЙЮНДИЗЯЭЮВЪНЗВШЫЮЭКРВИЦЦЖДЭНПРЧУПДЙЯЗВЪУЛЫПМЭА\r\nБСИЦТСЭОЬМПИЦЮИРТРЙДЩКЛДЩРЗАШЪОКЪРЛГЦФЛЙНУЛБНРЭХЦЦЪХФНРЯЫШЮЙЯЗИЖОЫАЮХЯОФЮР\r\nЙХЪЫКЗБПЖШРСВНКШМНЪНЙВЩЗХЮТЯПХТЛРХХТИРЦШГИЦКЩМЬЩУДЪЯПВЪМЩБФЯАПЦЭНДЧПЕФНОЮ\r\nИНКЩПУФАЪЦЛВИЦЦЖЪКДЫПЙРВЫКТХМЦЬЮЖИЗСВЫШЖДЫЬКПБНМИЗЗКВХНЮБРЛЬСУЫАДСКЫГРУХЦШ\r\nКЩЙОПЮЖКЗКВВЛЛГРНРЯЫ\r\n";
        string key = "эволюция";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test8()
    {
        string ciphertext = "АРТБКЮГЭАХЧМЮИЦЫЫИУЗЙВЧЮТЪАЦУХЮУУТВЕЧБУБУЕЧБСФНРЦЙЩИШНЭПМЖЦЦГВЕЬНМЮНЗЪРТЪХФ\r\nЦЩЯВЬЫПУХАНГТЫЕХЦДЭЕЧЧЮНМЗМХКЬТБВЪГЖМЦЯЬГЮШНХВНПФБЛЯЛЙЮНЩЙХЛЪЗЙИКВДТУОНЛТЕУ\r\nЭХНФНППЙЦЫЮТЭСЙБЧЩЪСОЧКЛЮКЪЬЮТЪХЯЦСЯШЭОЫХЙХУГФААЮНЦНВГАЬУЪТДАУВФПТФРДТУЬОИУ\r\nКЬДВЧНГТОСОИЯРФАЩЖФМСЩФБАПВЧДГТКВБАИШКФЮУЦЕЯОЬЦЦУУЩЯРСЮУНИНУАБТИУЦЬНИТТШФКЖ\r\nВКЦЧЯОЭЧЧАПЩЯЮВЭККЦИЬТТНЪОЙЦМСГЫУПУНТАЬТСОЬБЕСМСВХФЪХРДЦЩГВЕШАРЦЙЩИШНЭПТФУЯ\r\nУБЛЯЛМУЕЮЪПВМТЗЬНЪГЪОХЕФЭНЩЪЯРСЗФСЮЦЯШЕЭРЧЧЖМЮХДФЫМЮЦЫЪЕССЦЦЦХУГХРИКЛЮШПЕТ\r\nАТЕЙЭШПБАОАКХВНПЯРОЭТТУКБТЧРМЖТГПЩБАОПХДЭСВБХЦФЕПНТЯЫЯОРИТГУУЬШИЫХЙХЯРФЫЕЩНГ\r\nУАВАЪИБФФЯЩЦГБИЪТДЬБЮНЕТЬКЕЯЗСЯШЙЦЙЙРЧЦЭМНЪЦЦЩСЦЦБЕЭЧЙБСЮАУОСНЛГУФАЗТЪЦТВЧСФЫ\r\nЯСЧХЦИЯЦЭЯЪЦСЯЗДЮХДФЫМЮЦЫАУОЪЖХЬШЧЪТАЩНГТКБЧВНМЬДЬУУАЦЕЭЧТИКЮЯЛХНЕЦСРЩСЕКЪЧ\r\nТБАЦЖЫОЬКСВТСЫВИЩИЙЪРУЧЫАОЙЙУДГЯРДВЕЦЯСУЧЪЕШКСЦКЩЩТЕЭЧСЯЬГАТЭЮНЩТЕГТЫИЛЪТЮЕУ\r\nБХРОАЙВЧСЭРИЭФТЬБШАТАЮБСЯЗЦЫИИССЙГУХНБТМЧМВЧЩЙХСЦУЗЯЕЮТЫИУЕЙЦЖЩАУРМЩЯЯЖОДЮ\r\nМЫУЫЦСДДЮНСШУЯСЩЯРЮЮЖЧХШИЪБТМХЬЦОЭЧФИВНСВПЯЫБЕЭЧФЯОУБХРФУИЫХМЮБКЪОЖЯОЮНД\r\nЛЪХЙЮЦДУХДФРДВБЮТБОНЦЦУКЮЯЮМЪФЯГКИДЮУЧШЫЙНУГРНФЧДБТМЧГСЧУЖЩДУФЮЕЩТЯЖИЯГЯИ\r\nЮЕПРЪЩЬРЗМХРСЪЭАЦКЪХЙШПЯГЮКЬЕЦЩЧНГЬЕЬЧСЯЦГОШСЫЕХГНГНБЯГНКЩМЮЧЩНЪЬЦЯЖМЕСЕРНЦ\r\nНЗОДЮМЭПЙАЧЩЬЮВЭЧТРЮЩЗГВЧЕХГНЦЫЯРФЭПЯЦНФХСЮНСЦРЦХЪУКЖТББТЕЕОЮДЖГУУВХМЛЦЕЯХЩ\r\nТЭАЧНЛХЕЮЯЛХОУЕЬЕВДШСЪЫМСРНЯЮЙЭЧДГНВДШКФКЭЦССЭЮПЬЕОГНЫАТАЧНХНЩЬААЕЩЦХДСЦЭРП\r\nЪТГГБИДЮНМЙЙЧТМЧФАЩТЯЦУИЪБЛСШРЦХЙЪЕВМХРЩНИООСШКФГБЭАЦНЪЖЯЬУТНЯРСЙТГЗБТВИЮБРЯ\r\nИДДБЛЯЛМГБДУХДФЧЙЬБЮНЬДЪПДШЕГЧЫЬЭЧЖЯСЮЧЮББУИЩСЯГВИЬКШЯХЭНВЕШЦДЭАЭАЭАЩКЦЯРНЬ\r\nЮСЫУХЯЖВДТООЕПСУВЕЙЕЭЧЖЬКЮЪОРСЩТБСМЮХДФЫМЮЦЫАУОЪЖХЬШЧЪТАЩНГЮУЩАФНЪОМШФЦ\r\nВТЫБФТХЙЦВЦАЧЕСЯЗСДЮРЭПЧПНХЧООЮУРИЧЯГЮЦФЕПНТМЧПВЧКСЩДЭАУУЮЖЯГБЯУКЕЦЧТЭНШЮХР\r\nСТМЪНЭТВЕШЕЦЩЬЦГЪОПУДЮЕЬЪЧАОАИСГКЪХСЛЙТВЧЩШХНФДШЬУБЧЭСЮКРТУЬЧХЗЩЕЫЩЧЦЭМНЗЬЦ\r\nЯУЮТФОННПСЦНЪЕВЯЦПЯЗЩСЕСЪЫМСРНЯЛХЪИФСТЩЙХНФОХЫУГААЫШНХГЕЬЬШВМРДВБЧЧЭЩФТДУЗ\r\nЩЬВОЬНДЮЦЫАЩАЩИПЩНЯДХЦАРТБКЮГГИЧБГЭВХФРРРТДЪЧЩЯУЕХРЕМРТАУАЮАРШКЭЭХВЧЕИЦРНИХ\r\nМФКЗЯЦЦЮМЯЫХМЮЕХЭХЖМРДЫЗМГИИШПФДИСЮРНПРМЪЦЫАУОЪЖЭЦЦГФРВЮУЖБКЭСЦЕЩЮМЮАЮЧ\r\nГЧФРМВБУЕЭИОКФВНГЧВАБНСЦЦГВХМФРМВБЫБАОАКХВНЯЯРЛИТТЪПСВМЕЬКЪЦРНРШХТНЛЮНТНЫООАН\r\nГНШТЬУТНФСЦГЪВЬРКЦЦОЕЭЮРСТХАУУЧЧЛЪКЙЯЧЦИБЧФЧДЬЬГАЦЕЩЮМЮЕХАЫЖЩЕЕМЧНАСРММТУЕЮ\r\nЯЮЙФУСВЕЭЕЗИЧКЙЩЧСЭМЯЩЦОЯСДЭРТФТХЫУЭЕШГЬКЫЦЦЫАЬУЛМЯЫЕЭЖШЛЪЦТЕНЩЪШСЮУФЩНСД\r\nРКТКЫГУТНЫОЦХДЪТЦЯХОНАЫЮАЭЦЫЯТКСКНЮНВОПУЖБКЭЧЭИЫНХНСДЪЬАЮКРСЧЩЬХКЪИИСЙУТФЦМ\r\nЧМЬКГЯПЯАРТБКЮГТЫЬЕЛЩРСШХЛМТМЦЦГТВЬШКИВКВДАОХУЦЦЫВАЯАЭКСЩКЭАВНСЦХРПЦЧЦЕЧЕСЩГ\r\nЩВХШФРУЯЦЯФХТЪЗДГБВСБВЬЕЫССЩБЮДЪОИЦЧЬЪХГЪЙТИКБЪЯОРУЕЮУЦЩРНЛЧМЦ\r\n";
        string key = "медсестра";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test9()
    {
        string ciphertext = "ЮУЙЧШУГШЗЕЕДНЫЖЕЭИФЫТХБУХЮЕПТЪКШНВХУПЧАХРОЫЪСЪЕСФХСХЮЖЭЬТЦВПАРККЗТГВБВЮЖФК\r\nЮЦРНБФИЯЛТЗШАЧХМАЧФНВЖЮМРЭФТХРЕАЛМГЕГЕФСББФЧОГПЮКЫЬТФХЪНЭЙЭЮЖУЕЧЮХОШСЮЪЦДУ\r\nЫЭФЫИАЧСЮШНУХИЫКШЙГОУАСУТНОЯСШБХЧЛГЧЮМПТЮАУЬНЬЛУЪЕМФАЪГОЫЪСЪЕСУФОУЪСЮУВЕЦ\r\nБШВИФЗЯШВСШЭРОДБХЮУЫТСЯКЙНТПДВЯЦУЭУВПЬТИЩХЕЦБЛБЩНВРОЧГСОЯИЯЗНКЦЖЮХКЬАЧЙЮСБУЛ\r\nАНГЧХНУВЛЦЕИНПИУЪСЬУФУДПГЬОФТЪКШЕШЮОЭИЪЬХТЭЮМЭЦЯУТЬГЮФАНЫЦЪПЦЮФПСАЙХСЩРЕЧД\r\nВДФГУЦРКЪВКДПГЬЕАЕЮАЕСУЧОЧЬЯАЕПФЫГАЧСЪЦЙЪЭЛЭЖЛКБУХРЛЯЕЩИАПЯФЕЧЛЧТШАЧХНПЖВНБУБ\r\nТЙФЦДПЮЖВАИАРЧЙЮГУЭЛФНЯЕЪПЯЛФЪНСИЭЖЕГЬФКЩЕБЙЮШИРГВУЪСУВЛЖКГПЮКГГХЧТНЗХОЦХУА\r\nПЪОЯПИЮЗЯШГЦЪПЬРУЫНЪИШОШГЗПЬТЗЪСОЬФЩУЫЗЮКАХНППГЗЮЖЦЮУЭЙТНВПЦЯУПЗЭКЭЙТЭЛЩУЭЕ\r\nПЙХЮЕАКЮВВПЯЬСХТАУСОУАЦХНДББМШФЮФИАРШШАЮЖЭШЙЕБУЫПТЯУСЗЫЖАШВФИАМФСУТСТУГС\r\nЛТЮРЛУШЗУТОБЩСТХТТШШШЭРЭЦДНЭЖВАИЩРАТЭПЬТСЪНЪПРРГШКЬУХУГРГППАЧФЕЦЙЕХМАПАИЮЕБС\r\nУЭЙЕЭШАЫЬИЪУЙТЮКЯЭЛБКЭБЭПДВЛЖЕГЧЭБТЦЛЦТОНУПДГЗПХГЧТЖАЭГОЙЧДВЖЮМРЭЦДБЭЙЭЮОПДЧИ\r\nЮЦУАГЩЧЧХЯСЫТЮЖПЪЗЧБЫЬСЭЧЯУИЖАШВАЦТСЛНЫАГЦРЪЬЭЬЯШОНЙОСШОУИОЧУДХРЗШЭЛФЗЯКЬЖА\r\nХИЖКЮЧАЖИБХПЪЦТХГАШНПЪЪЗЮТВЮПЧТТТШАИБССХЧСХОАШНЭЗЪЦЯПЮМКЭЗТТЭЬИЬРЭГБХШСУССБК\r\nЯЕФРБЫЛБНЙКБЛЫЬЛЮЦЪЪЮМБУЛЖКГПШНВЮУБХЧЧЮНРВСТУФКЭЧШЭСАЫТЗЕПЧХИФДЪСХМХЮКЫУШТ\r\nЮТЕМИИКВЕЧФФХЗЧЧОЦПГЕЮПЩЕЬУЩРБШФБНЯКСЖДЖИЬТНОБУБЗНЧМВКЭЙТШФБУВНЪБЯРХФХЪЕЫИУ\r\nЫСХКЯЗНУЫЕЦЬНЬЕЫЭАЛШЧЦДУЗОЫЪГДУЯНЪПЮРИЮНГЕЫЙЦЮФВЙТХБУХХРЬАЧЙХАЕХОЧНХКЭЖГРОКФ\r\nЪЦРУШЫЛЧФАВВЬЪРИЦЛЪКШОББХЯЕЯЫЛЙВАЛУЗАХЭЬШФГЫАБНББЮШТЭХТМЭПЯГРЭЧЧСШОЕХУФЦЯКХТ\r\nБЯСАЧТЗШУПНХЧЗНЦЪБЪЛЕПТЪДШПЙХРЩНГПЫБЧЛЕПГЛНХТТЭИАСАЧАААРФСУРСЮИУШЪЬУГЧМГЧЮФБЕ\r\nДУЗОБЖИЪУГЧЭЬЬЯСЯЧВКВРГРЕЧЧЧРПЙЯХРФСЬУВПГЮЖЭТТМЛГУХХАДИКЫБТНТЭЪТЗШТЕЮУЧНВУБТЫШ\r\nРФСТРЛКЫЭХФХЧЦЯСШФФБЕФРПЯЕШПЬУХУЗЙДЫИЬТНКББЯЮСЕКЯПШЙЧЮЕЭРОТЮПЕЪУЭЗЧТЭЬШЯУЧМЯ\r\nЕЭЙТЭЛЩУЭЕПВЮШКЩНЮКЬФЮОЗОСЬУВПГЛИБУШКШТВЮОЛМАЗРМЫБЯСТТЦВПТЙИШЦДЕВЭШЫЛЖТАЦ\r\nВЭЫФИОТЪДЭЙЭЮОПДБДВОУФЩПЧАИЮРББЪФЧЕХЮТДШМАПАИЮТУЬСУКВЛЖБЫЧЗЧТТЦВЙЫАСЫЕЯУТЬИ\r\nЮЩФТЪЗРМЫБЯАУФХХНШЭРЧПТСШОШЮЗЬУЩТРШАЮОЧЫТНЧВЮШЙПОККУПБЪУВЛЧТШАБСЬПЗКНХТТБ\r\nЩПХЧСТОШДСЯСТРМОБЩСРЦДЕЭПХЪИЧРЪЗГИЭЮПАКЮКЩОБЬНЯШХШЪБЭЯУПЗЪРЮПЕЧЮСЕЭНБЭБЭИЫЦ\r\nФУБУБАЖЭСФКЗООЩУПЖАЧЭЙЭЭГБХАТХОШГФБХТЭШНОЩУКЫТХМСОЖГЯБЦШЕБЧЫВУХЕИШЦБЭДКРЬХЮ\r\nГУТЮЫФТРРШБЬРЧПАРРЖЯЯГЪПЪТЛНЫВЗЮУГРЮГУЬСУТАИЮЙЪБССХЧСХОАШНЭЗЭНЗОБЧРПЗККУПАШНЭ\r\nРТДЯБХЫССНЙЕЮОВЮУПМЪЧХМПЭЮЫУУХРИБЬФЭЗЮКЙБЮТФФЖЧПРШШБХСЕБХЮУЫТСЮУЭУЦООХУКЫ\r\nТХБУХЮЛСКВУЫПЯБХСУЗХРВГЮФББЪЧАФДЮФББЕСШОШФСЫАГРШЖХХОЧПАЙГЩЫХЛЦРАФРНТВРЭЦДБЮ\r\nОФЛОСКВШОЪЫЩРЭУДРШШУЫФОЛЧЦВПЭЮФББРЙАФЦШПРХАЦРМББЯСИЭЕЧБДЮЪФЧТТШЖХЭИЫЦЕХЮГ\r\nББХЧНЦЕЦЖЩХФБУЬУБУЫБФЭЦДХРЕУВИЪБЯУБУПОЛСКЭНЪПЧГЫЧКЮСЭПЦШИЬКХЕВЙХЭЮФУИКЭЛЫЫЛ\r\nЖТАЦВЙАШНЭРТДШЖЦЮЩПХГЧТПХРРЧДЪЦЕПЧПХЭЧТНУЖГЖИЬЕЯКЯСББХЧЗККУПЯЮРПХЗШХДБАГАФВЕ\r\nТФАРЗУКЬЕССЫБХПСЪНЮТБСИЬТАПРИАМТОЧЧХЛЦЫЧРЧЪФКФЭЯЭСТНЧТРЕШПОЧЦОЧЮДЧРРПНЗФЮНЫЫС\r\nСЕЯНХУШЬРФСЧТХЖЦХУЕКЯЙЮГБЫЯЬУФКАОБАГАЦДЕТЙЮРНЕКЯЧЛРГШСЮНГЕЭЙЫТРФЭЯКУПБСОЧПТЫР\r\nСТЮРРАЭПАБДШЕЬУЬХРТБВГФИАУСЕУТГЪЕЗУЫПЧЮПЬКДРШЧУЪСБУВУХУУЪДФЦБУЙБЧЭСЭЖЭНЗБЮЮШП\r\nХТПВЖГЗИЪУФКЪБЭРНФИАРШЧБЫСРЖНЦВСБСИТШЛНЩОУЧГУТЪЛЭАТЗИЪГГЧМСУЧЕЧЧТДЧБДЗИБЬЧХХРУТ\r\nЮЯЕШЕЫЙАХТЯКЬРЮОАГБСУЭГШТЮРДВГЮАБМПССЪБККЦЖДВСЩУГЧШОШЦИЪНЙШТТЕТИЬТАЦВЙАЮЖЪ\r\nЕФТЮЖЦЫГЦЕУКЧГДПНЭОДКЯМБВЮРКЩЗБАЭЮЖЭСЪРЮТШАЗЧДЩНЬОЫХЖЪЕЩЕ";
        string key = "петербург";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test10()
    {
        string ciphertext = "ГЬЦБТРЦЬЬПОТЬСРЯЬЗАЕРЮЮШЩЫГВРРМЕОРГЮРМЫБДКАВКЩЦЭЬЪЫДРЙВАЩМУУВДЮЗЫШКЩХСГБЖОШ\r\nДХРЭАНМЬННЧЬЭЕЙКРРМЮЦГЧОЗРЬЮМХЩГКУАЩЗТАЩЧИУЬПЙМЮЯШАЗЫУЫНЯАЕФМЦШЬЮШСЩЬНЕЭК\r\nЫЭДКЖКЫРЮЮУФЦЬЧЬВБЯЯРГЖВХЛОЙЯЬЪФМЬЧИЪЬФАЮУУОАНЫСХКДЬЫДЕКЭЯКЕЬЦДЕЫЦХККЫРНЧОЧЧ\r\nФЮРЬБРЬИДКУЩРААУГЬНРФЛЗТЫЩРЩФЬНЧЮШСЩЧДОШДТРМЦЬАЗРЯЫЯРЮЬУАРМНЦВДКТЦВБЮШЯХКУ\r\nЩЩЮНЫЦГОВЩЩЛЭУХАНФУЫБУУЮЪБОТЦЫЩЫЯХДЧЦЬНШУХАЮВАРЗТЧГФКТЕРНЧЬФАЛХАУЛЫЛГТЭРЩ\r\nРБЯЬФАСРЮЩФЫЦШФБУАШЧЬЬАНОМЦЪПЕШЩЯДУАЩЮЪУВДКНКПЬШУЫАЯРРЫБЩУЮЪЛТУПНЯОУЪОЮЭ\r\nЩЩЯОДУБИТРЙЪЙЭГОРЮЩЙЪЦЫАИЖРЩММЫВЬКЛЮРЮЫЩПИДРЫШКЮАЩЦБМОММХЯГАЮУАЩЕЧЦЭЪЛ\r\nРЯЦБСЬУТОЗЩЗЙИЪУАЗЮАРМЙНЮИБОЫЖЙТФЦЬЬИУЭНМЫСЮБФЦЦНМЫЯФЧЛЭЩЮЫЮЯДДФУЧЬНЯАЕФМ\r\nЦШЛТРЦИДОЭРМХЦУГБЩОДБФРДЙДФЫЛНЯЮСЯДШОАЖЪЦФЪВХЮШЬШЬУФЩФЬФНПНШЪЙВЭРМПЙЪБЗВЫ\r\nНЙЫРНФЧЖРУЯНУГГЫДЬЪМЫЯЯФГВЦЧКЫАЮАФЗЫУЫВЭЯПОВЯЛЗТШВТЙЖЮЩИХЬВАЭЗЫШКЮЫЩЬКНОР\r\nИПЭБАУЗЪПЗМАЯХКЗЯЭШХЬТМБМАУЮЪЬЦАНПЬНЬЪЦЦЯБУЪЩОЭНЮТАРРЩЗЙЫЯУКНКГПЛЩЩДБТОЭПЭБА\r\nААВЫШКЦАЦЮБЖУФНЯРЩДБНКШЧЦГСВЬМАРМКАЩЗКФЫЩФТЫЩЫЮРЪШКРЬЭАНФОРОЮНЮЧАРЯЭЬЯЬИ\r\nЯКБЯШЧЩЦЯЦЙРХШЬДЫМЮЛРЛЭКЩБЭЯБЧЬЭБШЬВОЭЭТЛОЙРЯЩИРФШКЮАНЙДФОЭБШНЭБКЙЫЛЖЫЪЩД\r\nШУНЬКПХФЭЫЖОЧДЬЬОДЬЩАЩЙНХМФЬЗАЬЫХХАЧМДЙАМАШЩГЛРЩЗГАНЦХКСЮЩДФРЦЦБПЦКЛХЯНЮЬ\r\nКЫЛАТФЮНБПОЧКЦРШХЗБТНКЮЭЯЮДПОШДМЯЯФМЗЪРЙЪЦЫАЮЗЗРЮШЦЗЧБСНЭЙНТЗТОКЩРОЪЦЪБПЪШ\r\nУЙЮЬИЪЙБУЭЯШБТАЖРЭЛОЭЦЯДДЩУЬЖХУВДДЧЬЭЮЫЮЦЯДБРЩНЬЬЭЪЙВЫУЫПДСВНМЬЧНТЩЦЪЙВРЩГ\r\nПЮСЛБПЦРЯЫЯДЦЬТНУИЬУБТОРЮЛДФЭСВДИОНЯЫТДГЮРЯЭКЭФЦЯЙЭЪЪМЫЯЬТЮНУШДТЪЦЬЬФУЫДЪЙЩ\r\nЧБЖЬЬОЫЧЮАЯРРШПЧОСЭБМЯЛЙСЮСИЬТНЬЛНЯЩДБННЫКЮЯЩЪЭРФРНЯРСЪЮЯАЩИЪУГЯДЩУОКЪУЯУЧ\r\nЩЫЩЯЫАЯЭШМЬВОЫЭЯУБЖЬШКЮЫЯЩЬДУЫФХЩСГШРАРУТЯГФБПЫЛЫПЬЪЯЬЕЩЛЮЪЙЭХБТЬРИЧЬГАМР\r\nЧНЯШОШТСРПДБЮАУТНФОЦЮТЩЩЙБУАНБЪЫМЫЭЗЯЬИТЮГЯЧЛЮЮНЮШЩЫТВЮЗЙЫРЯДЗКДРЕЫШЯЯУЗ\r\nЫУЮЫЯЦЮЙВТБЬЯЦЬЧОПЦФЛЫЛГБДЪУЭКСБУАЗЮЫЩНЯКВЧБЙЫЛИТЫЩДЧОЦЬОЭЬЫТИКБНЧЧБХТЙКПЫК\r\nЕБУЩКТРРГСУТЪУКРРГСУЧЧЗЗХЖГНШЯЯКДСУЭТЩНЯЧЛЭЩГЫЮЮЧЮРЩУЙТЪЯЛЙЭУЬЗТХМФБЙТРЙТЭБТЮ\r\nЗТШЬМРЬТНФКННРБКЧЙПЬФИРЩЦБМЗТЫЬЮЯДШАЗЫУЕПЬВГБНОЫЬОЯГФЬЕЮЩГЪЙЪХБПЦФДЮЩСФЧТЬХК\r\nПОРГОТОЬОЙРАЧМДЙРГСУВОГВАЫКЪБГТДУАЫКРЬШТЛТУЭЙННУАЭЫУЬОПУГЧИВБМДЦЯГФКСОНЗНШЫАОР\r\nЮЩИАПМЭЛТЦВЬЮАЦЯЮЗЩУЖХЧЫЯЫЙКЛЗТШВТЙЖЮЪЬПЩЯФДЩЫРОЭУТЕЪФШЩИЩУЮДЬТЦРЮХХЮТ\r\nИЗЫУОИУВДМРШУОХЮСЯЧОЦЫЬЯЮЦББЫЦЭБНРМЮПИОФОТЯНЪЮПУЧЗХАЦФКУЯЭЬЪКГЧЛВТГДТЮСУЧОУ\r\nСААЦФХЛРННЗММГГЫУАУСЫАУАМЗЫУЫЮШСЩЖКШВЬНТСЧЮХЦПБЭУУЯЫВАЛЖУУОБДЕЮЛИЩЙЮТНФ\r\nЮЮАФБЩЯЬВЮЛЖДУЦФЬДШЛВСЬЭЪГПЦАЫПЫССЙЗЭЫДМХЮОЙЗАЩЗЙШЯЭДЩЫЩЖНЩЦЬНВЫПМАЦЫЧЯ\r\nРПЦДУОЪКБОБЩЖЭБЧЧЙКМШКХШБЪОКШЛКОЮСЩЬСЮЛЮШУЮЪЫДЯЭДВЬГФКТУШДХЯЫТГМЦЛЗТШВТЙ\r\nЖЮЬЫСЬУЪОЭЪЬЬЭШСЩИРЪНЧЮЪЦЪЮВУЭНМЦЫТЖЩУЦКПУЫЪЖВШЪМНРЩДБНКЩМНТДЫНБЫЛМЫТРГ\r\nЧФХПКЭЬУЪОХЕРЙЩУЮСЯВХРОДЦЫБМРЯЦЬПЩРЭЫСЦЦДТЩЩАЭЗЗЛЗХТЦЭКОЫРГНЪДЙБПЬМБЖОЬИЬТКШ\r\nБЩОЬАДНМПЫЩНАВЬДОЦЪСУЪБКШОЫНЧЬЪЮДНЬЬОХЪЯЧЕРАПЬЩЦШЦКГЮЩЕПЬЬЪЙРЬМБЖОЮЪЕУРЩДВ\r\nШСЬДЙРРНЯЫЯЯБУТРМУОЬ";
        string key = "вольность";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test11()
    {
        string ciphertext = "ЩФГУЭГБМЬФЗЭНПРШАПШЭБЦРЭФАЦБЦРПЪЯШЗЧЬЭПЫИГТССУФЦОШЪСУФЦБЯСЯКЧЫШНЧЛДФШДКЩЧКА\r\nРЛУЛЬКБЦНШЯХЕЫРКРНЭСЮЩСУФРУБРУЦЩЧССГКРУСКБЪДХЪАТЮКМЦХЮХШХХРЫАНДЦМИОЭЙРКСШЯР\r\nКФЦКОЩПЗБНВММСУЧКПИЕПЧМЩЮТЭСУХФТЧСЯЗЮХЯЯМЪБЭЦЛЫЯЯУТХЭЦРЬНЬРЖПМЫКЗИСНЧЛТЛЭЗХТ\r\nФТХШМГБУУБЪЗОСЬНЩМПНОЬНЕШЗФЧОТСГКИЭЧЦВНЛИОЭЙЮЧПЦОЭЙЮКОЦЦЭЧЮШЪФОЭЙРНЕНРЬКТХН\r\nЧЪАЧГЧЯУМСИЫИБХЗФИЮШНММЯНЬЩЙЦХЧСЯНПРФЫТЮЛНТФЪУЬНСШЪСАЩКНМЪЮХЮКНМЫЯУЕЦГРЧ\r\nЮУЯНПНЭФЬХХМЦХЫКБЪМЦЭБНФУЮНПЭФАЦЙУМУПШЯДШСЦШЙНКДСЯНЬУЮХСЮХШФДХЛЪНФКЯШМЦ\r\nРШЯМГБАФЮЩНЙМЪНСЦРЪЬЭНЫРЦНЬФМГБДУИФСЮЩСЩЩФЖЮУЫАФЫШЪУНХЪЫЗБЪНШЪЬШБЪНТМЪН\r\nСЦЗЩЫЭРМПНКМЪНЯШЗХВЧФБРУЦЩПЦЮЛКИЭЬУЪЦСЦЬЭСГКНММСЧАЫАНРЭРЦХЯКЭФИФИБЦУСХРБЯЪИА\r\nДЪЩБЦСЫШЯНПКЪЬЕЗИКДЩЭСГЫПЦОЬГФУЮЕЮЭИЮЩНЦЬВЛРУЗЩФАЧХФТЪЬВЖЪЦСЦЬККЪШТЪЪАФГЩЙ\r\nИЧЧЦМЧНЦРЬУЬЫРТЧЭТГЫШНЧЛДШЧНМЩЧСРУЗЩИЮУФШТЛЪЫШТЪДЭЭЪШЗИЮЭЦЭИФИВУЯРНЭИТБСЪБ\r\nПЙЪУМЭЧЭЦРРЮФРМХНХСРУЫДЧЦХАЧАЦЗУФЫУБЪЪЪМЫЛХЛГНЯИКЫДДЙЗЪУБУЗАЦЭСУУТЙЪЩНЬЩНЦЬВ\r\nЛРУЗЩФГУЭТЯТФЦЗХЩСХЪАНДЦМЧЬФЙБЪЯКЧОКВЩНЙЪШЧАЫАЫЫЭПЮЪНШЪШЛШМЙЦЭББЯНПНЧЧЗРНС\r\nЩЛАУФХНЛЪВХЮКМЗЩПЙАЫВЦХЖКАНЖЧЬЭСХОТЪЪЖТЮНБЦУСАИНМРСБКЯЦСШМФПВЦПРФСЩЮШЛНН\r\nВПТГОМЬВИШФЗЩЧЭЗРФЗОФУПЮЩСДЭЬЕЗИКИЮФЬХЪБКСЯЪЯЦСШЯРКШЕСЦРСНЦНМРСУУЫОМЦНКЧМЧД\r\nШОЭТРЯЯУИЬУБЦНЙЕФТЮНИХМАУБЦЛРЧЧЙАЫВЦХСТХАМНХАНЫЦИПМБКЬОЗМЦЭЦВДОНЬФЧХТЯНЮЮУБ\r\nРУЦЩВЦРФНЩЮЭДВНКДЩЭЖЫИВЦРПХПИСФЪАЩХШМЦШВЙРККНЩЧГФНИЩЮСШОБДФЯЬЕЯЦБНЬДТЮЩ\r\nСДЪБПАГСЦПЭЖРЩРНХЬЕЭИОЦРПГЙНЛТЪЬЫХЩЗЬЪЬЕЯШЗХВЧФБРУЦЩПМЭИЙЦШПЗВЦКЖНЧЧХУЮФЪУНЭ\r\nТНХСЕЭЫИМЛМЭФГЩЙИКБЗСНМПЪРЕЪИБЪЪЫУСРКЗУПЧХФМЫТЬУЧИРЦЭПЧМЙДХУЧТЭИГШЯТУЬТНХВФЭ\r\nЫИМЛМЧЖЛЩСШЪЭФГЩСРЮЛКУЦБТМЬНБЪПЫНФТЧРМЙЯУКВЩЯФЭБКЪИСДФЦЖРТЯКЦПТШЩСШЯУУВНФ\r\nЧЪЯФЮТЯНПЭШАЦБНЩЛЗСИЙНЪАЧРНСЩЛСАИНТШЪСТПКЙИЩЧЦВШДТЪЬЦВШТТВЧГБРУЦЩПФАРЛНЩОЗИ\r\nНВЦЭОЗФШДКЩФСАРЛНЫЯЕТРКДЩФКЭИЖГОПЧМЦАШМБТЛФРРАЭТЮФЗУФУГЪНПЦШСТХФЕРРЩУБЪЫМО\r\nЧЛХЪРЗЫЭУСШЯПЩЭОВШЯНЦБУАРЗРЭЧЩЮХМИГЧТРНСШМРУВИСДЦППВЦКДЦЭЛШМЙЦЭББТКНМФБЦПКН\r\nМЩЭНЧНВЦЫЪКЗКОШЪАЧЮФНЙЬПМЭЦЛЩФГУЭНЕРРЩУБЪЫКОФЙХХМИЛЬЕЮММЦШЩУЭЮДЧЪУТШФДЪЭ\r\nОЙЮЪНЛЪХКГШНКЩОТРМПЫПЭСАРЛЩЦЧКБРУЦЩКНЬНКРУЬЕЗРСНЧЛТГЖГУФЬШЯЦЬЪЪЫШЯЦСНЬЧТРЪПН\r\nЩЧКБЪЯХЪСНЫРРДУПСХЪМГШЧНЯШЗНШЬАЩТНХСЕФАРФЦРЧРЮЩЫЫЭБХРРБИЮЛТРЫПЦОЬКЭНРТЪЪБЪЦ\r\nМРТФФЮМЯЖЕФИЮТНХВПЪЮЪЮРУСКБЪМЦНЭРХНГКМУЫРЪЗЩФГУЭХЪЭЭЭУАЫЕНЩЧОЮЪМЦЭОЮШЭРЗ\r\nЦЭЗАНЛНЩЧХШФРТЪШНЬЧДШФЧХЮУЫЩФГУЭЦБКЬЧСБТЗЭПЧЙАИБУФЖКБТЗЭЭЧЦВНЛИБЭЖЛЯМЦЩФЙЮЦ\r\nХНЩЧЗРНСЩЛСУВУЗЯФФУВКОНГПЧЫЗЭБФДХРПБИЧЧТФШДКЩЧЪЬЦРЪЪСЙЮХЯЩЭЭЪАИМРЧЭЦМЦЦНЩЛС\r\nРУНЦЭБЕВТНКЭЧЩЮХНКФДФАЦЙУМУАТИКРЫЭФЮКДШБЬУБЪЗПСЫРШЧНЕЮЭСГЦМРШЭИЫРАГЮЛРХЛЙЦЬ\r\nПМАЫЧНЩКПАЦЛНЮЭИЮЦМРФТХРУЗУФЗБТЪНШЪАЧХЧДХЩВГАЦКДОАНБЪДФСЯНЬЩЙРБСУФЦОШЪСУФЦ\r\nБТЪБУАЫЭЩЪСХХФДХЩККГЯДХЗФНЧЫЦРЧЧТРРАЦЧФКВБЯЪСЪБЭЦРРАЭТЛЦЦНОЧЙЭЦРЦЪЯШЦИКРПЪЕТХЪ\r\nФЪРХРПНФЩПЧХШПРЮЭХШРРЦОЯКЬНМХЪШЩАИМЮФЧЗЗИРЪЩЭЦВРБЦЦЯШУУЗЦЩПИФНБЯСБААНФКЪУУ\r\nЯШНКЪУЕЕЩМИНХЕТАЗЭПЭХЮМБЦРЭОСГКЦРФЗПЪЫЩФГУЭЦБЪМЩУТГГКСЭЦЭЦБХЗДФАРЦРЩКФЮТНЪЪЯ\r\nАЬШНУИАНДЦМИЪЩЕЧИКИЭЛТХМНЦВФТХХМЦХ";
        string key = "империя";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test12()
    {
        string ciphertext = "ЬЬВЫЦББШЩЪЩСГТЦЮЪББУФХИМХЪЮЯОЙЮСЯЬЦГРУГАЦРЫУЯТНГРЬВГИКМЫЯЦКПХЪРАШНБАЯФЦКЮТС\r\nЦЪЗЪОЧЦЪРПЫЩЫЦВФОВГЫГХЫГЮНЛЮФЦГЩЙРХСГДОЮЩЯЧИПГШДЮИРХЮХЗНЮБЙГЫЦМБАСГРПЮРСЬ\r\nПМРАЯЫЙЪВОЭЯЩЙЮРВЫЦВЮЯГДМДЭЕЦВЪБРЭЩУИМЮРЩХИКХУЭЯУНФЙЦВЪТФУЮГГБХЕЮМНРЪЦГСУ\r\nЫЖЙЗМЛЯЭУЫУИПВЦБОЪНЭОАЩЩЯЭЬЮСПЯАУХУИГЖОГЯЛНТУЫСКВЭЬЭЮЦВШУЕСТСЛТСПЪНБЫЯУИМШ\r\nУДГКДАФХСЪЫСУХЮЦРВКЩТНРЯЮЩПЪМЮЯГНКНТЯЦУШДЬУЮСЙЪЫЦВАЫСЭЦЫСФЗАЬВВРИБШЯФЦРВБХ\r\nЦХЦХЯГУИБЧЫСИРСХЩНЮЦИБАЦАНМШЭБЯРРЕЬХЩКЧХСЯЩПОЮЩЩВЦРЫЬУЮЦИФУЭЯТПРАЩИНРЪЬЪВ\r\nШДФЙАЯМЯЭЫМЭРМБЭЦЫЮЗШЪЯВТНТЯЫЯЛНГЫЩУНПБЦГЦЪЯТБИЦЙМЮЪФЯМТТЫЦЭХЯБЕЩГГБРЩЯВДА\r\nЮЩЦЦЧНЫЬУЩХЪЭУХЯЩСРАЯИХЪЕЯГДМДЭАЯУЩСГТЦЮЯДБШСРЧДАУАЩЩЫУРАЦЪДАПДБЛДЮГУСЪЗТЖ\r\nСРХДЬЫЯФРЛСЬЬЦНСЛЯИЦУНТУЫЩУЗГЕЩУАЗЕЯРУКЪБЖЩЖЫЦХПЮМЭЖРРЦХНМШНЖВЪНЫЦЗМПЯДЦЫВ\r\nРПЮРСЬИМГФХСКЧШГВРЩСГТЦЮЪНТЕГЯЪЯЪФЦТГКЮЫЦЭИКЮУВЬРЬВЬГАЦЙРХСГНКМЭБЩХЮВКШСЦАЙ\r\nУБЯЩРШЧВЫРИФЩРИНВЮУВГДНБЫЯУИМШНАЯЩЙЮЩНЫЫОХАЦБЙТАСТМУРРЪМЭХЯБУЬЦХМЛЪВГЫГХЫ\r\nГСФЗУЬБЯМНЬАЯИРРЫУЮЮЦРВКЮДОГРРЙЩЭРПРЯУЩДЕРМВАЗЕБИЦЙМЛГШСКДФУЮЩЗФШЪАЦШЗШЭЯВЦ\r\nРВЬРЮРЭЭОДИНАЭЙЪФЦГБЬВГИБЫНЬСЧПШЪЦБХНВЙВИНКЮРЦЫРЖВЙВВЧЗБЬИЮЦВЮЯЯВЪЯТОВГЫГХЫГЯ\r\nКБЛЯЙЦСЧЪЬЬМУЗИУЮЮЦИАЬХЩЪДЫКВЫЦИЯЬЭЯБЗШСЯВЫГРЮВГКДЭЫЯЪЬЗЭОЮВЦБЮЧАЯМГХЮЧЫРРВ\r\nЦАЦХГШЦЩЬДВЮАМАЦНЯЩСГНЖРЬТДЯДЭЦЦТГКШЫЩИЪНЦЫЯЭИКЛАЯЪЯЯБАЩДЯЯЙУЪВЗЛЮЩЯХНЕШЭ\r\nБЯУДВОБЩЗЛГЪВГКДЭЫЯФЦСАБХСХДЮЯГСКЯЫЬВНХЗЗУФЯРМЮСЯЫИЙГЭЯУИСМЫСЕРКРЫГБЦОШЕЦВТТО\r\nЭЯЭЦШМЬТКНРВРЦЮХНБАЩЫЫГРПЯЬНДТУВЯФТОЫЦЧНКШСЯВЫГРЮВГКДЭЫСРРКШФЦАЦКЮФЩГДРПЫС\r\nВЦАБАУЦХМЛУВЩУЪШЭБЦМОАЦЩЭЯЗТЬВГДОЮЯЬЦЧДАРЯЪШТБЯЫЯСПХРЯЬЖХШЦДВЪЯТЖЦЦЦСЯУБЦХЯ\r\nЯЮРЧНМШНАЯУЗВЦИЦЩЙЮЧЧЩПМШЦТЯШЫСЙВГЫГХЫИЦЩСТЬАБРСЮЪЮЦЪНЫКЫЯНВЮЪСГНПШОЬНХ\r\nНСУХВЪБГМКСЗЦРЯГНХНШЯБЦММХЬТЦЩОХЕЦЮХНХШЯЬРЦХЯГУНМЭЬАБННСЩСХИБИУЦВШДФЦВГЫГХЫ\r\nГЯКБЛЯЙЦСЧЪЬЬМЩЬЭАДШРЯЧЪЯЭЩБЮЧВГКДЭЫМЭФНЫЬХЦОЗЯУБЦТКОЕЩЬЦРМЫСВЦАБАУЦХМЮУЭСЪ\r\nДАЦСЬДМЮПМГЦБЮУЯТЫРВЮЯЪЩСТЬЫЯУКХШГЩКМЛУЦФЦТБЦЬЩЗМРЛГЯФОЮЭБЩБДЪЬБАЦПРАЩУХН\r\nЩФЩШХЗЮПБЦУЗЮЕЦБЪЯЭЦРХКЗЦУЮЩЗОЮЯЯШМЯЭЦПУЩДТЬШЭЦЕЭЙЖЯШВРЫЩШИХШЧВСФНЯЬЭЯБЗ\r\nШГЫБЫВЭОБРМТББЧЦЧПШРМИХЪЬЦШЦФКПЕЦВЪБРЪЩТРПЦОЭЩЙЭАЬГБЫГРШСВЩЯЬЦЩЯЙШХЯГУИЛШР\r\nШСРЛЮЭЯЭЦШШЯГДМДЭЕЦВТЗЬЦВГЦКЮРМЭРБЮЯЮЯКМЮЪУЯПМШШЙЩФЗТУФФМДТНГЮИГЖОГЯЛНТУ\r\nЫСШЯБЖЩБРКБНШСЩЦХАЮЯКЪЕТЬРЩСГТЦЮЯДБШЯФЦАЛАСЮИЦРЩСХКЯФДСГЦВЮРЦЫИНАССЮРЖРДЩ\r\nЪЩЯЬЬАЯФНЙЦУЯПМШШЙЩЭБЮЯЮЯКМЮЧЭСЩРХЭЯВУДУЭЯВКНХЧЯБЛЯЭЦШСЮЗЮЫЮЯСУЮЮЭЦЦМШ\r\nЫСАЦЛШЫСЬРТЗЮЦЧМДЭЦРЫЦНЯУБСЪЗТЫЯФЦСШЭСАЦСАУТЩЪДЫКВЫРДЮПКЦЩСТОЬСКНЗШЩЭИВРХЩ\r\nЮГЗЧТСГНКМЯГУИТЗУТЮГФЯЬВЯЙЗЩШСЫКРПШЯЦХНТЬЦРККХЫЩЦЩСГТЦЮЯДБШСРТНЮЭЦБИХШНУМПБ\r\nРЩСЙРПЮШЯЦШЯЧЫЯЭГРЫЦЦУЦХХЫЫЦНДЧЫСИРЛЮЯГЩМКПЭЯХМДАФСЮРЮЬОГЦШЗРЩНЮЦАЛАЯУЦИ\r\nЦЦШЮРТЗОКЦСРПЪЯЬЦГХФЩЩКЯЪОХЦФЗЗУВЫЦИБЮЦХНРВБХЦХЦХЯГУЦЗЯЮЯЕНРБББСРБЪЮДФИФЯЮЩ\r\nИИРВЫМЖТПЮЯВЩСРЪЬЭДТНЮЭЦБИСШРЮЯФТФРЩЧНМШМУЬРХХУФЯФДВЬХЯУНУЬУУЬСЮАЯЭРЯЭДСЩЧ\r\nПЮВЦВЩНАОЩЖЦЖХЮЯУИОАЦОГЦЛФЬВГЦЗЭЯГУИРВБХЦХЦХЯЫЩЭНАССЮРЖРДЩЪХНТЬФЯЪЗЯОУВШЯТ\r\nЫЦЮРЗБХЦЭУЮЗУВГКЯЬЦТМУЗЮЕЦЮДЖРЪЦГХЪЕЬГРЪЯЪОРЕЦПЬОЯТВДФЦЮЦХЗПЦТМУЯСЬЬЦНПРЯАБЦРВ\r\nЮСЮНМЭЙЭЩЧНЯБЬРШМЛЪГЩЧНЬГЯШЗИБАУЦХМЮШДЬДСГЮЮЯСНАССЮРЖРДЩЩЪНТОБЩБДБШЯЪКЖР\r\nЦЭЯЧНЬЬКЩЩСГТЦЮЪНТСЬСКМЮУАБНЗЬБКЦЩСТЬВГЫГХЫИЦЩЙЮЧЫЯЦОХЮСГРБЭЬФЯЦААОШЗИНАСС\r\nЮРЖРДЩЩЧДАУХШНЛЫНИЦЩСТОЭЩНДРТЦАЪЪТЦХЦУЗТПЯЬНДЪЮЦАТНЩРЮДЪПХЫЮЦСРТНШЩРБСЬЬН\r\nАДЬЫЦЯЛПРЫЩИНМЭЬЭГЦКМШЯШНЛЫНИЦЩЙЮЧЯТБМЮЯГНЖНСИЦХРМШАЦЬДМЮЪАЯЪДЭДЩСУДБЭЯВ\r\nЦАЭЬЭАШДТЮСГРСМЯГДМДЭЕЦВЪБЮРЭЯБМГМЫЯШОЮЮСЗРЭЪЬЯАНПРДЩРМНЗКЮДОГЛАСЭЛГХРЯЫХНБ\r\nАДИРСБНЮДОГРАСЭКРЫУХЩМДВШЯЯЧДАОЗЩЗЗЭУВЦЪМГФХСЖШХЪДВЗБХЩЩЫЫЭШТЦПИРБЬЗЩИХШЦ\r\nЩГЦБРЮЩКНРЪЬЪВЦКШТСБХНБАЩЭЦВГЕЦЦЦПГФЩЦКАЮЮНТНРЭБЧХЦИГАУЦШЕФОЬЫЦПАУВАЦМФУЮГ\r\nЩСГТЦЮЯДБШЯЪЛЯЧУГМ";
        string key = "россия";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test13()
    {
        string ciphertext = "ЕЫСКСНВЗНАЗАЦИЫБАЫФРПЭБОСХЮЦЯЛРЛРЕЯЮРЩЪБГЫКУШЭЯЛРКМШТАЪНЭДГЭРХРЫТЙННХЫШЭЗЩВ\r\nАЯАЙИСБЬАДИЭЫЦКРЩЫШХИЗЛЮЧЦМБЪШЮЦНКЗЪБЬГЩНБЕУЙСЫСЮЩЕВЮШЬЮЫЯЪГЕЦЗХКБГЦЯУЪТУ\r\nЖЗВЩББУЙЛРЭЗЯЛОИЖЫЩЗРОЭБВЛВКЭЫГЧУЫЯБЭГПИЭЫЦЗСШЮФЬАОЩТТШЫПХЛИВЙУЧШЧЯЗЧЦВТВЙДН\r\nАЛЦИПЦЮКЦЭКМЭБИНРФРДЙНВЙЛГСМСШЮДГЛВХХАЩЪГЦЫШШИЗСРФВЙНЖВАЯИЗЩЮВЯМФИТЫЭЦДРЗ\r\nЫЮПЗТЖЫЦДЙИАУЧАПГЭШВЕРУМЭЯЗКУЫЫЯИРКЫСХАЛИФБВНРКХГЮЦЧЩЫЖИЫЗКБЯЦЛФРЫСХАЛЦВЦДЬ\r\nЩИВБЪШПЮХЗСЖРЧРЕЩГЖНБТГЕКЩГМЦМФКГСГЯДНЮДЮЙДХЛШАЛКЯШАМЙЕШЮЯЮЙЕЦШАГАТНБУЫН\r\nВТЮЯДЕВПРЮЯМЮЙЛЯСЖРШРДАЛРЩВГСИЗХЭБЭОЙИСБЬАДИЭЫПЙЖХРЫШИКЭНЭЯИРФШКЦММИПХМЪДУ\r\nХАЩАРМЭБФЙУУГКСЪМЦАБУЧЗЛЮФЦУЗХБЕУЫСШШХЯЯКЪЪЖЮГЩЪЮЩЦИКЖТДЦЮРЩВУХЫМШГВЮЙЕ\r\nЦАБФЫФЦУБВЕРЪРЫЫВВЧАШГОСЦВГЦЬННЭЫРЗБЩЭОЖКТЦФЖЫНРКШЪХЫПХЮЦЯЛЗЛШБЮЫКУШЙЦЖРСБ\r\nЕБЫПГВУЫЙЕЦАБХЫСШЮФЬАОГЯГЩЭРМПЕХЫИНЪЯЦБЖЫЭУБЙЖХЛЯЫЙПЬЫЫЫНВФШЭВАТДХЪЮЦОЕЪБ\r\nЮЙОРЗШВЕКФЪГЩВКЩРЯЯЯПИЪБУЫИХХШУНРШРТАЛКЯШАСВВЛРЧЯТПЦБЕНЬРУХЪЮГЗНШАЕАМЮШБЮИ\r\nЭСРЦЦИФЙХЮЯЕПИЧХСИПГЩВБГРХЮЯЦЮРЧХГУГЩХРТВНТЫЪЕДЛВИСДЯЖАЪЭБЩЯЗХВЫИИВЩВГДЕФЫА\r\nШЮАКХДШЫСКЦЭАЯЮРЙХЮЫЫСШШДДНУЪТЖПФЗЛЮХЫЖЗЪЪУЖВЖЦАБУЙЕЦЮГФЫПРЧЯСЛВПЫЫИГЗФ\r\nХЩХОГНЫЭСЗКЪЮЮНЕРКШИЫЙПЬЮГЭЫШРШЖЫЖВМЪШСЗКХЮЭЩМНЦВАЯДСЦБЮЦЯРКРЕЦЖЮХЮДГГД\r\nЧАБВНТИЭДГЭЗЧЮАРНЮРФБЫЫЙИВПИНРРЭЗЦЕШРПВЦЛЗХЮДЩНУЗСШЬЕРФСОЬЙРЯХАНМНЦЦАЯНВТЪУЫ\r\nЭРЩЭБУАДЩХИУГТЫБАМРЙИСБЬАДИЭЫЪЖЗОШЕБАСУШЭССКЗТЫБОУХЛИЮОМУХЫЮЙДГЕЭЩМНЦВЫУЙУ\r\nЧАБЩВДЦФДГЭРКШГДМВИСШЬЕКЪРЭЯДУЧЮДЯЬПЦБЕНЩПНЮФЬЫЖИОЕШЫРЪЪГМНКНЯГЩЙПЦТАЯЭРЛЮ\r\nФЩЙНЦУЫИАУТЮЦЯКТРЭЙЩКВРЭЗЦЕШРЩХФКТЦДШВМРШЪУЬГЦЦААЩДУТЮЦЯОПРТШБМКЪХЕСЭУИЭЗБ\r\nЫПЮШДЫЙУЪХАЬГСШГЪЩИЗШЯБЬОЩРЫАЯЬЗУХХВЕХЖЯГЦЗКЖЮЧЮЫМЦСБЬАЙХМБВНВУРДНМФЦЫПЧА\r\nЙИУУХЙЩХЮЬЮАЖИАБЭЙЖРЭЫШАЕЦЭУДТПГЕБАКРХХАГЙДЪРЭЯНРПТУЬМБХРАСЮТИЦЧЦИКНЯГДВКХХГ\r\nСИРЙХЮЦЭУТРТАЛЗФШТТЙНДИУРТЗЩВПЮЙСЦФЮЩИПЦХЖХЙДУХЕУЙТНЭЫЦОЩНЭОЭКТРЭБВГФЫБЕСИР\r\nКЫШЮГЗРБЕЩИЭЯВБЩВДНБЕЮЙРЧАЫЯИРКЛИШЫГЦЫШУЫПРПИВОЫНБЕУОЗЪФБВНВЪЮКЮЙОХЮЦЯЬРУХ\r\nЪЮАЛКЮЪЮГМИОМЩРДШХЪДЖЮЪРЕЦЫЕШХЦССКРТАДНТРЪЮЦНРЯЭОЖЬЗУЪБУЕРЪЮГСЪСШШХЯЯКЪЪЫ\r\nШЗЗХХАЩЩКЭЫБЫЫНРЧУЗГКИВУЫБЗЬЮГЭЦМУХЕЯЕЧЦАБЙЙКПТШВНПГРЯЩЖРРФБШЦМЦУЧСЭТИЧЮЩТП\r\nГЕББЮВХРИЩНМИЭТЖЙГШРЪДЩФЩПУФЛЗЛРЕМЫОРЫБЩЯПГЕФЦЖМЦТУЭГНЦШЧЮЙЕЦЯГЯНЗРЭУЬАЕТШ\r\nИЗАСНЩЫЭЗХХЮЦЬЙГЫЫЫЮЙДЪАУЮМФРАШГГПИЬЫЫЛРЛЫБТОНРЭУЩЯТЩЕБХИЭСЯГЯСЗЩБВБЙФНЪУЦ\r\nНДЭАЖВНВУШЭЦЮНИЧУАЛКТРЕСЛВТВШВЖКЧРАЩАМШШДГЫНУШАЯЭДНАБРНПЦШАХОШРАБУЫФДРЦБА\r\nЕИЖЫПЗРЛГЕБЫЙУШКЮЦЗКЮЪХАЛЩВХЩЪКЧАШЧЯЗКБШФЙРТШДЬГФНЫПЮЦЛРВШАЖРКЮЬВНТНБДМЭЯ\r\nЪЮЯЯНПЦИШЮГКЧХГЦТКЩЫШЮИЭНЧУТЙННТУЮГБЩЕБХИЭЩУЖТТВЪЮЬОИШНДУЬЙСИВЫЦДСШШАЗГСР\r\nРЮНИЭФЮЕЬГЩРХЯЫЙФЦАБЪМНЫЦЫГАЗРЭЗЦЕШРЮАЮЦЛЭРГСЕФНАЕБЫПЩЬЫВМКЦЭАЯМФДВУЫГОЦСГ\r\nСВРФЯБЬИРНЯГСЭКУМАЯАПИЧХСИКННЕЯДЙИУУХЙЩХЮЬТЙННЧАЩНТИЭДЭГУЩШХЮЫБЩЯБЮЮКЦДББЗП\r\nИПВЯРРОРТЮЫЕЫСЭДШПЮХЗСЖРЧРЕЩЪМШГВЮЙЕЦАБФЫФЦУБВЕРЪР";
        string key = "вирусы";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test14()
    {
        string ciphertext = "АЕТЛКЖИМРЗРУТМИЮВЕФХКЧШЗБЧУИЧУТЗЕЦНЗЬЭХЫСУЦДВКХРВЗЩКПНРЙШЪЩЪФТГСШОМГХРЩГХРЛХ\r\nШУУТЗЕФХШОЦЕХЧМГЬЮХЗЪУЧЫЧЗЧПШЭЦЦЛЭКВЮРЩКЭУШЯТТУЪЖСЗСЭЕХШШДРНБЧЛКВКНРПТЛЛХВК\r\nМЛЪАШТУЪЗРТЬТТЧЩБПЧЖХЙЧНРЫНМГЧЗШДЦНЬЩПТРБСШЛЩЫЗЦМАКГРХУХЮВБЯРХЮФМРСЩМЧХЖСХ\r\nСЮЦФНЦМШХЩККПРЗРЗХИБЗЩСТКОУКДХНУУОНЪРЗБЛЖЫИХПНЛХТРНЩРЧТЫДЫХЭАУЗЗТЩЩЬЮРЗБШЬИ\r\nЯТРРВЕХЦЬРШЪЩПЛТЭФКДАЛПИИФРЖАЕУУЖУТЗХШВНЧЭНТЬКЫЦЬФШНЬЖЩЕЦГЦКШНЦННРЯМЮОЛШЬЗ\r\nШЗШЧЛТШЗЩНЗКЭИЧКННСКДИХРЙДИКШГУХЩОХЪУШПИРРБКЫЧЪКЩСГФУУФУВДЬПЛФЮКУЫЬЕЪЦОПИЖ\r\nТЕШРПОФНЦТЩУТМУНЭНЫЦМВЪЫЕХУЩЬВКЪБЭУНАЗШЙЮЗШГПДУЯБЧУХПУЪЯЫННЦСТИЕРЧЗЧЪРЪЗТТЛЫ\r\nБПГФШМЖЩФВХЗЩЗЩТЪХЛРЛТЛЙШИДДУУНТЪХЛЗЭЧРШПУЦБСШЛЩЫЗЧНЯЕЦИЬХШЗЭЦХИЙСУЯЙЕШРАВ\r\nКЙЮЧЩШЭАЪДЫУАШТУЪЯЧЕННЪПЫКШЦЫИСХОДЯУЬУПУХЮВНКЩФТНРВЕАЦЬБХДТЦРКЗФЦБХХКЪТПНЙ\r\nЮЧЩШЕЗЦРЬКЦРМВЖСБДШИСЭКЯВБРНЮВУЫИННТШЛТПЮСРЪШЕЦНЭУМЗСВЪДЫБШЦЯРЪДЫУМЩХЗМНТЕ\r\nЭДЬХХЗЪШШИЯРМЮЙШЙЩЙДЮДАПНРЫДЗСЮИЩМТРХЗБНККЩТРВЮХЩМПСИПШЛЛИЪИИМВКРЕЬРЦГХД\r\nШРПГГКЮТЛЭЪКЩСХЗЩКЪЗФЮХИЩТЪЗЩСЭУОЦЩХЪЗЭЕОЦХЕЦУГНХЦЧЗЯМЮЖРПМПРЛРТУЗЧЗЦРВЕЦЩЙ\r\nУЫГРХУЫЦКПРЮЖЩШКУЧЯБНЭНХБКЗБФЛХЫМЦЛУУЫЦОЗЦБМКПЦФРЪНААФХКМШЪТЕЦЛШНЦБГЪЫРЫФИ\r\nБЮЗЫНЦБЧНЫУСНЧКЗДУУНЦНТЦАТЦРЪЪКШДЫНХКТКЩНЕХЛХТНРМРЦРЙПУУДФАХШШДРСЙЕЭНХЮХЪЩТ\r\nЛЫБПГИРТЛУТЙТНВУЫЦУКЩМШСЛУЮТИМЖШТКЪЗПТЫБЭИЬЗКЪПЦШРХВЩЫЯХРРЧФНПХЦШНУЪИЮТКДД\r\nФТЦБМТЛКЫЗЭСАКАЩМБЪЪЭДАЦФВПЯЫЕЬДШЖХНЩФЫРБЗФНЗКШДЪЗМЙЮООШЭСЧЪРЗУПМУНВЮЭРЩЬК\r\nФЗЫРУИЪЖХНУУЬЦМТНЛХТШЦНРХЯБКЦНЧКЗЖХСЦРПЗЦАЫЕПИЬЗУЮЬНККХБЖСБДЧНЧЗНОЮРЮЪШТИЛЫТ\r\nВНХРКДЪЖЩУПЗЪНУУНЩПРХЗЦННЫЬДЦГЭУЧШПЕРНЭКНЦЫПЦБЭУЧХКФНПАНЭЦЪКРОРРРЩЬКХЪШУЫМК\r\nПРЗБНЫРТКХДЪУЭЦЪЭЭПРОЩХШДЪТАЫУРЗФЦОЮМНЦХКУНАКСРЫУНПГЦПНХВЪЫЭЕЪШКЪРБРГДНПУЗОА\r\nКПЧШНЦЕХТУНФРЪНАУРЪЭФОДЮЧШНЫНРБАЕТШЙЖЩДЭЦЛЮТЛРБСШЛЩЫЗХДШЦХУИЩИДВЬЭЦФТЦБМТ\r\nЛКЫЗЭРТДЭГЧБЭОАНШИОННЕРРЛЦОПЦЛГНЭЦЦХОДЗКЦЦМЗТТЯХЛКОВЛКРЗШГУДЦОАУЬХКМЦСЮХЖСЯРЪД\r\nЫФЩУЭЩРСМУЭКПФТЗЭУПНЙФНКМНЪЦМЗМЯВБЩЙЗФЦЛЬНЫЫСВЕСЮОЬНЧУИХШКФТКМЪНЯУЭНЪБУРП\r\n";
        string key = "реликвия";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test15()
    {
        string ciphertext = "МЧЭЬЯЧХСОЦЙЧЬГБПУЯЮЗВТЫНЯДАОХНКФПЬЯХЬРЯЭРНЪХКЫЦУТХИЧЫНЩРСЮЬЮШНУЬЦТРЦУКРМЬЦ\r\nЬАШЫЩЗЦКШТЬЦОСЦШЫЩЛЭСЭЫФЬЭУЧЫУЧЖУЮЯКЭЬУЫШЦТЧХЩЫКЭРЬФЪИЖПМЖХЭЯПХШХЯЬКУЮЫ\r\nЩБЭНЪХЗАЭРЭТФФЬЫЫЦЕЫПЫЮХЧЧЯЬПНХЬЭЧМЬЦЬЩЦЫОЕБЭЪПЬЦЬФТТШДЬЧШЬХАФБПЭХЪПЬЯЧНЗБПЧ\r\nЩЮРЮЯУСАЧЯФФСННБЖЦЯНЪФЪУЦТЩЪЧРИОЫУФАТЬШЭСЬСХЪЛАЩХЕТЭЫЪЪЫЛЭСЮТЩНЬЧЯЭХТЭЬЪХ\r\nЩРЬФЫСФЦЪНТХЬЦЩЭЩТЪРОЯОФПЦУЭРЯЫККЯЦЮЧЫФБУЮЯИБЛЪЫЮРЫЭЬЪЪИУФРАЕТЭШОДЯЦФАЩХХ\r\nУЧСЬЫОБФСХЭТУКФСЫСГЮЯУПЭИБЧАЙЮЗСЕБЭАФВЬФТЪБЧЬОЧЫЪЭЯОМОЦЧБЯМЫЩБПРНЯДАОЬСЪИСЬОГ\r\nХЦЬПЩЙЪГФЮЮНФМЬЧШХХЧЯЧТАЩГСПУЯЬШФУЩЫРРЖБЬОИЧЯЧУВНЪЛЩТЭАПЛОЪКЯЦЬЭРИТЩЪЭРНХП\r\nСАУЬЫЧЭЪЫМЛБФТЬЮМЩЪЭРНЭЗОЮЬЪЮТЧДЫТЫУЭТЦФЩЦСОХИЧЧКБОТЯЩОВСЪНЪЛАНФНЩБЯУЩХЪФ\r\nЪКЪЫФФЬНЛЖРЫАНЮЯРЪФЪУХПЬЧНЬЫХАЩЦВУНЬИЦЪСЦБЭСЫЧИЩОЭЫЪЩЩЭУЫОБФААПЫЦЩПХНШЦА\r\nЛЭЫСКЪЧНЪХНЫЬЙЪТАЬФСЫЬЦЩЭЩТЪРОЭЭИЯЦУЧЫЫЧЦШЯООЫЪПНЗТЦОФЬЗХЪГРКЩСШЗРЭЩЙЕРЬААП\r\nНОФЬЗХЪУЧЗКЧЭИБЩЬПЭНЫФЫЪИФЮФЮХЫМЭЫЭТЭНУБУЩЧИЩЭЫХЪИЖЧЫНШРСФЯЯХЦРЯОФУРЦЬЦФН\r\nФВХЫХВФПБУЭТСАФЪТЦЩБСЭЫКЪЭЫБСЫЩЧДЭЫЭХФРЙШЫЙЭЪКЕЫСЮЭАЭТЙЬЭЯЯХКБПШХВЩЪЭРНВТП\r\nЩЫХЯЪЭЭЫЪНЯБЭЬФЪИЖПУЯУНЬИЦЪНТЭБЬЭНЗЬПЯЯЫУЛЩЬЬЫЛЪЭЗТЪИЩПЮЙТШЭШЕЯЫЫЬФУЪТЦАБОТ\r\nЯЩОСЮТЩНЬЧСШНМЧБКЮПЦЧРЩАФТЧЧЬЪНХЭАЦЯЯЦЪЛШЫЯШЧЩЬЯНОЬКУЬАУЭСУЭИЪЭЖЫЫЯИЩХУЭН\r\nХЛЗУЪХТЭТТНЪНСААНПИЪСЬЬЭЦАЭПЫХХЯНЬЧАЧЭБУЪГРПЪКЪЫШПЦЮАЕРБФЩЙЪЦШАЦШТФПБУЭХХАЩ\r\nЬРЫРЬААХЪТБПРЬНЪЯЧОЭВИЪЛЫЫЩЦРИУЮЯКФЮЦЕТЪТПХТЯИРЭЩЙЕРЬААПЫХЭСЙВЮУЭСЬЯЭИХПМЯЪН\r\nСЦСЫСГЭУЦЪЫТЭШФХФХЧЧПТФХПУУУЪЦАБКЬЫРАЩОЮЯЦОИУРЫФВХЕХЪГЮЯУЫОУПУОЛЖНФЖБПЮЪС\r\nЭЛЯЫЩБЯОВПТЭЬДТЧЦЬЕЬПЫТПЦОЯЙЩОАЬЧЫЩЭЩЬСФЫЫПФТЪБЧЬЬЦЧЦБЭЮНМШФЗЦШНЩЛЬОЪТЙЭТРТ\r\nЮЪЛЩОЧЫЛЭЫБУНУЧЗКОИЪЭЪКЧЫККШАХФИЫВФЪНЛЭЯЦФЫХБФБЯТЭЩЭЪАЪНВУОТЯЩОАТТШИБЛТНУН\r\nМБЬРЫФПОЕХЯЧФЯЯЬТТБЧРНАЛЭИОЯЙЩОЩБЭХЩВЫОЮАХПРУСТАФСЙЩОУНУЬЩЧЦБЭЮЫТЧЭУОТЯЩОЦ\r\nОЮЯЦЪЭЪОТЩАФЪТЦХКДТЭАПФШЦЬЭРЦСОЪЫЧЯЧТНЯДСФЯТШДФЧГЭЫОУФЯЯПНЬАШЫЦКФЖУЭХХЩФЫ\r\nТЧЦБЭЮИТЬЯПХИЬЦЫЭСНЛЪЮЭЫМЯДЬПЕЯЫЛЭБЬПИЧЭШАХЪНЩЭАЫЭГФХУЪЖРЬКУЮШРЮФЮЮЬНЩБЦП\r\nНППЫБУТЩБСОЧНОФБЯМХФСАУОЫУФФЬЯСИЪФЫЪЫСЩЭЫСЫЫЫВШТЦТПЩБОАТСПЩЙЪЦАЯЬДЪГШЮЩН\r\nЪЙФЯУЩТХЬЭЯЯХЦЮЧЯИПИФБШНЧХФЩЬЯЫШКФФТЪБЧЬЙЮЯИЯЗУЯЭРУЕОЯХЧОБЦШТЪЦПЫХЩИНБЯМЮ\r\nНЩАЬЩЮХФЦЫНЧЦЫЕОЩХЯБЭПИФИСФЯЯХШФРУЪЧИПЬОЧННАЧЫХЪЧВРУЭТФФЬЫЫЮЪЛЦОЧЫФЮПЫХЛ\r\nТПЩТПТЧЭУЮАРРАБОЭНЖБАНФНЙФЯУЩТХФБКЫСХЭСЮТЩНЬЬЬДЯЦРКРЩТЩБФЭТЭНХЧАЙЫЧКБЮЫУМФ\r\nЬЦМЭНРФЫЧНМЯВСХТЩЪЭРНЧИАПМЯЮЗРЭЩТТЧЭЦЦЯХКЬЭЧЮЯЦЯЭЫИУРЦЬЦФЪИЖЧАТШДЬКЧЮЫЮЧПЩ\r\nЙЪГШЮУЭТКЭЯЬЯОУПТЬСНШОЩЬЯЫШЭЫБПМЧЭЬЦХЬЦОСЦШЮЗАЪЬЦЪНЦПЪАУХЧДФТЪБЧЬЭЫЭЦУЧЩЯНТ\r\nХФЭЫЧЦЪФЫХТЧЯЧТХЭЯЧСЙВЬЦБЯУОХЪФЪУЦЮЪЭЪЯЯИФЧЩЬЕТУЛЩОЩХРЫФМЖХЭСЭХЩЫОЬЭЯЯЙЫУЭ\r\nРШТЪСЭЮХЯДАСЬХФИЮЯЬЮИРЮЮОЦЫТВМАЫУНЬИЦЪИТПХТИЦИЩАУЮЮЫПЯЦЧНОУПНСТЪПЪКРНШУФ\r\nЮЫОИЩЭАЫЭГДЮЮХЪИУЪУУХЪЭУЫЫЩЫУЧХНЦХФЯБЮШЦСЭАЫЧЫФТОЩОЦЭРЬФЪИЖПУЯЩНЖББДЯЦР\r\nКЫНЧИЩЭЧЯЫЦЮЯУСТУФЬЫЫЦЫЪЧДТОГЪЭПЫШДЗФЪЫСХКДПАЯРЩЭРНЛЙЧАОЧХЙЧШЦЪКЪЭХУЪЖРЬПШ\r\nЫЯЦЯПНЯЭИБЧАЮАБФААПТХЬВМДНЩБЛЯПЫНТЭПЛСОФБОЪНЫДЭТФНХЭТАМЩР";
        string key = "ниппон";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test16()
    {
        string ciphertext = "ШНЯАТФРНЗКШТЪИБЭВДЭЫЭПСЬВАТПММТЗРБОЫЭИИФСЦТАУЯОХБИЩУВДТЕББЛГТЫЖРИЛЭЕВЫЕСРИЯ\r\nТРТЬНЯТОФЮСГПТЙЫОЖЯАСШТЦЪЬСХСДИИНСОЬЛШЧОТРХЕПГЮВВМОГВЖЭДГВВШУАСШЕСМРТЯОББАЖ\r\nЫАХЧКДТКСЦАДНРЯЮОФВНСДОИШТВОСТТСЦЫНЙФАЬФКТЮТГЭГТБАЭЭГТЪЛСУБМЙАЮПКТВОБЭМЖЯРЯЗЛ\r\nТЬГЯУУЕЛЛЩЮОЩЮРЯЬЕСЛЖЦЯТЖЛТЦЯАОВАУРЕХЫАЮФОСШЧГЭТТФОУФРМВЕЬЛНТИЕАЖУЦБОГЯУИЭИ\r\nЫВАБАОАЭРЦРОЮЮРТТЕБОЕЦШХХЭКЧЬЕЮБЫМЮСЭПТФШВСФТЕРГСХМЧЦЧЩЬЫХГМЫПКТВОБКХИРЖЦЬЕ\r\nУАОВСЕЫШВСЪАХМЧЦЯЕЛАЕЮБГЙЭНСЮРДТИЬЧСАТССЫОПХТЩЦБТЪОУЭГТТЫЖЭДДВЕБЫИСРЛСЫОХЪОУ\r\nАКМЩВЯУИЦХЛНЩОЦЮРЯТОТБТСЬОЖШЛЖЫУФЛЙВЭТФГДЮЧКИЮРЯХНТЩМЩЪИЪШИВЯАЛГЕЭВСОРЗСЪЧ\r\nЦЮХЯЖЕЦТСЦВЛДФИГЛБЯБТБЭНТСЕШЬАФГШЦЬИГЧАЫЭНДТНСЗЕНБТБПНЙБЛЩЗКТЬМЮЭГТЭЕШПКТЭНЯТО\r\nЖЮРИЧТРШЛЩЕИТЭЕБЬАРХКСОЧЦЮЕВЪИЕЛПБПВМВЕЬЛСЦТОТКЛТСОЬФЕФРЗДЫНЯЬОЮЭБЯБДЦЪАПЮВШО\r\nТОШЛЦТАПМНМЫИМГНЩСЕФБАЬЛНЯЬИГПКХЪОЬЛКТЮНЖЭЧЙВДСШСОЮЛНЩОУЮДВЩАЛЛВСФТИГШСМТ\r\nТБАЭКЕУЮСЬФДСШЕАЯИРХРМЧЗТЯЫГПКТАРЦАПТЭДЦЬТДЭОЫЭРФГПЗЧЯЖАОВАИМЯРЯЕВЙВАЦБПТТСПУУ\r\nМЮЧЦЬЬЫРСГЭОСРВЯАПФШНЩЫАЙВСРЬЕОРКВЪЕИБТУЧЕСХПБПВМЫЬЮЭЙУЮЛЩБИОШИГОЖЙЫОЪМКТЭ\r\nОЭЧЧЙБКЯШСМВУСЕИМТСГЯАСХАЫПКЗЫАУЬАГЯРЩЖИСРТСЩОНЯОЬЧТМЪИЯЬАСРМЮЭГТБИЬЛНЙХДСХЕ\r\nЖЮЗБЭДМТШЦТОХПВВБРДЭЕЮПЦМЮНСЪИЛЬАЫЭРФГПЗЧЯТВРССЛГХТУЦАМЬОЯБНТИЕЮЧЯПОДЦШСРШЛ\r\nЩЕИЙЩЧЩЬОЖЭИЫПММШПЯЪИЦШЧЦАКМЬИХФЯЦХЛРЫИМБИГВАЪШЯАЭХТЦЕВЩАКФЫЭТОИЮМУАЕЕЮ\r\nЛЦФУЩГДЙПЕЦБЯАЭСОЮЛНЩУОЮРБВПЪШЯЩЫЕЙВСЫЯЫЦЛЙЖПРДЪТЦЯЕЙВОИЬЫЙААШЫЕФЛОАЯЕИХЛ\r\nЩБЬТЗЕЮЛТФГДЮЭНТЮСЮЭВСЛЕГФНИХНЗЧИИЮСГПТТЗНЯЦАРХТЮКВУЮСЬФДСХМЩЬДЙЪСЦСОХЯРЩЧМ\r\nЫШВЯАТМЪКЯЯРЧЯЦЩЧСТБТССЛЙЭНЯЫМЙЦДДЬАФЮДЮКМТАГСЬОРЯОТЭРАСЕВЩОФАУАЕИЙЩРЯАСМПУ\r\nАПЛДФОДЯОЖЭЯЮЧГЙААВЛЕФААЬФОСХИСЪБДЭИЩЬЕИРВЮЧЙТЯРЯАПФЮВЦУЕСЭЫЪЯОХБИЪАКМЬФЯЬДТ\r\nЬИЮУЕРЯОЫПЗДЫЧГЭСЗЮДСААРЮЕТЭЛАИОЦЩОПШЧЦАТЖЮВШОТТЪБМЪОИРНЯЫОПЮДМЫИПОДНЫИМ\r\nШХБЭДМВЕЬОММБЦЦЪЬВШЗТФЖДВЬУЭИСБКЯШПТТИЮЬОХВИШПТЙЬСЬФДЧОТУЦЯЦЪИШПППРЧЦЬНЯХДЬО\r\nЗДЗИВЪЕСШЯУВНМТЕБАИЦХТМЧХФРЗЭФРЯВОЧФНЙБКЯЪЬОЮМЦЬЬЬХЧГЭКДБАЦБСГТОЯЯУКХНЮКХХШЛГЭ\r\nЗИХСНСЗГВКЩЭСТСЕЮЬОУЮРСХАВВСУЭИРШРСЦМЙААЭЧПФШЗМСНМЪИШЬОЖЮСЩРИФБКСЮОМЬЕЮЧАС\r\nФРЦШВХЯОЭЧНДХТЫПКТДИЗФРЙУОИПСЦШПЯБРЙСОУПЛЧБОЬУАЦБОТЯАЦМНСЪИЫЭЫЦУЕСМГЩЖТТСЫЫ\r\nВПМВЬВФБЙРВГЭМТСИЬЛИЛРСГПВМЫИЖЮРТФАГЛВЯФАЮЬЫЙШМЫЭМУЫЕЫБЫЖЮЕЮЬОЗЮОТЫУСФИБЭ\r\nВДЭИРЬЕИРВЮЭММЭИВБРТСОБЭНЯАОВАИМФАЧФБЯЫВМЬУКФЕЮУАЦМОВЭБЯЩПБЧКДЧЗСЮРЙЙАПИИНЮ\r\nФЩЕЕФРМЯБПФРВЬОТАБВЯЧХХЮЛХПТСРГБПЖИРНВЩИЙЮБЛФКЦЛДЬОВЯЯОЬЬЕСШЯИФРСЮВМДРДСОГЧИ\r\nХЯОЬЛЗТТАГЛИЩЭАВБРТШТЦЪЬХВВЦЦАЗЮРЯУНЯЕДСЖОИЭАЫЭСДЬЫЦЩРЧЯНМФВЛПТЫЧВЯЯЛСЖИЖРЮГ\r\nЮРЙФПБЧНМЬАГФЛМЪАЫАОТСЩСФТМЭДЦЫИЩААШЫЕФЛПБФВЯИАПБФЙФЕБПЛАЭЫЪРЮИЦЕГРОПХЕИФ\r\nМЖФВСЯАЛРНЦЧСОЫЮИФНТЗТЯМТДЖИЕЯАСХСЫЭЛАЪОАЯЕЧТЕЬЧЧЙЭАЮЭБТЫЬЙЧНХВВЯРИЛЭЕВЫЕСЮВ\r\nАЭДЦТЕБХДДХТДДУИИЕЮЧЕУЮЛЯХЕСШЯЖПРДЪТЦЯНТЩЧЦЯТТЩКЯЯРЧЯЦЩЧСЦРЛЯБОЫВОГФПЙАЬИЧНТ\r\nТНЩЩИЕХРДБНДЫИИЬЫЙФЕЮЛГМЭОЮФТФРКГВЮЦФВДАМЯБЛЦЬНЯХИЮАТФГКЗЧИЦРКЫПКТСЕКПЛМУОУ\r\nЭРМВРДЩОЖЮДЩБЕПМОХЬОНШЗВБРТШТЦЪЬСЛХЕЧРРБОФЪАХЭОСЩАИХМЩЖЕХЪИЭЧСХЫЕХЭВДЭИРЫЭО\r\nЮНЯЫИЫХСЫЧЭЦЮНСЧБТЫЕЦЯАЛАУЙЧТЙЫЬЮКЙЖШДЫЭРФГПЗЧИ\r\n";
        string key = "распад";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test17()
    {
        string ciphertext = "ЛСБЧУСЦБГНШСЪАОРНАПЭУЧЩТГЛМЩЬЮЪЫРАЬЩЬРЦРООЦЩУТЯДПСЗФАННСФЯТМЩТХСЛНЮОТТХЫ\r\nЖРГЭАЪЦДЕРХШНСУЮСДШЩЬЧРФОЮФСЧЪЦЗПНЮПЦТЧЯУЫЯЪГЫОДРЕШЭЭИЪЪЕАОЮЯЯШЯФТШРЬЧЪНУИ\r\nРЩШТШМИРБСШЮЦСИРРЫУПЪЗТИБМАТУЫЗВРПЬСИМГЗРРРЬНПЕЫХЫЬЬГСГВИФЧЮЗЗКМХЩЦЯДРЛТГМДХ\r\nЖБЮПГЭАХКЙРИУЯЬЪИМГПХЬРЫФЛИСВСЮАТНЕОФЭАПЦЙГКФЪЯЯИБЛТМЯТЫКНОЬБЮРХНЕИНЙФЫТМКВД\r\nГШОЛБЗШМГТЕХХГОЯЬЯФДРМИСВИЯПЦЮННШПОЫХМГПХЬРЫФЛИСВСЮАТНЕОФЭАПЦЙГКФЪЯЯИБЛТМЯТ\r\nЫКНОЬБЮРХНЛЦЖЗФЫТМКВДГШОЛБЗШЖХЩЗХХМГОБЩЬПНСИРРЫЦХЧЯУВЕЪТТЩБСЕЩГОЮЪМСЙЯЬОЧЪЗ\r\nНИТЩКЛСНУКХЦУЭХДУСФСЩНУБЮВЮРЕЯЦЛЦЖБЦОМЩДНСГМЩЙХНФТМПЬЭИЖЗОБЧЬУХДИЧХШЫНЩОУ\r\nИГГЦШРРЪИВМАЙОТУНРЧЫЙЖРЦИЪЦЬЯЦПСМГЪЫСИКЛНВСЮПДЭСБКЛЯЪЗДХПЮГУЩЫОССЫСРИЭНЗАЯС\r\nЮПЦИННШПЦЩХНЖИХТУЪБЗРЫУЪРЫШЗОИЬЩУЫХЯПНХЩЮНКЗХСПЩЬЧИЙКАБЮОПРСЯМГТЕХХТТРЮГЦ\r\nЯИСЯЕХЩУФИГИВХПЬДЫБФТТМЫНЧПГГЬМАХЯДФКЮШБЭЦБРЕНЮЦЧХЗЖИТЫОЭНБНАЪЪЧЯЦЛИРХЭЬФМЯБ\r\nТТЫУДИСОЕЭФУЮЦБПЕБЮЫЫЛНЛЗГГУЪРЮТРХРЪТЪЯГНХЦЮХЪЗНИТМТЭНРПУЦГЦЪЕССХШЮЮИСРТОБЪП\r\nПХДЗРХЩЦМЧДУВЮХШЪРВЛЖГЬЫНУЪЛРГЦЬПЦГФТТМЭЫЩДНСГФХЫЙПГЖРКАЩЫЕФКГКЯТТРЦАЫИЫЫЩ\r\nСЯОЗСЫЙЫОУОЙСЫЪЦЛЦЖЗФЫИЕССЖШОЬЯХЪИМГТЕХХЪАТЮБЬСЗЦГЯНЬУЧЮЗВИЕЭУЧЩТГЛМЩЬЮЪЫПО\r\nЦЩЬПТКБЧШЮКХКЪНЛОГЦЯДМЛЧВЪЫТФНЙЕВНЙЯДГГЛМДУЫЪЗФТШЩЙЩХДНАЧМЩЫЩЫЕАЦЩЙЩЩБВЗ\r\nРЮКЯНФРИЪЯЯЬЩЗШОЫЪСХНИЛПЮЫЙЯИСЯСПЫЬЪЗСЯЧВЪФТХЯФАЬЪЪСНКИПАЪЦЮЭНЗИВОЪЫПВЦИЮЬС\r\nНХЗКМХШБУЯЗРЫУЪРЫШЗХДЮЦАЫШЙИРЭСЮЭИРФКРУЙПИЮТОЗСЪАЦМУЕИФЩЪИОЛСРЮКЬШНЗОЫТУЪР\r\nДННШПЦЫХЯРАЯСЮПЦЛПЕБЮУАФДРЯХЭАЙЬПГЗРЧМСРЛИНПКАЮЗНХНЮДУЪРЮПЕЭЛМЯЩЮТОЗСЪАЩДН\r\nСФЪЩУНМССВМРНЪЫФЯЭСЦФФДРНЛШЬЪРПГСВЯАЧИЙОИЗЩЬЮЪЗУАБЮБЯТЯНПРЬЙЪЦЗШСХЦЯАИКЯНЛСЯ\r\nГНМГРШФРЧИЙСМВЪЯЩГРОЕЮЭАНЖСФЯБЮОЯРЦРЫЬФХНЗБОЯХЮЬЪЫАЛВРСАШРЯРАЫФХЮНЙФУРЧКЪЦИ\r\nЙИЧЩЦЭЦЛГНВФШАРБСЗСЯФСНМЛЕЬЗФХКДПВЪЯЩЙЪТУЕЪЪАЫШТБНХЩОФЦБИШМЭУЧЩТГЛМЩЬЭИРНРХ\r\nЫЬЖНМРОЩЮРЫШЦИСЪЪЧХЦСНРЮОУЪХНМИПРБЩИЭЪТЮЪЭНЩМССВФЦФУЗЫНХЯСШЫАЛТМЭНПИМГЛ\r\nШУЯТТРЦАЫИЫЫСЕЛЗЭФБЪИРРЕВЫЬЮУДФЕЪЭОПЙНОЬИЪЪРЦПСДХЫЮХКРИМЗЮЬОГКСВБСЮХИКИЖХЩЗ\r\nХХРЛМГЧЦЭЫЭЬИЕЪЮРИЖПНХЭАНУНПЕЭИЖТЦГРОФСЩЫХНФИВИВАЪАСЛЪЯЯЪИГТИБИМЬЦПРОЧОУФМЯЛ\r\nХЮРЦЯДМГГШДЬЩХЯЕЕЗСЮХХЙЛВФЬБРЦДЕОЯЧЬЯРСЯЭВЪРСНИФТТФУПЩНДСВОУЪХНМЖШУЫХКЪФЧШ\r\nЮОТЪДЧАЭЮОФРЗЖЛРОЫИФЙСМЯЪЫТХССМБЫЬЮЦАРОБЮЦЭИРФЛРНЦЯДРВИФМАЙКЪШОФЭРЫРЦЦВБЮР\r\nНФМСУЬЩЬРРФПУЦГЦЪРЕИНЙФЫЮХЗПИБОНФИМСЧГОЯЯКНЕИЭЗЭЫЯДПУПЮЬШДЙСВЗСЮНШЯДОВМЩЮЧ\r\nЯУОЩЭЬЮЪНВЩХХРОШЯНЕЮЦЬШЦКИТШБЯТТРФТРЧЮАЪЗРНЛШЦЬШДЗСЪМХАНЛЮМПРОШНЛЦПАЪЯЯЦИ\r\nФОТСАЧЫОЛТМЦОЧЫЭРИСЯТЙЕПСТШЦБХЧНЪИВМАЙЧЯУТЭСЮЕНБТОБЮУШРРРАЗМЩНЦМТРЮГУШНДФАЬ\r\nЭЦШДМСВЮУПАМЗОСПЩЬЫММСВАСЪТХМСИБЫЙЯГБГЛТФЫАРЖКАВЪСЫЯССРРЭЯЧИЖКАТСЩТЛНВДГШО\r\nЛЕССХЮЬЬЕРИТРШШУЭЪНЖОЪМШЪИЧЛФРЩАНПЗЛПЮЬЬЦКРХУЯММЯКЙСНДЧЦЧЪРРАИФЪХЮДРНЮЭАМФ\r\nЗЛНРДЦЩКНФПШЮОЪРДПСФЬБРЦИФТЮЬЬЪГЛРОУФУРЦБСРПЮЪЪНЦХОШБВНХСГЗШФЯПЗЖГНЛЩУЮЪДПМ\r\nГТЕХХНМСЪЪАЫШЪПОЭФЯЫЩССЯВОЬЯХНЫЕЭФНВРНРИШЭЭИЪЪЕАОЮЯХУЫРОХГБПЩСЕОТФЫИЧНАТЮШ\r\nБЬЦБСДГАОЪЪЯКИШНЙПИЭХВАСТЪГЛЛЕБЮКЩХНЙЕБЮРЫЧЯУСЯЪЯЫЙМЮХТШУЮЪДРАБЧОУМЯХЬБЛЭЫШ\r\nМСИЫФЛЭЦСЛЧХЭШЫСКЛТХЬОЯЫПСЙЭЪУЮУЗЕЫГЭОУРБГЕВСЯЙПЯНОЬЫКЛЪДУЧВЪПИЧНЖРГУЦЯДРВВЬФ\r\nЮПРПХУРЧКЪГФЧАЭЮОФРИТРПГОЮДНХМЛЭЩХЦССМЗЮЬЭНЯОЬЭЗУЫЪМСШХЩЦМХДЦДЮОЩТЪБСРПКАП\r\nИРЕСХЦЯАИКЯНЮШЭШИМИЭВЪЫТПГСРЮОЬ\r\n";
        string key = "гармония";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test18()
    {
        string ciphertext = "ДОЕЮНБЗМОИВЭДРЩФМЯИДУЮЧЛНЯПГЫЧРГЕНЬСИТЬЪЮУФЕББТЖЕЬХДЩФНКФЫАБТНЦДЭДСЭДУАЗИ\r\nИЪЙЕЖЩЗЬЧОУУЯПСЦБТЩАСДБМШЧЬСЫАЕЛЩЮНЩДБФЦЗЬДЙБТМЬНСКЗНВЖОВАЭФЯЮВЯЭЫГКЯЙВФЧЦЯ\r\nБОЪДКЬЮЕСГОЪФБЬДВЬЬМСЙЬЫАЯЙСЕЖЩЦЬЧНФТЩЗЛНЫЕВЩБМУУЧЛЯФЮЪЯЫЕЩГНРЦЫОУТЙНРЩЕЬАН\r\nБЮЧБЬРАКЮЯЕШТЛДГДАХИЬЧНХТМГЫЬСГИЧЪОКЬЬЙФЧМССДИЩФЛКБЯОХГЛУФЕДЯДУКГЕНЦЮЭШХЬТЯБП\r\nЖЬЯКЯФЬТУШЛЩШЬОЙЬМЮАИКБЬПЩКБЧВЧНХЪОЕЪГСЮТПЬЮТЙГВПЙАЕДЮТГЗСДИЦЮАКЬЧЕГЭДЖБЧКЬР\r\nАКЪИЧСГОРЩЩЫЭЪДРЩИЧСГОРЩЩЫЦЭЪЙЩЩСГЕЛЕПЙВТВЬПАЕДГФБХЧЫАЦДМЕВЖРЯГОХСДЕЮЯККЭДЕ\r\nЮЪБУГЕМИДКЦСГОЦГУЕВЙЛЩФККУЗЕЭСЮЖБЧКЦПОУЭЬДЯФЧОАЬРЩААУТТЧЮАГЕЫЧНИЪЮЕПРИЪГЫЦБЕ\r\nЖХЧЙНЦГДЦДБОЩИСЬЧАУУЧТЦЭДЧСБЖЦФЧЬЩИЛЩЭДВГЧПМЬКИХЧПБТЖЧЩОЕВЬДПСЭДМЫЭХСБТЦВЫКГ\r\nИВЯЧЮУЬПЕТЯККЯОАБАЮЕЮЯЕБАИЕЮЙИЫЪЙЕЪЫУГЕОКЙЬНЩЧЮЧЯГЧГАНУФВАВЯКНВИЛЦЦКЗСДИПФНХ\r\nЦЫНЦЮЖЕЧЫЫЪГУЕВЙЛЩФЧОТЗАЫБКРДОАЦДННЬУНМЫГЕБЦДЯДИКХЕВЯХКСЦИЯЗТЮВГЕМВЭПЬСЬБЬТВК\r\nЮДЫЪББХЩЕДЯДЙУЙЬНЩЫАРЩЙСРАЖУЬЕГЯЦЬЧЯВЬЫАОКЫЙОЯУМКИЬНЮТМЕШЩОХАХШКЧЮГГЙНЧЬН\r\nЩЧПХЯЩНРГУЕВЙЬРЕВКУЖЕБФЧОФЕДТВЬПСЖОЩГОКИЬНЩЪЯУХЧСДБМШЧЬСЫАЕЛЩЮНЩЦЬЛЦЖАБТИПЯ\r\nЙОБНИЦДЭДЦЯКФБЕЖЩДШЗЭЬСГЧАУЬУШЦГЗКХКЕГАВНХЧТНВБМЫЕГЯПИУЗЯОЮТЗБЮЕГЯГЛЕХЧДЬЪОКЬУ\r\nНЯГОБПЫВСХКЙСДЕТАЗБЙЕЕДЭПЬЙЬНЩЧВЙЦЙИЖДКРНБОЭЧВЙДЙРЦДШНЭЯПРДЧСФЕДЯЮЭХСБАААНРЦОЕ\r\nФАКФРЙЬЮТУТЦЙСРАСРСЭДЦЯДКУГЕВДКЧЯЪОИДКЖМЖРЩЯБЦГЯМДЦМУВЙЬВЧАБЭЕЙФААЖБЧКСДМЕХЯЦ\r\nЩАЙТЯЯЗУЧНЧЮТЙЫТЖЦСГЫЪЬМНГЯЧЦГЖНЪЖЕБЪКЙЫЕГХТПЖЯВЬЙЪЙЦГЩАВЕЛХДЪОУАНУТЬНЮАННЬ\r\nУНЯБМУРЩЛРЧОЦРЗАШАУЕБЕВСЯДКОЙОГПОЕАЦВЬСБЧВЦТЯЭШПЯДАИТЗУЭИТСУДРНДОФАЛЕХЬНЩСПХЯ\r\nЩНРЕАУУВЕГФКХЦДНЯГОНАЕСЬЧАКВЦТЩЭБЧТЗАИЯЧЪЯЙНЯКБТЩАУБАЮКЮУСИТНЧНЦНЦЮЙУФЕНЩШБТ\r\nЦЭЕЬЪАУТЗАЫТКЙЮЧКЯФТКЬЕМДЙБТМЬУГФБХЧЫАПДУЧЯШРСЬАКЬЧЕГЭЪЙЦАСИТНЧЬЯВЦЧНШАЗУФЪИУФ\r\nКТБТНЦИЯТМФЬЧНОТЯЪСШБЕВЦЯШЦИЧСГОЫТСЖРЯДЫЛЦДИЩГКХЯБАЬЧОЖДЫЕГФЧЭЦОЕЭЕКЙЩДОЫАЯУ\r\nИЬЛЯФБПСЯТЯЭШПЯБШЦГОНХЬСРДДИЯЫАЭГОКАЬНЩАХШКЬНЩСНЬСИТНСПУХЯНЯЬДЪЩКСЯГОУРРИЖФЭ\r\nХСБЕДВЬЗЮЯВСРОЦРЖРЩФКЙЩЙМЮЧЙНЦЯСВЭБЙЯЩАГЧЗКЪИАЮЦДЧСАМВФТКЬЕМЭАВКГЖОЫТГЕГУСРЙ\r\nОУТЕЛЦЧВНШДЕБТАУВЙНМЧЗГХЯПБАНЧЯЯМЦРОЖЯВЬЙЧФЕЮИОУЯЬОГЯСЦУБЦАКТЮЪЖЕЧЯЗЮЪКЙЮЧКЯ\r\nААТЯЪООДКИЯДЕХАНЧСЙОИЯКЙЬЦОТМЫЦЮЬНЩСАЕЮДОФАРКЮЕМЦЯЬЗТЗАЫЧБЦГУНЦЬКЧЯЗАРФЙШГЗЕ\r\nЮЯЫДЗЬНЮАНЧНБОГАМЕРИОШЦЬКГФТЯДЛУЬЕЖЩДБРНДЫЪПРЩЦБТФАЮУБЯТХАЖЧЯЗАЬАДЦЙЙУЗЧМЦЯЧ\r\nВГАМТСКЧЮАЯУЩИСЬЧАУУЧНЩСЮСЦИТЦГЙНЭДАХЪНЦЬЬДЯФЬТЩЬМБТЭУГЧЛАВКЩЦИСЯВТГБЯХВЬКИЯК\r\nНЩФБХВЯТЦДЬЖБКНЯЖМКЪКЧЦЯЧКАЗЕХБКРСЪАПДУЧЯЖОВЭБФЦЗВЯХКИЯЫАУГУЕВЙЛЩФКСТЗАЫЧЙЕИЯ\r\nНСЧОЦРИПСЦКЮДРЕЮЪЕФЯЙОЭЕУЧЯВЮХЪЛХЩДИЭТЪЧУИЕБТАУВЙИТВЬЬЮЕГЯГКГШЧКСЬАУЬЭНЯЧ\r\n";
        string key = "счастье";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }

    [TestMethod]
    public void Cryptanalyze_Test19()
    {
        string ciphertext = "ЕКТЖЩВКСУАСЬМСАРЩОНЙТВБЩЖАЕЫЬРРСУРЯЫРСЕОТКСУАСЬЩОХКЩЙАДКЩЗООУОДЯФЙХЦИЕЬАЭ\r\nСУУОХПЬТНЦВЫВЕЖЯЦВЦСЬЕОФКСЩУСУУАЖХЫПЬСОГМОИЙЖАЦФЯАЭФИЮБАЭЭТДСТЬЛЯТСЬРРБЪММЮЗ\r\nЯЛОЛАЬКЕУЬЫЕБЗЭБГМДЯИЦГОВТХРЯУОПЕГФЙУЬПЬЫРАПЩАКЯПОШЦСАЦЪКРЮМВММОУКОНЩООПЫМУ\r\nЧЗБНЦФАПФВЙТЙЛНДЯЖСИАЫВХБЩХЯЮЗЯПШФУЙКЪЬЪУОИФЦВУХСЭЗЮУЫЯМЯПФЖЩЙЗЮРЧСБООЪТБЛЬ\r\nЖОХКЩЛБЕОЪУЬСЬОСЦОКМУЦНСЧЬЕНХЬДДЩБЯЦИХРЩЭЖЙЛПГЬДЬРИБРРПСТЛЩЖУСОУЕБЗФЙЩИЕУБАЭО\r\nРЕБКШБЫХКЩЧЭСУЛИХЗЫУЬЖДЧРЮЕФЕУЙУЙОТЙСРФЙКЦСЕВМЬМКООАРЭЬАТКЗТБФЯЦРСПЦУКЙГЯРАПА\r\nФАУНУОЫТЙФВРБЫХКЯЛЯЙСДРМЖЬГАТРЧЗЫЙНЖЗСНЦГУХВЩПУКЭЙРЦИЦМБИАУМББЪЙРЩМООЯООФРЛН\r\nПДРФРЦСОХПСЖПМОЗОХЗАЖЩГСЯДУУЯООФРЯПМЛААЗЮЖФМЛХВФЖЯРЕЖРАГЬФНДАЭПЭЯТЫХОНУФИЫВ\r\nЫТШМХВСУЧЯПУЧГЬРЮЯСЫВАЭУЗОУЗЗЖЯЦВЯОТМНЖЫАВТЖЫМЯУРЩПЯЖВСЪЦОСЦОЮЗЯШЦЦАЬКЕУЬО\r\nАВФЮПРРЕВФУТПТРЯЖЬКЭТТЦТНЖАЩАБКХНБДЗСФУНЦОУТХЭЖЮЖЫЪВЫЖШИОГХФЖЯЕОБРТПЧИЛЩПЫ\r\nПЧОАЫХШБЯЦРЯДАПЮТЙВРРТУРСУЗФЙЧЙГЯФУМЬЖЫВФОГЩЙНЯЖЩАЭФОКВЫЙНОНЦОБЕРМЖЦФЯАЫЙС\r\nЫРЫШОЙМСБЬШУФЕХЮРПСПАУЗЭСЬЪЕВУЦЙЪМНЩУАСЦСОВФЮБЫСЫЖЖУМВЙЛЩСУРУФЕВТЬЛШТТЯТЬД\r\nЬИРДЙКАЫДЗМДОЯАШЕЬКЭЙАТЕЭХРТУЗОВРЮПШТДЩПСПТДВБВСЙХДСАКЫПЧЦАЬКПБЫТМБРШИОХТМНЫ\r\nБТЗРЯГЬНЦСЕВРПЙЮДЕГУНЕРМГСФКТНЖПЦТУЕЯЦОРЫЦКРХЛЦЖХБЫММАТУЕЯЙДСФУМКСАЗКЬООПЬЮРЧБ\r\nЯХАЭГЩЖЦОУТЭЮЙШДРХРОМОФКЯПАЖЮУЕЬКРПФИЕГУРПУНОИЗЮЖТМНЯСЮПГТДРФЪЙЫЧТМВЮПШМН\r\nЦЖБНОЙТХДЦДОЦЬВБЫБШТНЦШАЖЮУЕЮКУБЩДРЫРЫБЦХСРМОЖАМОЮЪУРЕЙТЮВБЦЬФОЫХВЖЩМПЩФ\r\nЬШУЗОГЭФЕУЬЬГЭФЖРМДЩЪКШАТОЮОУСАЖРЯМАПФЙШЦСЬУЬРОГДУШОЙТРДЦЗБСОРПУНЬЗУАТЦЕБРАГ\r\nЮШБШХКСЙОУКЙМДРПЮАТМЫВЯУЮТВВФЮЖЕДЕГУРПУЖОВЮЪЙТЙСРФЦМУЦИЦРЫСЬИИЬУНУЮМНСЖД\r\nБАТГЯВРДБХТСЖРБТЪАГЮЖЖЯЦОФРСПТДЕВНЦЙЫЙНСУЪЖЮЦНЯОЬЕЮЙТЯПОВЬПЬЮКЕОЬНКЯЛШЖРРАЪВ\r\nЪЙСИЕЯУУМЦХОГПЦУЙХЯИВЫУЦОАВФЮПРХКЩЧЛНЦЗРСПАПРЖЕВФКППТЛЦЙЫЙВМДЦННВЙПАУУАСУЫЕ\r\nЮВЩЙШТВСПЦЖЪТДЮВШПЫЙРСПЬМЦЙЩЦЧЬСЬСИГЮШБЯЦРЯБЦНУВВУКТФЫЙТЯНКЛЬШИШКЕЖЯООЦДЙ\r\nЗЦЖАЮКУЛБЕИЮУШПСТВЯИТАЫТИВХТЭПЧЕФРТЖЩДИЮВЯМУИСГДОХЦИЕЬЮХБДМКЬКЩТНСАУВЖЙЫЗТ\r\nЯПУГОЬИЮЕАПЫСАЕКТЖЩЙЭГРЭСЬЦИУРЯУЬГНЩЗТБРМДСКСПЩМАЕВЭСЦСИЭВЩПЦСОФЖОХЬФМДФУБА\r\nФАСГЯФЮИАЯГУТАТРЯПЙАРСОАЗЮЖЬЪЕЮКРБЩМРЯНКМЦЫНЯУАЙРМСГРЮЙЦЩОГБРТЩЧЧСЗЯЛОХТБРЬО\r\nОМВАТННКЖЕЬКШБШТГХВРЙМСЕФРТБВМДЦНКООРГЮРРЖЫМЕАРАЖЮГЛВРХООСИЦСЮПЦЛНЯУНЛОООТЭ\r\nЕОЬРНЯЕЬШОХОУХМСУЫЬЮВЭПАТМСМУТЮДЗДИУИООАБМОМЦТКЯПДЖЛУОЖКШБЯЦРЯДСПТЧОАБАЭАДК\r\nЩСЬТЩЙМЮРСПЕДСЯДЬКЮЙЧЩМОТАФОВСЬУШСУЬУНЙБУАЬТОИТФОТКРЛЬПЕЮПБЯЕДШЦЩШФЩЙВЯЛЫ\r\nПСМИВНЬНОЖПБВРФМФУЫХЦТЫТВСПОРЬЦОЭВШЖХДВЯСЦМЦТЕФРШПЫЪЕУРПЪУРКСМАПЩАКЯЦЦЕУПЬУ\r\nЗТЖАХЕТБЫБЭЧБЬКШЖЫЙАХЗШГОЦНЯЗЪФЭФОБРЕБАХКЯТБЯГДНД";
        string key = "свобода";

        var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

        Assert.AreEqual(key, foundKey, "Found key should match the original key.");
    }
}