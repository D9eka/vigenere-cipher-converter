using Lab2.Cipher;
using Lab2.Models.Alphabets;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace UnitTestLab2
{
    [TestClass]
    public partial class UnitTest1
    {
        private Alphabet _russianAlphabet;

        [TestInitialize]
        public void Setup()
        {
            _russianAlphabet = AlphabetFactory.CreateRussianAlphabet();
        }

        [TestMethod]
        public void Cryptanalyze_Test1()
        {
            string ciphertext = "мкюжбпптпмеывяяюйымоппшсексъжмхттъфмыуягбкзмбпптжмевтытнмпфасшуъцншжбрюсюып\r\nнбхзьенжаюязьъяршхчемсгщнфьжршкыилгюохцэяййъопыыълнщжщйюупюнвптдщрыванхэщъ\r\nдхщряйяыжцмнэгцяъмтытемцщшяпсытюузхрнкрцхбсоыпспзуюмьшокчогщнрммшюязжбнаьжб\r\nрэутытнщйъпвпыцбсзжцпелуъяргсыгюзжэмхщдъапкоъбюмюдчяйвъревпэххьцщопсъымюввдяр\r\nыздбхюныгмсшбхксгэхлкыблеопяйсждцхбсьдчысщымрпьжяйруялеьпцнящгщянэжршлчвъп\r\nнвуяхмщпщмшпхьювкыцсчсванящжтпърулеоыланаьжбрхмкэъдфйяъягйьмюужщшебмаршвцсх\r\nдстшюйыуылеьгоряйвъякчючшеммпмхйтспевмчхяуйъгэнспмеавяпюоуъцнзжарппзябдшштоп\r\nыыцсокмцйюшпшюрчьяюрыпбнбэмщхмкгехгсжчнлсгыгнльяфеьпжйнжмркещыпкхаждяйысмг\r\nюпзсгъщдфнрйилкэипбюйхьанкжхщюрптярхухыябйажммыыэсфсзжкъкйцнпклссуэрягнувахйж\r\nфхемсгякхэцсяршхчевчлжяхксыяюмоягешрякэпвахмпыихуптдлхшжссчэсябсмыжлхрйжяр\r\nьжбйюямщврысмчхэрнппысэнмямхюпждькющйыдфожуфяыуршкрхбреьъыбшвужсйжфвхлрх\r\nыйнтпчекилылнвтлгмкмщврыжчяйчъчнвсзяккпргххойдуяжжсмевжтябйоярэмысерэръиап\r\nыждессыьэмжрыеэзседпзжиняпскъжыпхящхчнбссбъбоьдцнбшунхржрпещхцекгуллхммбекф\r\nтаюяэрягвсръллфочюевъцнньйбецохфндсссжхжпчдпппюепбхцйююжцкхбхэяъбжюнпьжбрэипю\r\nедкуцхгвжщохэхэлмынжярмжюхяптсняьжсмнвлжръвьягсвмжряйпсножжйюкмыжаемыжбхузъп\r\nхкубйхплъапылжрежпыгбпыцмнщхшфебзъоппйаюыпуычлшххмннжхсдкрябткуцюгпьяхяухьн\r\nвьпшюязжбнаэзснбксымезьъярылжрхкпбйкиъыреждчнлксжмэупждемжхйхурърншцщщрызхс\r\nдпычшиэрягнбуыйхэвлршмхэнсяхббнмыжмеызжвеэрыихьзжпеэоэнсзжцпелспъдыйжпхптчю\r\nхмулулктяьньшскеухэчмфщбосщуыжбшпбйнмхчмшплэхрпсммшпванцчсшхгкиаюяфйякхюв\r\nыяэвхщххохветызъцпкэыпнмхэбнлуяфеьуълбслжбячачнящпщшгьхжлмпжумннжхекыйжйюк\r\nлссуждохякрнппысэюхбхакэрхэюрмпуфюожуфяыуяхщщпубнпжшюгфйячрэгюнвщпямрсвъдювпу\r\nндяыъмйкрсхдьжсеягтяслпсъдсшхххкьмуюкпрыуяыйаелпучхйыйбйпфйяъямжохящпчмсиы\r\nдымыыцэоылбйсбуъиажхтношпбрнтуъиксъымнтуъхошжчхжкзжкэьцщонщжщйюввахуылыря\r\nйужкенръйщшьъккойъхрэгсцккояумпляерэгспсупъмьпсюнфсочхркрылкпкшхлцхтнлбзъмеы\r\nыцюбссбкеожсоншхьхрпсмметйбецызъврыьжвэслжрнбмэнбпржвэйныгмгилкюэзъкэзжупнлу\r\nъхрдхцекгуъднушщемщпанбкуяонэсжецыыщепщпъярксыяэоужбмсрыохэдщюбыыюнлсуямхйыъ\r\nбпптжммсръббщжщвхэсжхенжчейыкуючьцфопсгцекгуыжйызъпшюжчмюрцсюквжыоноьдфйсв\r\nъопыиделшхьнашхцэяййддхмпцекгулулпзялншэъгююрнппысэнбэръцныиаюгкыаюгчнжонэсж\r\nялпьцхвкьээгклъдфэжчюенжюкевгчмхуваеоылъамфябрчкьцднонбнмужэкхькссдсоуюкзж\r\nупнлудчасжтпюъпойщшьъкккжчюмколбюжхбэршхухжсжчмняпьмэсзснпбмбрбысмчхэхшщпш\r\nжэкюсзснпбмбрбыоуеягжьмюбхжрбэмхрнмцикнсоюндпкъоешхсрнвъыякппюеппвыяйчхаухмъя\r\nпкгоякющйыдфклъдфэжчюафсъцпытжмбэфвхгьдъмйкрцхосъчшимпшрншпямеайжкдьмсмхупю\r\nхяксщмнямбрбывыяевйчняййбоеапякэьцзпепыцпбэфърошхскеьудчхзжэсвпучниужапеэвъм\r\nдпугхчэжххмйсюнксзывеэрыехьхдвмфмцпюузяршэзыухсвангчыэнбытцпсоуъдюямюпеоыцю\r\nбсзмяелмъазптрслкнчнцыуяякплыъйызъпштжбрюжыпбпкыюнпйнжмхслдьезьыйюръыйнмл\r\nдьезьыйюръыйювпршкслсюлжхуьхюиаюркрнппысэюсссепеопндбсуылеьуъсхжэаедзжбкеэт\r\nжпрсрнппысэюяямтвюэзмецысывмфщрслккснгвжвмнмцюнкьгпбнжфдлешюжцнмвжпезпбйеэхч\r\nмнтщжмдпьбнмчпэтпплундяыъмсзжщхмкмцнйыусепщхфцдпщаюмссыяэжпхмшпояохэпытнщжтп\r\nюъпыямклюхягфсякчъяелымзялпьцхсьпхрняпцэмпйбйпфйяъмппбйкиъжмнбзъохэхцекгжбрюм\r\nпэхдшштхесубрпчргххзжбкепкъялпьцхйхьанкжхшнльхцшбуьяиящъжпвщхшмюрцсюксваеоы\r\nлябющмээяупжйбкьцхпфьяяоысъфеьулебэхщнлужэкеонжйнщжашеыуьюмстякбщмхемсмбрн\r\nждшхужмцмюосжфюжжбпнбуънямжрндсзмнцшжщмштхаухмрнппысэюпкорхпксыбрыьъоъюъяярг\r\nряйсямдонвпчюкыымашжхбнфямчюнэзякэьжжонмыжибслылнэзыашжжюндпсжмнвмвдсшжу\r\nярммчмхухщхвщжцнбзжбкеоыцбхсоярешгэнягвъбхопщнлчръкксутбсойъбпптппюлжцшмклрхн\r\nньятхпяшщпшжэкюстжкбшхбоншгвемспсячпкъоешмюхяушсяеоужбмсрыхппмбрпужапеэвъмдпу\r\nгххлпъцпкэыъяьхрфеьхщмнямбрбытгхркзыгщщпфднушщемщжсбшзшбймсрцнцынжйнжсждфкр\r\nаюиэзхепбйшнрыьълсбпэяъквърнвваеоылябюжмтндйлоьйкранрупзхнльягнмхчмштысъып\r\nучняжшвхрпсмярихардылвяньръкксутбсоыъгдксыдексыгхшжсюмьцзоншзаерэйъецываняж\r\nхскеьуъцншжуярммчмхухнрюзмабюйиынцшхехъмциедцхпбяпуцъашмтндкзъеящдбосэзпбяпкъ\r\nяевдщеяйчжбоыыэеявмархуеапнжсяярксяняьжсмшвлъйсвмчрюждчшлэйыдещмээящйълмкръ\r\nрншжжнпсмчрхшжсюксымбяпвъякплдчысмрхнньятшызхюящпнрныикъяьгжряйзжлвщжюхяг\r\nтяхдьмсмхупшщпшжэкюьмршкслъярчвчшоыыэедчфйхлсыбкеожсюрпсплбыйбеизжэмнщмч\r\nнйыужвмылжкньмцнкгръбщщжщбеуыъгдксббнттытнуеапнжсжлхъжцнлбзъашжжунпыкъбхузъ\r\nпхкубйнтхчцкспъднльъресешяжпуцпхбуъярсжткслжшнишмэхцсжьмнэзыхсопсхрпсммнвфщ\r\nнппжбрпыкъихшхьлешмчмнтныгмспьпеоряоппьлбюптъийыьърйстыхмщмэкеуздюкгуллху\r\nхчхйчсялхнрхеящмарньйъбпптпйнщжашусилкхьхюхякуляйкошхнлхэхяппчейызъпшпласц\r\nсмюпнсоседпуыъйысэхмнйддбэйъеиууыцезьыбнопцопыуыймыйжммфмъргфйлянмьжлеьуы\r\nйнмжшщпшжэкейыаюдыыцэчмыюнлсуячхьхихяпьмегьцжаеэмушхщжшюйммэхйысжомыпунаж\r\nмбрмыжчхязжээгыйякчвжадкйзъцнбзъашзьыбкпъмбмстямхптчнфпыцбюжфуеисмтнкииъбэ\r\nулжръвванящжцсенжбепочягюлжцснэсдцююмтндчщъбмчфьюаызднмсщюхьпзъдхьласцыяся\r\nоытымюпзцсящжанмчмтнмкздпшужцнпкгюпеоыцюбжгжраысмьхтпчрешмбхаысжегкыэсфсйяе\r\nрщжтнвщжршньмзонвуыкхьмвексляфепкъоншхьхрпсммштпхюпчфйхиитъпъстжчбмпусенж\r\nткслжшнеэжхсбэзсхемыжлящьяфдчаылхьшвдюиаыляйжчмеэръкэужаюгзьыунопэйнвужон\r\nомэюлвпэняпьухъсгсячяпьмэчъыкяйшчецыкърнмуъярсвълнбдэчдйтсаеомжцнлмбйньмхм\r\nнтаждпыыцххлмбйньмхмнвшцепзмчхчзмаеджпгнлыюыанупрегшхбясоыцбршмцхиызщевкмц\r\nврызявсщдэхмпыцпюьуяъошжбрнщхяоншжзмезьырбыьчюъсзанцкзжкэьхпдещышнящдшнры\r\nьяънщсывюжхжцнмжсяеюжркюэзпулфыэхошжпбкйсяяэммтнкиисхйомцълсйыукиисхйьмщсбп\r\nкъанйочхошпххмсзманждэчаытдфхмжщсячажярмшсопплыякыйыхйысэхмнйддккръмхбуъоп\r\nплсюпймцщрспщмннпждпчкыеоылъамфмснязжщхмкуыъяыйаелпучхйыйшщпшжэкюэсъбювпдгм\r\nкзмецыочювссъецывъкчлпцэ\r\n";
            string key = "ЮКХЯЮ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test2()
        {
            string ciphertext = "ъэшязонжзршргчшьквбрпсэъшсндзуйпънцумшпсзязжмснрхмэьржеыювштнхкйютррхвцрорщй\r\nюэьршндигъъадсюврчрчолибзшишбщняеорпшбрвндучвхайодявугмэруиююъорхощвбмвевжял\r\nхруъйэжздшнолжздхввклзьъътрынзевмуэысныютщъэжяещрцэъвммнчъеъшщсяррщеъдзувцшд\r\nйчцьсгаулдуькмоюьожоъойыеылжшрухпммчяшцзмшэзмснърйнкувмбэхлниуыррднхтнчи\r\nжнжзмюэуьпкьрфьнйъетсоомшбшвлсоьжнюсдъятпэлщюррдяуибзутщыыхмюььмяъшзвеоч\r\nоузвхжнпюрушйрвмэшкущйсысвюрутзжуйшьмшчштвпвмпчпийядрьишбэжнбчвспъэжтэвшжй\r\nбэьидхутшцьткцщшфючьоиршлйпъшсдьмьгэъшсндзуйпънцвмшбсъчьъярмьснърщьпшщсв\r\nължзннррзъышайузжвъмжьнызцвятлвяъшйобтпрошчтривжкшбшиуэвхзжрзьмаэпзрудйчш\r\nьквйьюфмюзпфршысзчолваущеьбилифрясчжзммхзхбчцзхмшпяйшврликдъйцяшзиймзгшу\r\nеышньикршйннрчлвщянпъхшзрхзтхсхъшвошьзвпшыишэпуийюэеъмшгмсемтшшьяжхвмтрал\r\nцндродъмнуничосуфяхлпшнрхфшрярмзмжуьышнрожвысжзрмзеоэрйикчльчяжжлнвщелий\r\nкищъмотяэьянъозшуйрийчрндяшйяфюрхшщоюсномвхзшфырювжюцщсэчаухюащпзйюьечцьм\r\nтхцшжщжнрвиучгрцужрашщсяъсплкюнсвыжплкмтругйтяхпшпшбьтснъшушщщыилмлсчыысв\r\nяъитщынхкюьмрюцзгжнжульълмбхжшвъжвжсвуъеьчотжнсвсъъзжьъчимвятидощшжрриожю\r\nырруцщфвдюлррднмыфмьтмщизечоэйщжнхюеяшжъъойзйшпсобощмеъмпрзэжлнсржъътжлнмвв\r\nмшьзвпхыгоънптялоршсщфохтзаяаойжхжуьяжсиэдюфелвоьшбмяйщжлгжмшжтуэеввлзквшэ\r\nфрввъшгтятсгвуъйьмвжуяъузртухлньшястрынпяцеьонмрдшчвшжлысхжзйтякпыюьограъ\r\nрийярпмэрпжшрдвргехмюсромшэжвомяеьцйрюршюрртьввкюдеьбиунощуомьйыснщрйэаолзйм\r\nтезыопьпуъсычойнярьсряжцшнъшхяяллкюяцеъмумшощричцййтъьужрровынщшошсашшэдъ\r\nсзжшжъхмьмчцйтяощшушшрйдушямьыщуияпшвшсоуейуымэаитвхтьенъзхшнщумдцьидмры\r\nйяэоужнсртщышзэоуъавбйтвлюзечцьгбеыюирэщзийдъсйцьзжнохншбщнмеззюжвоъеярщицяу\r\nфмежутщыгзвлъойщуьожюкфмжхэжэцшьаобоьмжрэурвнмкярпсыдапшеьирмплмбээщмтчйфз\r\nэзрямэьзийузечбжшбюьппмсвжнлхзмвятунлшппуюзпухщувижмжзннщетъжвяямъйьптжшнщх\r\nнтяумшорщйяцотзюыэсчцзхмюьтеучэмыечвымэйузррщйэъушююьмжишйриъъшиоъсышбрзр\r\nшбэдшеэруиюзхкдмдйщжятжнпшпрцыьвпшвишбэжнбчвспънсхлрздлбвмнлмьсъъмжзюышйэд\r\nбрямчвсрбэпчнъосщжвпннчойфяозумръйэжзднцшъгшаамзроштщъзжсдшчвшжлыснпшсъчхл\r\nемрэушюьйндзуоучошюхърписшмлныррржлунлюсошчоъжныржчыйуягымбъъшрвпрржзълпм\r\nецуяюхоуяййъсйюрсноъуояътжшнщшхшуоязроуврэфувяъиишфьлярьущирьснгзррзъьышпх\r\nымюшьсилуржьыьуйещрвзяшмйъпщйбыжпыюйъсъюзжынвъсоълынмрэсъъжшюршнюйцьквуш\r\nъйьыупюршнюрщщзийсмпиресвщъшхшбтжыазшхшхосвбрдйчцлхикуеаэъэжусдъсзжжжоеъзйна\r\nотнмуъачпоквлювеыытхсмрыссжэжйпмфйзчйгсяшьрцдушжюзргнызхшэочйнпшжтмрдрхфу\r\nшюеж";
            string key = "ЮММЕМЯЙХИ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test3()
        {
            string ciphertext = "жнаошйчйьеьляхъеуэавожуййпрюэшчрркчозппсвеьломчрвюоеьмвяймтумзшкшрпдвууцйо\r\nчжогфевюциуйуроклршясхямьяьхяьоитсдмщхыхаеъмьъьйчвшьшилпчжчпусжюшэуймкр\r\nдчпппрцьдкеьмвяймтумсибьбщенцьюжпуфрувнжбайыдррькавхщуйьцтеряуяыншрусшяфбай\r\nпжьхбэшйъйркрйьншзржвюврмъукоеъумйшозеуязпцесбайбыонрупгъжщятхемьпъезюбьщуху\r\nыппгэжчкояэйщзункнжертшцьякрмйммовзмнжьэбержркшкоббсьыънскнфусянаэппррчювдю\r\nьысмдбюосзхэншкуизпрдояовисррпхврусибймьошсмелхгенцьюшмьязмшрусгршьмгкхюеь\r\nхшрюнржвпрпщйчтуыухынаврврмвнавмсмоьбуурузнсбчгчмбемнтйьхбйьцтеэпчюэешащмех\r\nуочоууюрфъарюфэнуъщьркшяьоюсожсдйкбсьдвньдьрдсрмшеэаутьюньпдяждэьмптщжсху\r\nюъсуыъхвеъсяйуфвхгйчрючпхвриушмйпчиуурбшяауутлюуезжмуяперчпчзшиляухяхншунв\r\nевьхрьрюмпжяювюдушуъюъоууожжлрпчгшяонсмкэууэнуйчгзпвюжетмцпзятныжьшсаедрепм\r\nшпмхоеэжънжпугшскжръшьнгзййнтмзптоопрюбышбораоущвнвжшепмщеснагшишфнещмриьюмн\r\nтещгбннюбежыъбщъаршвшкимаоущвпоябалуйлрцюецплфргщаогэнвхьгчюмпйачвмвшнзцпруом\r\nжрхбсьыънлязспжанвдпгыкшдщбчжэжьэянреоюуяфоюмпсмьомьйывщнахбеъдцхткшйвчуий\r\nкуочхздзюбсьыъюимпгчмпдйочоууюкйпчжчпкнкнаршймббхаачумвйкпглвшмрхплмзрлля\r\nчйяпзевмкзезмрйубеыжзюяющмыхьюшэъсыжфэхщэмпьммэюэжшояюлюшеершкеачпиуужеоюм\r\nкзхбмцррифжнзйувшсчрйъчжзжоюуюяпмкшрлнюмъмьэвшыышуяяэюрмоюуишеяйормвоябгры\r\nмлеуъйщйхуяютедвшльылжшйрршйьячжьдйрпяэжэюлььяовьевбдмзывсхбчнзшчрйкьрч\r\nрмъвебйщвульябаввьевсъсчзмбркпжшйрршйьзнжжжьбщевьмимншсяушишлууъпулвхзвшур\r\nоьлчхмсвпьлувшсчрьбаошкштьмтеоцымьцчйомщнирщсчсхьрруснжпюэябгрхыезхзмзж\r\nюйуютлямемоижмтуубепплютреэяотщмяяэюрмъдчекещйыжсеэерйядчюжнухьхомьевирыищэ\r\nнбсдзшешкьпклуфрбцвдмчрвнбсшуувщбавошкршеядовшквныфрошойящсчзумрйбсзпвнмдпр\r\nрвщхбэувохынкбьррууеынавмзиесмьоъжзеынхпрзоюшмптшсюцькчизжрящыужъйшбймьйуз\r\nлфтхывщшябшякпвшукрббцщдысркьрмжчбьещмрчркрмщюборлоклпклульццвюмбюээрищшпн\r\nсьбеъйяпщцццчзщювсъйщмыевхбащхннэсзьэпъэркьтщжяюээтсыжъйзшбачйшеыпуиэьуъэхух\r\nшсшяьбпвиомйьцчзшзлррнбощцънраулзхвюяющршрщхэхзсохъэнеыжъйуъйлууурммшйчхшв\r\nщюлхбйьдчрлюьтщмтхнещвмскдрярснжямепцжчршеяююьнмсэомулмихкьярсрящннхщюыцоя\r\nоцтеяшенсяреыпзюзнтршятежкуяхйрпрлгвшумяэсъмълрмфйчхяхопьяамукщъвебурйшкхжьд\r\nзхщнняпяуонезебжожрозюрмъмьэшррсвжпдйдунчзохэешазжшртпчцъылбшебцщдышроюмзшя\r\nхэешазцркйцуулпчнляузчзшпьмьлчпнхзхажрйрпйпчжчпубопщьъылйшеэалтынзюшазжут\r\nргьэрывхргэсслрмвшуршыукфмкйяшбнжочпузувоязмрычшуэщюрршцнючфггоъэмурмиюлйц\r\nуезхяеуержрзрялнясяцвнэнююртххжеуяъмэезэщетхэюнеьяхйрпрлгвшййрьртйздышзсажвпрх\r\nлвпжъушяэхбсьыънлязмжэшмняэссмыямнюишыъэхязетхъэарчмыцомояшмчйшчвеясьдесх\r\nкутъшзюьярснжсдомьйщжяхвшссожщхуюппррчювдюеъжьяэюормьмдрнагшишдйсэйщсмдьвлв\r\nшсчрьцчгожтпйябйьмъхэншавжъеыеюачвюяэъэршкшкоръсчсреояэйщзуойловижзесмпэуум\r\nчэвбмъдумйпчиуурбмнтьнцьхядпрнпшцзюдмдмчйриюсыхзнвеыощшъшодчушкуюуезжмуяпе\r\nрчпчзширбчвъмэезэрюесмецечизхвмрцпрмйрпвъзезмэншкуизглоьрчяюъънрмбйщмчпьяамл\r\nувдьяупрурхябужъуширлппррчювдюйъжьяэныгчмщюшрув";
            string key = "ЙЮПЕМХМЮ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test4()
        {
            string ciphertext = "лоящоьшзхнтазиоянмеомзелшымьшрзпмйящсфвфьрящупмрмвряысьмзмянасвшхпмпьулрп\r\nжцоншдспцюужябллгнюджафкшэпяюлжзрямжлдвшкхзитзргцщозрьнтдцжчвпхыизишасххтмъ\r\nеспьмщргпммушпххыощщммкйыпрчъелотрыюумяпмьэпцфозмйкмфыюфетзцжоммкгцырсюнри\r\nмррржхлмъхачсиьштдцуэвшяпжкаторыквочрзмхмяммьхйжцхьшрзпмышнпцйыпжчъпхьхъи\r\nмяйтфсугпдоыъмбцсаыивпжклхлвнихнхлвнсжбрмугржеюьлочуаиуъюбйргвшигьфиряепдъж\r\nнщшерийхехежкиучесуагчюляъкхьмйкьоймзмчякжсммчякжеркхреслуцясоряоюуьиршьез\r\nракршпфпижяумпхлмзънзрфыолгмхппчрлпмрршьэмжужъшцсхупжэнзммшъшлцтауршргхлхуб\r\nлпмеслмкъиотмъннпнмзщюеплхчияхифумзхьзосучмктиыолгцуэрмвххзоурэпкгсухрбяыпж\r\nыумцуиглъюмпнмюянтшгпьчъжонхъиоспьпзюмкрокяммхсъиуьпцырвщмькйазинккокпбьчг\r\nмйлшонндрзоюътдсмыдряжнпчшндаасуымхыатуншнжсхырыхуфтмьнеыюршжбтгьпзхянжм\r\nхззнхысьмюяяйомэрпяуфршпдцшкьмеюеюфмышчошырръесыкшкекбвтърщерхжжохифьфирз\r\nэмьоюрдмчяпмщьюошсьшошлзфхъщюнднцжнхпжксизесхррщхбцфзпжчъемфьуынбвосшчюу\r\nхютьмдхуьмчвюбьаыэмьяукхзможкойуцюьуфйрчръоаърыоспсхфубшхюылтюоуояочрць\r\nоыъилцзщжъзнтплхчийюзотюбпцуисуфсдмхйчлйкщрхзъхомнзшояужизвшпяикхзмьмхушз\r\nуйяттурыешхфззюхршрзичряпсжзмпчсаыиомхяоързэсмершдряиэлшчрцзщъъшряутнзшеох\r\nррмщюгуэянумярлднуяхьншкчсожьрюякбышмышйхмпьулрхсщууцеохлмзийяякпзшюмзяпч\r\nрйцртфзуажлщжчшажфикшьйжллгеуръгюызлкрцлдзшлжхяжоючмжяжнвстжырмаюрьозрщрс\r\nгпршжхязкьхьбтмпьрялхзэжвмгцсиыизюомрзрвпятфршьезмкйштляннжшзхдцлпнщншмнцо\r\nъхфмлдзшбяягптзхязьпымбклбпчрппжйыюынзрирмвбтмдлмянтзайуьсгжцжьияуйимшзюдц\r\nлхэшкяыазмлйцнехлэннжррмчбямджцоеухкьмчмцгрпзлънплжомъдмлхлдесуагуэпкгсушыъ\r\nнхрдоьюгжнплэнгмянмьбсшкхбояхвямяыеуцнждюбтзцпъркъуэмвшмзпкпэмкъчфйзрнуоэймь\r\nхтднхубяжирзмзжкфнппьюгротюэессатюъпжииушвкбуиыюбнлжрзучрсхтышонфжпмщммксар\r\nущнехнушжйянфршеендкхяьъккосшвхфсаошчрцйасчлпцйнжяюьхукхвупжратрзъпмсьшзснп\r\nмжьшдчммхыумчэозшппцэипърохьщгэшмбспждрлжжнхубмхсъиуьюрьиыбшдтзцмдрпуйнпбз\r\nедцлжымлкуоячюркысьмзмяъсжлзейхммдмкюзокшщюпдымяоюфмоьпуънпыпьуяъланрънф\r\nжсшчвкякоиьрямхкжъшпчяоуурыхыощщммбсиршпдцгпжчьегуиящмгйхдсляшехлйвшпяикшы\r\nмряйэмэшгхсфуроькмтзщмркйыпрэнзмсухжбхынхпщюгцоууошфсюлрьхнхсшззшоппжяяенра\r\nтувюмыатшзюфьалхчефжеулемхкоъюденднжпшйцоаърчрехцырзюййаузхеемзпузепххймзмч\r\nмнмуыенпнпвмйякожъзншмнплвлцзфьуулямйзшчйхвоуржбяыкьрчхудоищмгохсмщувхьфо\r\nымрхьихьимчмхумвххмршфряуйоймзхбрарлошсххпьчътуфвшзъууэторкхьфъурлоуфурю\r\nдцсоыиыюоццршщндрфуршйцоасшчэрпрдымачсиврщеегххзхвхьнжжеенройшжкхусждвнлгях\r\nтшпехлмрщютвягыукемящзуимжнйрщрхмбсмпнсжепквяхуипзуйясамоземьаышоямжйозмвксо\r\nыизюмжнйрщрхлатшллцзщихьюдсакшщнгпфтушяухлхчихойдшфряяйфзчвнфжжхычрехншд\r\nънрпышъредсакшщнгпъвшряумрзормпжмшэчхьжлжпувхыкжыюуялтгохмжсппчиляпхмяумтзц\r\nмззнфжкжзоесзаиртюгьфымъюмнфйымццоиурьчгпбмщюружскмьяушкршънсцйпыреуыюйшя\r\nмятчртрлрсюьрурясщршйрккасчъсмпржчъюесюфъыютыойюкосжешвцхаифомяпхынжрэхтдм\r\nжчэесйаьмчяуьфсльномнгюьнипцумыесзцжтмрхтцмщзснжржочеойиуюкфкондвшпяикхзр\r\nачсатючнсуэтлфхмжмжзмусхнпьмяжзщ\r\n";
            string key = "МЮЦХАХМ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test5()
        {
            string ciphertext = "вхпрфилшльрсмжмлюнщнлшуьмлпхожнжьмиячйюгвичжлащпиэьоусднззччкмъупшдмешм\r\nтрпшссмщььшсорувитднъджжсднърэчссуахуйьнрмьтссбвтсйякешомвэуйушкрыпмнуолсэ\r\nржшкьъыкммзйъщпизхянвхыммэяшеуузйчщхтьмзжтясуяшнжчштйьшйрсшсььыкиаьйшах\r\nхдзрюзюулзфяппврйлсжхсшяысшбвжтрчыбвжйьвьшвяпвзсктужвюшхзъхэиэсйузецвмвсмш\r\nюмюымуошфуяуытнжеюрувиюбзэжжжьюнъжыаэрвемвшфизрйочэрымуепыижмвзэцкичточбе\r\nуэжыэжъуукьчыдиыььъэхячмзосхйрсфясхьшсффспэыцвжсцырчржвюсрльшсхюрьвэнн\r\nыупужщбдусйюмхяомужунйщпэньхзъхуняеыъйьвлезэжцномвжвьрмнмзжсожнсмлезжмэнпэи\r\nюпизмвиюхячрйыпвнзуецьющщжвюкуйрыажэкнзуьсвмвсмшюмнэымзфсувъкьыыдиуыэчкди\r\nзпспщштютьчпйышйрщырввпшыпгиоыэчыбнзкзжйпитййыскичдвсмшмрьпнмхзэцэньххшкв\r\nсвнйрытчыбтрувнйцнщтйшсътрнйыксжшкыэлемузоыпикчгопшньмшшсймиэхжмщмявхжжне\r\nышгжжэрымлйыгжиывочмнрыпзэмнруытыивнзпочыязугвжыджшкьзымэымвюкмяшлвэтс\r\nчшношьнрыжмжжшьщпшэмешчрьвмкичзрпыижюжкхйбяьпрззеыухужэрядмшьыижрыычкб\r\nнясрпыияяжшюыижшялъйвнчрьяынзюннсьххожсшковэхунмрнздььщъйщдшьыиырйьыиж\r\nяужвстяшщмжжжхзиойофреэьруьюкмсръгдкмпшьжчюрурмьювнаозвпидуьзънжрыычкбняс\r\nрпкбврувнйавщдкнлетикржсянщиржьнфъпнпкявнцэжйпитшжспрзлуозыцтупязпмяъдьодсгчш\r\nзэмнсщпэжбезвшхэаежвшшствичжэзпвирзшмэрыртусьхноомыймэъдвнсяшшьрлзеыожсзспв\r\nожсопгсьхшъыбдбюьчсдиъдовмянчзьчымжкфъншюсъмзжэрявшщтпавьдбсоезлзрыпрзюао\r\nъщбэрзлшкьнжыэчкмнмышэахицпижэрвщптэмонщйьввхышйьвмнрзцосщпэяхжжскячмоабюзъ\r\nпоззнмпжээмкнзцшэжхмзцожрдизпищшнкрлошфлжшкьесятрувипбзъьоесхсшучсшежцпрпщн\r\nудпшыплнслщшкпвяуесзпнсурвыджшыээшнжзпсщыдчшлтшпиушнвээвяъхэйзпншльыпмжхт\r\nысшбилтрчыбилвзсояшммэькйхосошсеъуйрысгицпьшьнлшьйувючмпыэшъмвхмчкмеымп\r\nрчщьшщйзсоышсьяэрвьмэжймидхуэьнкрябстхзъжзжсвньжлсбезъййэьюжмсьтскишзысб\r\nюшшрвнмянчзьчымдркьъчынчзлэмюжугжжшнкшяычкбвэжзмонсйрьшылявшшэахиьдвэз\r\nнтузрепясшмзнрбяъпоьчкеъшзамувямлсосбущшммяшщхвсохзвшшъсиизхужрюсшььюунлш\r\nпнысмжшкьщппяшльпмшпщмлньххэьорзнзхсььзеыожсзспвожспэрирзрпыоышыьпыгушнв\r\nээрямсфюппжмзрпьнлшвщюспитйрюсъзшиеюсиууущммяньмвъусгяьйзчцлясизспиочоыыля\r\nясичыязуплээнйрувээрячъръщнфвжвэвхюрытэтрвдррушежугзээяялуоэщмвчпунээсдпшычр\r\nнбвзэвшаьмвшфуяапвньявоцъясциззьпзпвъплэшеюугжсядэвжээшшууйоысйууььпылэчзь\r\nыумвомвжиншыманприопмшкрерйвэмшпшйюсьрымсфшфумрьпнмонъмзочплоыоюкйяэьршйк\r\nяшидмэмнзпоьшннъыищшеоямлъпцвопжщппзвжжзпмшмсрюпрнщжшъсизвпъщшюкларцупэпжлпэс\r\nбзжшюсоышлоыкмжхмръэкняжлньххэжтнршкмфэещнкнжуйцхжчзлсэкэдхопзпвъплэшеюугвн\r\nсльрьрнжхзъпасэйвжвьемекъжжесятррьыымямсфшфевъухргмннцужщюсутраяюйчжулщмвч\r\nзьщшнъруэшыюжъхмэьхзъпасэйяыпвсзпяыпзжвшуувьюылэъжлекяшзжшюспнтжвшыадьжки\r\nэриопэймньщжшээсйгмтюсбжхщчнурвщхъэлщтртошщюччсщекижшыэжыаэчсьпсбаущтэьтту\r\nрэшыеымолжщхн\r\n";
            string key = "МХЙНКЮИ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test6()
        {
            string ciphertext = "бврсътюъцмррбмютънизътюыэеъпжсдйчйымщрюягмтпэмыхгмзвамжмцоъхщтюьяизжыивфюсз\r\nышебхумюыыхъхэстпчюгьялетчюгыдчвыцгюиъжъжсещпюдддуйцгцпвзчеыхуиьръоэжчмзэ\r\nыпзвщсбьыжюуързжгйъпэмцшййцзсстхсщзмсввкъимзжзъпхйцрыйтжьяюнчсцзыурлысдмэйц\r\nрътюйшеэлъждхцсиулйжспбджзлрляэзпуеьмюувлэсьпэмъххеддюсзышмъхшсърайдуънтжэрв\r\nлэмъжзитхушрзмсжпчжчуягюсчйзоэьимчмятжкыйжлжуъхюйъиюьъирысспыцеддояюсъимм\r\nемыпшмыхшппъыпззяодьдиъжъшвуывнйжуюгцрюыцаеыюйгхчсвыэмъмюуюпьгюлывнвъмцръг\r\nцжсжвтцстмасязчсцзмьцвжзрьягъхчьщфнврпуйяйусгуъгзсяурлысрыцуюуъяюйюсзышмбх\r\nььчулзцптррсъгсцэмъххедцюсизыжбхьььмшжвкъиъгирвтдиъфюуюлжпруярвтяпргаесжцеаж\r\nюуюкаечтжоюзъургюсыйъпямцгцмщквсяцкпщбъздлзхбвртыжажэаыжседдбгюпэмиулйэжщтнфцй\r\nбцупяхчещпьеэжбязъжжэпфурлысцптррсъгъхнвюзяррсылыхцуръжрюйбьчтжфюсжйжйдзчс\r\nчпвзюуючжжцжарюкъгбмщйъпюувлюузуыярфцжявътмзшмажыжэхыгжьдхзщумрвялюуяззоэьи\r\nмчмяуятбпщйбйътдпхйцръяулжтвьжирзхмэжщяюнжвцсдкззмяюачюшсялвьятбпжяъпшсчраь\r\nаулндмэйцрътозяуриъврижлеыэстуъфелжваьъиюсведдбдъжжйюзамххцйщдчюшуяжвкъиъгир\r\nзяуйъдайышэадхцлрыцетспйдьяжцтявбпседдыибштмвыцурзжхзпюсзышеъмэаыгбороявнъцс\r\nжжбмгвъуозятбжрпвтярвжрженуещхбаъмаеыйлжэхьютхэмцдбсчужрзгсбфэжодпсрюыцмэжбяз\r\nъжжэжзурлысцйплзтжкыйжлжуъйаьъждьярцзссыхюсщужрюмбввыцгвучючпаежпътютжзрты\r\nтюецсчшугеыцсбжчрзяъфчмчурлысуьяячхщмажузюлывщпиажспоюьъвэпфжюжрчвуындпю\r\nечцбькмбвтшжячцьивымрюпюузецсчйълчжвйъсыщнуярвиъпнюызажщйьосйылчючтяжйзя\r\nфртаецыцсяуыдгляквррпзнянймзлтмьивьяизжбмууяпжжрмбхжвцгхйдцайужуевыэмтмбвзлы\r\nещжтгбмвмчмшсбжцозщссаьъжюйысдйжвюйцсъхюуюлдодпсрмяумрсъхеяуьдзлжяъжпвзыдаж\r\nнвютдпеъийенбуроджюжрчззммчйбйизъямочевтъваьягззмжевжуоугмэсътвлыцзнуеддяррс\r\nъхзъчсужюсцсярзгъвъпфрюлэдамайццэозжръвтыждцфыряэствъурлысдьжфефцжясыфюужгв\r\nьъддуъяюачюввжувлявипшмщпрсъмюузмщпвтъфюсмщргупззжпнуъжддюйбмуеипщйджуюыхюмцп\r\nбсюиййъпзьйсыжвкъиъгуещмшствжувлюсцьягъмчмпыбйчпуйцгцючптсжхщмэжтирилпзвъжд\r\nхспвултвьсювпусцпфтюьжизубвтмчрммноцвжузтжрдцссссяждпшсцтыэвышсшидвмсъэъжз\r\nтюъцютзжхюллоррылтмбвъжхйдцайртжузрярцрызчмвтщхчйдулзыжчирвъозудпзвайжмэюц\r\nжэрвъчсшыыждмщюапървьллрвдчвучювйтхзйъджнжумоятеажръцжгужрпвзжгтужщъпжтщхчй\r\nдцързйлутхэмцдылажэдаьывянжрзгбсщугеззжтвьмьжхэдпзбдткэьспчюухэеэзыозйюузуг\r\nмамжжддиеъыхвюжчмэжтируыфелмтювяиезсуерыуродяъцфжеажждйюсозъяерякжцзмыуызъм\r\nбйдуяжвижжамгмрсмрюмюсцсярзмсрезамапървьъгыхэсьмчюъмрсщдимвтжврсэмимбозмюпрыц\r\nмърыжтцтурйыуюйяръжзрруызтпьмдуънэхавюъшсшожящгчжюлжуьхййшуящухэеэзыэвышм\r\nшжрурзчюшхуувыюсцшцмозъсжуяорьцмъряурощйбжщжчжрмщэъвювъжщхчмвжцтбхспвучсвъж\r\nувоюдддэйдыссялвйбхщмыуяэззжпнуъфюсжйюикйчуъйэхвимяылрвюебхцстужжвзчецмрйэь\r\nдхщшоещфщмъпжгефшсбжроейчьдьыоюзъуюяэйьхцтюоъпюъжръцжищгбсгьяръжбвзйыивжумц\r\nрырруызэсяжцпхйцрыяолыжюуъгцрыяцвъжюиъяыхюмцхчюцзявзъжжэпфмыжрурнжрзябпряуст\r\nуяоюзъумщбссьярмйякъмзщзмчееъчювляръцжмыжрурнжрзгьйчсыйвтяввьыоюйаеысыэъцж\r\nпруущрэцюцчжрмпькзочмьпссдулззъжпюйжорпфеъхцсчпхйцръйцзасвуыйзиысгпщмимборгбв\r\nбшшвеьягэсоэргщсщмшьщшурэрасчмцсужчеъпфйцзмлтшшмймюсдтяввьымасяэбмрйъряхюсъ\r\nжрвцмхпьгвьжнъхюузтжуамбрзрывюйиьчйжвбхыиюнудуьъзюзсьщрярюйылвтэйдьпжвуын\r\nйшащруыйамборпюузиънюржеъхжжддуеьмьгерюсхмэьяръвюьлнцйусгуъгвуыйчвасзосйщпдэ\r\nрыцрзрыжюоуеъппгзлжсжпборвъибшшстжуждйъяэыяхруяэвсъгвъжжэхпувъмтбмуждхспвуярр\r\nлыжэмшсбжцозтытбпсйдыцгзгщмъхплмрязъхасжжсязьяжеажждйжръшоэрыцаажбпруыдцжбвр\r\nйэдпзщьыцшещдчювоятзыыррлыжэмбсцмуждйдцдиязчжгебзрйдщъгвуэьзхаяцзасъкхеэижуб\r\nпыррьъиъхпяеолортчсупфждьяррйцсбхщтюылпэпчетжпиьмаегвъвбмрстхэсцдылбгурюмче\r\nаьпквуыйцпээджрюцжбврйывнпдявыцмддсссбжявжурюятуртюпрыцмърыйчръйзшаетуъгвюжръ\r\nжжтюыэеъпжрвйжиютлясьявнгщтюьялетдсдсышрйбйгожящгчтбпнвютсрезайъуынхмчлюь\r\nьецзягзсызюзшеыхцацгъвэхшсужэмсждтютырруыдюйънъхфгъхуйьлжэджшсулямгвъжщхчм\r\nвлъфвьжвцгусъмсйжжщюгхуувыявюйябджуйцгцоззлжяъэйдыссшуяязуялвтэйенжфелжважшс\r\nъъжрюуълрвасймущзмцузлжжязыпвзыдасъвъжбвншюеэжсозпчыюьщехпытюйлжзсяжнуяяъжт\r\nсажаджръгажнвютджвкъиъгдквтъкъжчйщжщеддтсщжсьъхужюлжуьхчмвтюсцсярзгятбжбвюжц\r\nтбхсмддыятыотзымявучьппнпврцуюучьппчыюьщехпожюоуеъудцимэстмхйцзссчецсъмцеэ\r\nшвмчуъхюйбйужуйцгцатйъжвтчежчявюябвввжрзияндвджддхмдховцтъвбгцжщшиепзыьыуяцд\r\nжчецйбйизълрщъвязжжщпързвамозъяъмюсдмадпзшрртдгрнжрзгцсчжврюуяивгцацгчеюзсйдуъй\r\nажбпруыйджтсьмасжх\r\n";
            string key = "ЯЕРХ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test7()
        {
            string ciphertext = "лгчмчусщчппгужьйыиночфйгйбуоцгдобыйзлълдоосыашжйкежсфзхебосыодигмбшсфэшик\r\nджшчюжаеомюлмшощсъучщхяыднвлемоъпвжэвйгтбчжзщхцщрпскжйпщнэвмфгккнъвыгсдзтэн\r\nлгсмъбпфкшвмъгчспшумтбчжзщлъмджькшйпберкъясабмжуйилохщъсъдьмабюлыажамгзйхдк\r\nцщпшлыатъхгшгхчтгкысьздлгйпьсйбхйыыжулбмкпцижльыдюпжжфиндъпъпйрсдолэнбжшк\r\nбрыкцыжкщтйсохьъйоэыкежжойшсушкмйгзыаьынкншспржлбкьшлбмимппкпчуъгпюындямй\r\nбавцфсъбгепнцжбкцншсжзлкеэзижзшэйспнжимтгяыохжйелнучюжбктэьцдизтбвьлыжрнтч\r\nыггзащпшыоххйнапюлажцйпзлладвкнрыйшкцбяэмфзпккнамошпмогдсошыямщэбццддюпыиъчс\r\nгйпыиъчсгъсюсишзмюпшпижыикдэнлььдигшсфхжхиаяулыжакрмэхивмфонхйдчгесюшчццд\r\nюпзкиднъхгысфбумюппыоепяьднжфдуаняэвфцхйгбьмсдлчълэвкжзрюфсьчкжцемнэзшкмнгъ\r\nщнжйпберкоеьъуйпкигмюэбукухжмйбъпгмхпйбеьцхвммйдкпртдйащыпдтэопяыкшшабрськдкмъ\r\nсслцфжюгпяыйжсштйьклхлъхйпцхдсретнвлцизхпрскдрмйяищчаычлпычучзшрпюгкштлке\r\nэжэвйгепрыъфмлеаьыпдьзргзчпжрлбвпкпжсмапзкфцжбабжьцьвмхосбцгзльнжэншлподнвфе\r\nжкйюочбиъгбшсыушушибыпкрргиннжзмпикнммлфжащммлидргъсноямзмчщъьчвнъочжвфцм\r\nпгпыгхчщкщмйбфюжаенэжлзцтхюрпгэпауйцмхдзябфтпмдымнгрэпьшлкячпдзмжбнэщбжзшень\r\nшчзмльгщжлзцчрднэпапакяэучщцащмжвхжрюьсюшлушкбюопажзшелнушхжлеурсючздхчшы\r\nщгжабрфпкцжлбяэьфбхйопяыухжгдузжццпдедээпдьблпщыюдлрипстоежпкцшыохпюьсюшлвмб\r\nщтйыкчйзмбткичыяккюыиррмсгыгэмзмчщщыииъгочмлидргйпмюлфжвкяэвктйищлэпюдыте\r\nшсьфшвоедэофажкбомссщхчъмсьфшъякпшскчрмюфньцьпцбмжвчаджелнулхжоькофпжрю\r\nьсюшлвмбщмжолбхгъзьыишмбксеспжсгъгъгйжоъпрмокяткщмйбфюжкнтэйюнпкъйшщцасдгтаки\r\nрумипюьлнмлейщыджсрффняццпебсчпбцмбкучыюцгэопсвяегяйбрачхпйбтшпйилъмджьядздс\r\nськежсяьожыуштлбфавчшюшгрэвцдщмощъыъжргхппжфюьзнтиымдоммйфгошичедъикжюрнг\r\nзгэдункншсисзгнмэмчьыщцйуьзчйнеснжфкйпъплкюхжюепяшчйпщнпщшльжцедщшчьлъобь\r\nсйфхфваъьццпдипюптбжхапошцъюгфдзсншъдхпппхехкэтйыхдзммпзвкшиднлэьцмумапчыажк\r\nмъпчйшхжюьмппндгяйпъпнзпяйбзпкуплбсэмоштплрнмцзсгъбпьцгрмхчьссбпйэвэщсдсмаоэнл\r\nзжкщфншючумъонюлзпйесйоюшйднгыфциыъачофлиелкджмцзнапфэмлйпуебыгкдшпщфйлчд\r\nшэйппьчщцащмнэзьшцрбаркдйпбипкичмдхгъщчбзмгбьшчщйпбхжжфдщмопвсодиъгбзскшолщю\r\nаяхжрящнэлохжчхпрпидыйкдыпгюьзнйзпкцжткимскампщужжзутмпъшьчиъгхфншючуънтчп\r\nиузшйгаофьпябмйьлмзмибыгучръоуркпуурхпжьцхжйылэысдзъобзлыатъюожщмдвоетмнч\r\nхмйыостюзжкбхжжфзйдшоипбшйрулжэчфхгябшьфдшэйоамлхггйбумчапкэясшюдяйшцпсужь\r\nйыиночфйгйббккцпмпъш\r\n";
            string key = "ЩБНКЧЖХЪ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test8()
        {
            string ciphertext = "юпрайчцщюувлчхжшшхсгибвчрзюжсучссрбевасасеваятмпжиыхьмщолфжжцбеэмлчмгзпрзут\r\nжыъбэшосуюмцршеуждщеввчмлглуйэрабзцфлжъэцчьмубмотакъкичмыиукзгихйбдрснмкрес\r\nщумтмооижшчрщяиавызянвйкчйзэчрзуъжяъьщншуиусцтюючмжмбцюэсзрдюсбтортпдрсэнхс\r\nйэдбвмцрнянхъптюыфтляытаюобвдцрйбаюхьйтчсжеънэжжссыъпячсмхмсюархсжэмхррьтйф\r\nбйжвънщввюоыъчбщййжхэррмзнижляцшсосмрюэрянэаеялябутзупджыцбеьюпжиыхьмщортсъ\r\nсакъклсечзоблргэмзцзнуетщмызъпягтячжъьещпввфлчудтшлчжшзеяяжжжусцупхйкчьоер\r\nюреищьоаюнюйубмоъпнщррсйарвплфрцоыаюноудщябаужтеомръшънпхрцссэьхшуиуъптшеымц\r\nсюбюзхаттъыжцахзрдэачмерэйеъгяъьижиипвжщлмзжжыяжжаещвиаячюснямкцстюгрзжрбвятш\r\nъявужхъжщъзжяъгдчудтшлчжшюснзфуэьвзрюымцрйавбмлэдэссюжещврхйчъкумежяпыяейзв\r\nраюжфшнэйябряшбхыхизпсвшюниисдцъпдбежъясвзеьйяжйыырещвяъэцюрщчмырецршхкзрчес\r\nаупнюибвящпхщтрэаьюрючаяъгжшххяяицсумарлвлбвыиуяжсгъечршхсеижфыюсплыъъфндч\r\nлшсшжяддчмяьсъяыъпччфвуьхзарлуэжнщвтхбмябоъшаещвтънсауптсхшулчайзнфънчмд\r\nкзуичждсудтпдбачранмжжсйчъчлзтъцйхдчсвьшимсцпмтвдарлвцявсфыдстчеыръфхъцъх\r\nчеопзыэпглупязщюжйзуиьоъцчйэежывмцэеэвяъжцньяшеуцмцмаъцмйылчвымзэжъфлеяепмж\r\nмгндчлщоиювыэчбщврпчыгцбвеуцмжшъптщоъжмтуячмяжпжузсйфраареенчдфцссбулкжеъуы\r\nрщювмкуечъкунсеэебдьязшляпмъчищвдцмбдьйтйщжяящчоэенцмшюрювмумыэююеыжудяжщпо\r\nзрццахдчмлииврлвтюыръжсхзакяьпжуизеблупымхнняьйтцащюжмзфъэсрмъпяирцгарбхчапъ\r\nхддакъклцадсудтвиэачмэдзодьецвшэщвфъячвчаасхыяъцбхэйьъущмбеьждщющющюыйжъпмэ\r\nчяшсуъфбдрннеоясбеиещвфэйчзнпяыраялчудтшлчжшюснзфуэьвзрюымцчсыютмзнльтж\r\nбршатруижбжювеяъгядчпщовомувннчспхвъцчжтеомрлвобвйяыдщюссчфъцаъсйежврщмьчуп\r\nярлзмщрбеьежыэжцзносдчеэзвюнюхяцйзуякирбвыьумтдьэсавщячйпрсэвугыешывжщлмгэж\r\nъсчртнммояжмзебъжоъгыяеязшляпмъкузхтярыиумтнушсцююшьмуцеээьблпдбаввщытрдсг\r\nыэбнэмдчжшюыюыхоымъдужюпрайчццхвацщбутпппрдзвыъсеупелпрюсючюпьйщщубвехжпмху\r\nлтйгъжжчлъшулчеущуфлпдшглцххьотдхячпмоплзжшюснзфщжжцтпбчсфайщяжеычлчючв\r\nцвтплбасещхнйтбмцвбюамяжжцбултплбашаюнюйубмъъпкхррзояблеэйзжпмпьурмкчмрмшннюм\r\nцмьрэсрмтяжцзбэпйжжнещчпяруюссввкзйиъвжхавтвдээцюжеычлчеуюшфыеелвмюяпллрсеч\r\nъчитсябещегхвйиывящлъыжнъядщпртрушсщеьцэйшжжшюэсклъшещфькзжремызьячстымяд\r\nпйрйшцсрмшнжудзржъунмюшчющжшърйяймчмбносфайщвщхшмумядзэючйпявыэуйзххяисртжл\r\nвлэйцъоъюпрайчцршэекыпяьуклрлжжцрбэьйхбйбдюнусжжшбюъющйяыйщюбмяжупожвжевеяыц\r\nыбуьтпсъжътурзгдцабяабэешяяыачдзнхжвэзуцзирхйазънпсечсжыпмквлж\r\n";
            string key = "ЛЕДЯЕЯРПЮ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test9()
        {
            string ciphertext = "чсивьсцьгеедмшфещхтшруасучеорзйьмбусовюупншзязеятуяучфщэржбоюпййгрцбабчфтй\r\nчжпматхъкргьювулювтмбфчлпщтрупеюклцецетяаатвнцочйшэртузмщищчфсевчуньячзждс\r\nшщтшхювячьмсухшйьицнсюясрмнъяьаувкцвчлорчюсэмэксзелтюзцншзязеястнсзячсбеж\r\nаьбхтгъьбяьщпндаучсшряъйимродбъжсщсбоэрхыуежакаымбпнвцянъхъгмйжфчуйэювичяаск\r\nюмцвумсбкжехмохсзяэстсдоцэнтрзйьеьчнщхзэурщчлщжъсрэцчтюмшжзожчтояюиуяыпевд\r\nбдтцсжпйзбйдоцэеюечюеясвнвэъюеотшцювязжизщкщфкйасупкъеыхюоътевкврьювумофбмаса\r\nритждочфбюхюпвичцсщктмъезоъктзмяхщфецэтйыеаичьхпцбсзясбкфйцочйццуврмгунжусю\r\nознъохчгъьцжзоэпсшмзхьньцгоэргзянэтысшгчйюумооцгчфжчсщирмбожъсогщйщирщкысще\r\nоиучеюйчббоъэяурюсянсюжумдаальтчтхюпььючфщьиеасшоръсягшфюьбтхюлтясрярсця\r\nкрчпксьгсрнаыяруррьььщпщждмщфбюхыпюрщоэрязмзоппцьйэсусцпцооювтежиеулюоюхчеая\r\nсщиещьюшэхзсирчйъщкайщащодбкфецвщаржкжрнмсодцгоуцврфющцнивдбфчлпщждащищчнодвх\r\nчжсюцыввуъяшрчфозгвашэящвъсхфюьбюжрякмшюцжпзэщэъьнминяьнсхнвсдупгьщктгъйэфю\r\nухфйчвюфхауозжруцюьмоззгчрбчоврррьюхаяяувяунюьмщгзжъочлйщгррщэхэпщцауьясяяай\r\nъетпашкамийакшэкчжззчласкфйцоьмбчсауввчмпбярстйщвьщяюшргеовухтдзяулучйшсьр\r\nчрелххйбевттугввнжоцечоыеэсыпаьтамъйяфдфхэрмнасагмвлбйщирьтасбмзаъпутузешхс\r\nшяуйъгмсшежэмэешщюкьвждсгншзцдсъмзочпхчмцешижчтбируасуупэювиуюеунвмуйщфцпнйт\r\nзжпсьшквтюббэзпхжкзйьнаауъеъшкибюксгюущэьтцшюамаачьрщурлщоъцпщввяьнеустжъйур\r\nаъяювргьсомувгмжзазкеорздьоиупымцошавкеоцкмуррщхюяювюююптяспячхсьзэсцвлцвчтае\r\nдсгнафхзсцвщээъяъвбйбпцпевввпоиъуптяэсбоцчфщррлкцсууюдхйшармрщзргьречсвмбсаршь\r\nптярпкйшщутувжъяьттаетпоъеьоэсусгидшхэрмйааъчяейъоьивчещпнрчоезсщгврщэьъсвлъ\r\nещирщкысщеобчьйымчйэтчнгняэсбоцкхасьйьрбчнклюгплшаъярржборихьждебщьшкфрюж\r\nбщштхнрздщищчнодадбнстыовюхчпаазтвеучрдьлюоюхчрсэясйбкфашвгврржбишюяшеъсрэх\r\nчытрзгплшаъюстуумьщпворяьньчгэсырпьючнвшрмвбчьионййсоазсбкврьюаяэогймурра\r\nыоувярньдяъярплнаыяпждещоузхвпзгцхщчоюйчйынаэмъьуьзащъсогзпчоевчяещмащащхшж\r\nтсасаюфщятйгннысофювщищщцауюруньцтаурщьмнысйшрулянфцъажьеавшбсуехьжащдйпэуч\r\nцсрчштрппьаэпвоюппфъъцзозркмшбгчсцпчцсэясрюхчизаяяувяунюьмщгщмгнавпогййсоюьмщ\r\nпрдъаушяямиечнбчсолзвулощчшссупхаэтщгчйиачрттфвопььауяеаучсшрячсщсжннусйш\r\nруасучкяйбсшоъауясгупбцчтаазвютдчтааеяьньтяшюцпьфуунвоюицышукжпютпмрбпщждач\r\nнткняйбьнзшыпщсдпььсштнквжбощчтаапиютжьопуюжплааъяхщевадчзтвррьфущхшжеучц\r\nааувмжежфыутасэсасшатщждупесбхзаъсасонкяйщмзовцшвйчящожьхэйуебиущчтсхйщкшшк\r\nфрюжбиюьмщпрдьфжчыоуцвроуппвдзжеовоущврмсфцфхэеъйъяааувгййсоъчпоугьудаюцютбе\r\nртюпгсйэеяяшауоязмчраяхэрюопхюлрнввукжшвпвзтйтщъщярмврпеьонвжнвчдвппомгтчмшшя\r\nяеъмусьэптявруфжусейъичцашъэстйюнаюцюждеричпмейъвкпцьячмцещишрптщъйсоаянворшп\r\nярчппющоюадьеэсэупрабцтхюсяесрцзегсшовчоэйдпьвсзяасбсуссздтжасиавщящфщмгаччьо\r\nуробфцгхзстйзащпмтхюпьвашяпфмжбяаяхрькмынсвцсрзкщюргхзццвлясвевврдвадгхаэвуупср\r\nчъеьешиюуръйэпчнюцаясщцьрчпдбцчюалояязаййжфдбяысцвьньжхзмиьррерхэрюжбиючфз\r\nетрчфжшцжесйвцдомщндйълабчпйыгающчфщязпчрьюгвдымэншуфзеые";
            string key = "ОЕРЕПАСПЦ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test10()
        {
            string ciphertext = "цэжарпжээонрэяпъэгюепччьышцбппленпцчплшадйюбйыжщэзшдпибюылссбдчгшьйыуяцафнь\r\nдупщюмлэммвэщеийпплчжцвнгпэчлуыцйсюыгрюывхсэоилчъьюгшсшмъюетлжьэчьяыэмещй\r\nшщдйфйшпччстжэвэбаъъпцфбукниъэзтлэвхзэтючсснюмшяуйдэшдейщъйеэждешжуййшпмвнвв\r\nтчпэапэхдйсыпююсцэмпткгршыпытэмвчьяывдньдрплжэюгпъшъпчэсюплмжбдйржбачьъуйс\r\nыычмшжцнбыыкщсуюмтсшассчзанржшышъудвжэмьсуючбюпгрвцтйрепмвэтюкуюскшкцрщпы\r\nпаъэтюяпчытшжьтасюьвээюмнлжзоеьыъдсюычзсбдймйоэьсшюъппшаысчзкрсомънсзнчщ\r\nыыъндсахрпизищцнпчыизжшюхфпыллшбэйкчпчшыохдпшьйчюыжалнллуъцючсюыевжщзк\r\nпъжаяэсрнгыгихзсюгчюплимчханшфиртжээхсщмлшячатжжмлшътвкщычшчъддтсвэмъюетл\r\nжькрпжхднщплужсцаындатпдидтшкмъчяъдьнюфзжтзбучьэьэстытэтмомьзибщплоизагбш\r\nмишпмтвфпсъмсццшдэзлшъътцбжвйшючютгшсшбщъонбъкгрьбрифчыхуэбющгшьйчшыэймнп\r\nхощаюсгзоглюъуйгъщьуэрлалюсчзэжюмоэмэзжжъасзынщмчрюппыгишъсймйцокыыдарнщощаю\r\nююбшьйжюжчафстмъпыдамйьвжцябэлюплйюыгйтшытршышчпзьйпэщюмтнпнчмчвюпъщэъэх\r\nъйаъьвыжъжипуьэдшлчкпкщйыащъавэщаьэбнщщркнипъыхптьйчюмидтнщаьмщайишкфшзыд\r\nьсмэйоутщшфнвдээндэыюыимултэгюэшууювлдиюлюьыцкпыгцюмжуйячыдтпжжаожйкуъмчэ\r\nйшкюртчмаонвйжпьугармйчщъчдоньдлъътлгзпизжшючггпчьжгваямщимргрнйыпнзжзаозь\r\nсичэхзиасщъьарюфпщкнщжъддысэфусбддвэщчшчжъдапымээщзибшсшодябмлэвмрыжзибпыц\r\nочякаожпъшъджэрмсхэсарнпчкдтщябдхнмъшрдцчпъщйщтжъищззлшъэрчмсьдрзжээтсшдзиы\r\nвафээншвчюъппьовнящалъкиячяхэрмэкмъыдаммшйчъызщптпмъпязчъюыхзсцъдыснйзсъсв\r\nышыъшюъщьлэбншщъсафэьйчшъыэдсштуыяцьпюпсръцтаошкшоэзъэеыкчзищуарэпхвэцюлп\r\nвмъьньряподачюсрмтнжчрыыиасюмазшлшщгъэхрчцъвкччмчьышрбчгишпъдгйдпешьъъсг\r\nшсчшъжчибраэъжэвножткшкцадзсщйяасюгчшымъйбваишкхршыдвнжэнщэшрхйамвваурийошй\r\nеасыйрппцясрзсйппцясввггуфцмьъъйдясщрымъвкщыцшччвчпысирзъкищсэгрултаирпирщарч\r\nгрьэлпэрмтйммпайвиоэтхпыжалгршэчъдьюгшсеоэбцамншэнъцтэечыцзизуаожтдчыятврэуй\r\nонпцнрнэнипювлдипцясбнцбюшйзацрдсюшйпэьркрсщиммсющшсэносцвхбалджъцтйянмгмьшюнп\r\nчыхюолщкржбэчюжъчгысфувшъшийкгрьбрифчзэоыътдышпнщсрезтьыхысчдэржпчуучр\r\nхгшснхсбдлпьснучяъвнжшэъчжаашжщамплчохнтнръмзчосвгуюжтйсъщэзйцвкбрцдрчясвнс\r\nяююжтукпммгллццшсюсяшюсюлгшсшчьяыфйьбэмрявчужоащссъшбюкфсснадечкхыичрмт\r\nччютаыъэбчкфдсжтэдькбяэщзцожюшошяяигщшдлучнигюыгиьъщдышыфмыжэмбшолюжшвъ\r\nпождснзйанаыфщаввийльйуьазнйькйнчяыэячкчьсчзшдъщдбэцтйрсьдуъшрцлжкгрьбри\r\nфчэшяэсзнщзээщьяыхпзмвчзжзчбсщмлжшрфысжйосшзфбьзлмпыдамйылмрдшмашклшрпц\r\nвтуойщэсзнуепиысчяъбупнджшалпъжэоыпщшяжждрыыющггкгуржщйншпцмздиаоэлафнэхэрйь\r\nаынэюдмлошымюбэднжзясзайьншмвэзчдмээнузъвепюоэыжьжйцчыеоээзипэлафнчзеспыдб\r\nьяэдиппмъшъъасрплснэ";
            string key = "БНКЭМНЯРЭ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test11()
        {
            string ciphertext = "ытцсщцалэтгщмопьюоьщажпщтюжажпозъьгвэщошхцряястжньзястжаъяъйвшьмвкдтьдйывйю\r\nпкскэйажмьъуешпйпмщячыястпсапсжывяяцйпсяйаздузюрчйлжучуьуупшюмджлхнщипйяьъп\r\nйтжйныогамбллясвйохеовлычрщясутрвяъгчуъълзащжкшъъсрущжпэмэпфолшйгхямвкркщгур\r\nтруьлцассазгняэмыломнэмеьгтвнряцйхщвжбмкхнщичвожнщичйнжжщвчьзтнщипмемпэйрум\r\nвзювцвъсляхшхаугтхчьмллъмэыижувяъмоптшрчкмртзсэмяьзяюыймлзчучймлшъсежцпв\r\nчсъмомщтэуулжушйазлжщамтсчмощтюжислсоьъдьяжьимйдяъмэсчуячуьтдукзмтйъьлж\r\nпьълцаютчымилзмяжпзэщмшпжмэтлцадсхтячыяыытфчсшютшьзсмузшгазмьзэьазмрлзм\r\nяжгышщпломйлзмъьгубвтапсжыожчкйхщэсзжяжэщяцймллявюшюмпщпжуъйщтхтхажсяупаъзхю\r\nдзыажяшьъмойзэегхйдыщяцшожнэцтсчечщхчымжэбкпсгытювутрзэбфзжяжэййзьрззютцыи\r\nхввжлвмжпэсэшпрвщрцшьмвкдьвмлывяпсгыхчстьркзшьрздщщзьгхчщжщхтхбсъпмщхраяза\r\nоизслщвщжппчтплумуяпсшдвжуювюжгстшсазззлшкукцмъхйшддигзсасгюжщяссризымэымжэб\r\nкпсгытцсщръртжгуыяузюмджлвэтиазъйвнйбымизьвюшюшшщочзмьзькьлижщааъмомввгпмя\r\nыкюстумкзбучйлгыоиюшбжуфйюмфвэщяунрззфрчмажсяюхмлпяайъжяьлтобжоптяычькмм\r\nборцнлэбхьтгывщгптгнтсочыядщэегхйхчтэузайяъзъжяьъпйьеяжпямжмлпяссшнлжмйвлвд\r\nьнщрпъъсхэсажмиетрчмхулюсажкпввиюшбжуяруюлмуюмшжхолайэнглжщжбднмэтвуръмччса\r\nпсжыбжптмычщдбмйдыщфшхбжпоуохятзюыуьлжьбипйймывцтмхычяьнадтъэеъжамэдрчы\r\nядзаоюцяжощфпыпмуэещхнжпоцимкрзэшуыгэзэеъьгубвтапсжыолщхижьогбжйфмввусчтзсмщ\r\nрмуяещшхлклщтцыихйагямлозпезхаззшсяпйгсовутлшрэсвхпжщовлидусврщхцьърсэрмубтщ\r\nшхлклвфкыяьзщтцыяпчкйсжарлэмазошмтрвплиъсйбыътщайзхядтжфпръйжорьыяьъссбмт\r\nвзътчръмощьюжамыкгяхимзювпмяыкяюхмрьзяройихывжбьдрзэжбьррбвцапсжыотюпкмынгх\r\nмбжщнгтьдйытяюпкмшъерпйдытйщхфцновлжюьларктппющрчтгстсцзможьярутеппысазшлн\r\nвкузпгшщсяьъоыщнбьъмжасюпгпщвычулхцврпмяьлпсбхяджообжйджщкьлижщаарймлтажойм\r\nлыщмвмбжшзйгйньзювчтмиэолщжкытцсщмеппысазшйнтиуулхкэечллжьысщчдвзсрьтдзщ\r\nничзмкзуйцьмйынрплошощяюпкыжвйапсжыймэмйпсэегпямвкрцфцстэьъжэззшьъжямэврпзом\r\nывйазъузямшппдсояузлцьвмъьгмьэюырмуяетюптжпвпчышшщауппахчкрпшожнэйщмпрззазж\r\nлпрттчлъфетхчрмубозчзчпсяйазлжмщпумцйлсшпзгытцсщузщщщсюшемывнчзлжщнчьщпг\r\nжщгюмкмывуьтпрзьмэвдьтвучсшытцсщжайэвяаргщовиюхастфйаргщщвжбмкхащфкължытичж\r\nумывгпмяыкясбсгъттсбйнмцовшгщатдупоахввртьдйывзэжпззяичуъыщщзюхлпвщжлжжмыкя\r\nпсмжщаебрмйщвычумйтдтюжислсюрхйпшщтчйдьаэсазгояшпьвмечщяцжлпьщхшпюцчкпукижэ\r\nолюшвмыйоюжкмчщхчжлптрупсгстгарзмьзювувдуыбцюжйднюмаздтяъмэыипаястжньзястж\r\nарзасюшщызяуутдуыййцъдугтмвшжпвврппюжвтйбаъзязащжппющркжжмнвищжпжзъьжхйпозеруз\r\nтзпупомтыовуьопчщуьппжнъйэмлузьыюхлчтвггхпзыщжбпажжъьссгжыохтмаъяаююмтйзсс\r\nъьмйзсееылхмуерюгщощучлажпщняцйжптгозшытцсщжазлысрццйящжщжаугдтюпжпыйтчрмззъ\r\nюэьмсхюмджлхзыевхйхщкрулмжбтруулжу";
            string key = "ХЛОЕПХЪ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test12()
        {
            string ciphertext = "ээбшжааьызыяцржчзаастухлузчъничяъэжцпсцюжпшсърмцпэбцхйлшъжйоузпюьмаюътжйчря\r\nжзгзнвжзпошышжбтнбцшцушцчмкчтжцыипуяцднчыъвхоцьдчхпучугмчаицшжлаюяцпочпяэ\r\nолпюъшизбнщъыичпбшжбчъцдлдщежбзапщысхлчпыухйусщъсмтижбзртсчццауечлмпзжцяс\r\nшфиглкъщсшсхобжанзмщнюыыъщэчяоъюсусхцфнцъкмрсшяйбщэщчжбьсеярякряозмашъсхль\r\nсдцйдютуязшясучжпбйырмпъчыозлчъцмймръжсьдэсчяизшжбюшящжшятгюэббпхаьътжпбау\r\nжужуъцсхавшяхпяуымчжхаюжюмльщаъппеэуыйвуяъыончыыбжпшэсчжхтсщъропюыхмпзэзб\r\nьдтиюълъщшлщплащжшчгьзъбрмръшъкмцшысмоажцжзърахжилчзтълрршжщуъаеыццапыъбдю\r\nчыжжвмшэсыузщсуъыяпюъхузеъцдлдщюъсыяцржчъдаьяпвдюсюыышспюжздюодакдчцсязгрф\r\nяпудэшътпкяээжмякъхжсмрсшысгцеысюгеъпсйзафыфшжуочлщфппжумльмфбзмшжглоъджшб\r\nпочпяэхлцтуяйвьцбпыяцржчзмрецъзъзтжрцйчшжщхйчсбэпэбэцюжипуяцмйлщаыучбйьяжюи\r\nсаъыпьвбшпхтыпхмбчсбцдмашъсхльмюъыичымшшнуюжаирюярлсппзлщуъасэжулкзбцшцуш\r\nцятгсэаълмэюъхппшсччжпбйчднцппиыщпопъсыдеплбюгеахжилкцьяйдтсчыгтьзюжьгьщъбж\r\nпбэпчпщщндхмющизтжцаэбцхашмэявоьзжаумбибхмйчпжшпфбиббвгаэхчжбчъъбзърнбцшцушцъ\r\nйакъижявзээлсгхсччжхюэуыздшйбшжхъэщъагьяъбшцпчбцйдщшъзэгщнчбжачвюълцучвшппб\r\nжюжуцьжыэдбчюлюжмъыяцмфпэрдъдщжжрцйьшыхзмжшъщхйкюъзъъаюыдъъисзбгкчыъумеьщ\r\nаъсдбнаыгкцзбцйдщшътжяюауяудчъцяйъшэбмуггстъплчяъшхицщъсхялшяепйпшцажньежбррн\r\nщъщжьлэрймпбпжчумаюышшцпоъэмдрсбътрншжвмйьяъбшцпчбцйдщшяппйьтжюжйчтыцдпошя\r\nбжюаюсжулксбысзьщажлнюжыщъгрэбцднчъэжвдюпъзьраъшъяоупъэфуьждбзърфжжжяъсажуъ\r\nъчпвмльмюъсгбжхжыичввыольжръьшяибцшцушхжыярэюапячзчжзмшйшъмбчзяцмоьнэму\r\nмясубзацлйягжпъцмумьъажллуэржынуежчумуьъэпжуъцсмлщэюаммяыяухахсжбьдтжбцшцуш\r\nцъйакъижявзээлыэщюдьпъвзъщыачвбцйдщшлщтмшэужнгъсажрйнеыэжплшябжюаюсжулчсщяз\r\nдюжяэдлчолцжачсършпбчъзыярэшъсйуьцыйлксжтжражэыглпкцътнчщаыадзэаюжопюысум\r\nытыьугчоажсгчежазъщжпуйгжсчыгнчъъьлъщжосыдрэьщжещифъьбпшыьхуьвбятмъэщъаг\r\nьцшашбщнаплраавжвоьплхузэжьжтйоежбзапзырпожнщыищюэцашцпьябыъэжыъиьуъцсхкьп\r\nьяпкчщъщжььъцдлдщежбргэжбцжйчплщпачъчъйлчзсъолььиытгрсттлдрмцчхцфнцъкмрс\r\nшяьъафыапйамьяыжуючъйзерэпыяцржчъдаьътжюкюячхжпыяуйътдяцжбчпжшхмюяячпфпды\r\nзыъээюътмижсъолььиыщачъчъйлчвщяыпущъбсдсщъбймувъакъщжьячгчшчъясччщжжль\r\nшяюжкьшяэпргчжвлдщжпшжмъсаязгршътжяьщяюжяюсрыздшйбшпдчойжыярнэяймгьыщхбпуы\r\nчцгвряцмйлъцсхргсрчцтъэбъигыьяшйпоьъжумрэжпййушыжыяцржчъдаьяпрмчщжахуьмслоа\r\nпыяипочьъжьъвшъщцпшжжсжуушшжмдвшяхпкчъцылйощъулдютячпчэнцжьгпымчжюкюъсжх\r\nжжьчпргнйжяпозъэжцутыыйъзнужтггсбшжхачжумпбаужужуъцсжгъчъемпаааяпазчдтхтъчы\r\nххпбшлфрочъбыяпзэщдрмчщжахяьпчътртпывмльлсэпуустътдбэуъсмсэссэячюъщпъщдяыв\r\nочбжбымюныфжфучъсхнюжнцжктэбцжгщъцсхпбаужужуъшыщмюяячпфпдызумрэтъзгънсбьър\r\nшжчпгаужщсчгсбцйъэжрлсгчежчдфпзжцузеэцпзъзнпежоэнърбдтжчжугожрлсъяээжмопъюажпб\r\nчячмлщищывмъаэпьлкзцывмэцъьгхаюсжулчьдэдяцччъямюяячпфпдыызмрнаыадаьъзйфп\r\nжщъвмээйыыяцржчзмряэяйлчсюамгэайжыярэбцшцушхжыичвшъжнучяцпащэтъжююньгхмюяя\r\nчпфпдыывдюсуьмкшмхжыярнщымдпржюззржужсгроъэмдзчжюрмыпчдзоушчжяпрмьыпаяээм\r\nюдэшжъкопшыхмлщэщцжйльъьмкшмхжыичвъралчъцмфмяхжупльюжэдлчзюъздщдыясдащъб\r\nжющэщюьдрчяцпялъцдлдщежбзачпщъалцлшъьнччягпщзэъюмопдыплмгйчднцкюящкцупъшума\r\nюдхпяамчднцпюящйпшсуылдбьъъвдюнгыггщсбжзлцтуяфьуздбгауыышшщьржохпаэгыхуьж\r\nыцжапчыймпзэзбжйьряаумаюыщжбцежжжоцтыжйюччмрмпщавужхцюсжьетнэшжоюсбюжлтсчц\r\nыяцржчъдаьъзкъвсцл";
            string key = "ПНЯЯХЪ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test13()
        {
            string ciphertext = "ешяйямбгмюгюжхшаюштпощаняучжъкпкпеъчпызацшйсьщъкпйльрюзмщдцщпупшриммушьщгыб\r\nюъюихяаэюдхщшжйпышьухгкчвжлазьчжмйгзаэцымаесияшячыебчьэчшъзцежгуйацжъсзрс\r\nфгбыаасикпщгъкнхфшыгпнщабкбйщшцвсшъащцохщшжгяьчтэюныррьшоукхбисвьвъгвжбрбидм\r\nюкжхожчйжщйлщахмптпдимбикцяляьчдцкбууюызцжшььхгяптбимфбюъхгычбълтхршщждпг\r\nшчогрфшждихюсвюоцщьбепслщъгйсшшъхпйшяуюкхтабмпйуцчжвышфхшгйаъжктпшяуюкжбждэ\r\nыхбазьочугяфпвпеыцфмарцейыцлжлтйцяцъдмчдчидукьюкйъьюлиеьчъчиежьюцюрмасшм\r\nбрчъдебопчълчикъяфпьпдюкпыбцяхгущащнихяаэюдхщшоифупшьхйщмщъхптьйжллхоулздс\r\nуюыюплщатиссцйязлжюасвгкчтжсгуаесшяььуъъйззфчцызчыжхйфрджчпыбсушльцбчие\r\nжюатштжсабепзпшшббвюьцняжбцжэммщшпгаыщнфйржтфшмпйьзушоучжъкгкьачшйсьижфпяа\r\nеашоцбсшиежюаушяьчтэюнцъцыщплоеушхмзъжафшщсаифукъшиоэшшшмбтьщбюрдузчжнеза\r\nчинпгьбейтзцыбйыпъъъохзасшхууьсмпьпрюкйъьюяббкпвърожаемэпсузчцгмьюеюлчьачх\r\nщяпжжхтиучъеохвуяхоцыбацпучъжчпвуцсцыупрбмршзедкбхядъфюзщаыъгубшххбыбцдетшю\r\nьчюйудьшяйжщюъчпиучшшяььддмсзрфотгкчушфгззсфбфжюасиежчцтшопвъякбошшхцгт\r\nуыунцмшщягйзччмепйьхшиоэчцщшьпьфшфблзьягйучщылмжбюъдяжачжъпйпежфчучдццд\r\nвюабмрхщдцщгвчюпмчпташшихбохмппщгжеьпобжкгучдымсгяьэептянэипъуюмлмжжюъмбрзсш\r\nщпыщасюдыухсцршаюлпихяаэюдхщшзфгньеаюясьщяяйгршансукхчнлсушчидцещылмжбшсис\r\nвюаыбджтдцщпйьцдлбхяьэейзпщъдсвчдъэожаемыомчтэшфхнеьшпззцлмймъцыиожрюъщпкч\r\nтыимжсшхюсрчжъйрпщиыйбпщгжеьпыутйрждьблпьзсэцжжююыдсрчжънопрьалйзуеящсхщга\r\nшочьдшисзуюэцяьцзыхгьъаэныпшюъэгсуубеуфъцжгйфчвчшлжяаэюиулабмбспдмлтжшовю\r\nихссуиыучэчюфхюащифпщшьюежщсдроцеаюйпууюцидзпщъмпорсэлаупюячрхжвжхймъцдбйууц\r\nяхпиучжщсрпрюкгтьрримдхспргыбочияжтчыхожуфуидсуесирмщшжнымщнщйрпщабцтшаеяхп\r\nйшьчцгпаеыхщъбаыбдмаечипвюшъхпйкхьшцжшьсшопохбншмаеснгзтабмбзчйчинучжъэпсу\r\nзчюкйчзчцлхнлыпдьуздфчзпежшеьужяяйпрюдмрпзчжмпъщнфэгсзасепзчцязяььуъъйззш\r\nьггууюыыйщшашшмпвсгцйхбсшагэчцщжлсуеъевжюаиийорьбмоцпъыфпптаьжлжсвящрхвчыро\r\nцеаачбупхымлхщрфицьпздытыосткгкпелшнпшаыъоцетжфлжрсщцмжьвчиежъцъмгпщсэюерь\r\nхгюямышщгуучжэицшшшчидзюсчлтпюьццохэшшкпкшарнмпщсыърыеаухщяъцъягыабаитмзсж\r\nмдщюфбмбсьщжчмхвсюкйрпеякбрбьбфйвпюыюлььдцшмсьюъщдмюапможьюуньпюасштдпжаю\r\nехфшогпкцеашисьйчжгйчзуюкыбуызйвюьвъгйаьтипрьдэцтмшочжкпбьюфпйчэбмрмадлщъ\r\nзчъъможхьчцйвуцжрйышьчхщмвсриммрсчцаыеаухщысфррбзчэнхьмдсэияхбшждяььюгцяп\r\nпчмхщтчеэцыпуъшитжюазлмшжшцюгпщгжеьпчючжкщпцяетмюеашоыэшблйжщюълтдбсшцнжяц\r\nябптъаэхпмъцящйслюъюохвуяхйммеъдихссуиыучэриммвюымрхщдщцсыьучшаыъаччйждааго\r\nхобъппнпрчшешящдьочугяфпвпеызльцбчиежюатштжсабепзп";
            string key = "БХПСЯШ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test14()
        {
            string ciphertext = "юеркйфхлпгпсрлхчбетуйвьгавсхвсргежмгэщушясждбйупбгыйомпиьзызтрцяьнлцупыцупку\r\nьссргетуьнжеувлцэчугзсвшвгвоьщжжкщйбчпыйщсьъррсзфягящеуььдпмавкйбймпорккубй\r\nлкзюьрсзгпрэррвыаовфуивмпшмлцвгьджмэыорпаяькышгжлюйцпусучбаъпучтлпяылвуфяу\r\nячжтмжльуыййопгпгухагыярйнсйдумсснмзпгакфшхуомкурпмыпвршдшущюсггрыыэчпгаьэх\r\nърппбеужэпьзыокрщтйдюкоххтпфюессфсргуьбмвщмрэйшжэтьмэфыежцжйьмжммпълчнкьэг\r\nьгьвкрьгымгйщхвйммяйдхупидхйьцсуынузсьохппайшвзйыяцтсстсбдэоктчйсшэезжнохф\r\nреьпонтмжрысрлсмщмшжлбзшеусыэбйзащсмюгьичгьцодсъавсуосзъшммжярхепвгвзпзгрркш\r\nаоцтьлфытбугыгырзукпкркиьхддссмрзукгщвпьосжаяькышгвмъежхэуьгщжухиясъиеьпюб\r\nйичвыьщюздшсюьрсзъвеммзошйьжшхяундъсэсосучбмйытрмпбеюжэаудржпйгтжаууйзроми\r\nчвыьегжпэйжплбфяадьхящйъбапмчбсшхммрькрочяпзьежмщслгябздшаьжъпздшслыуглмре\r\nщдэуугзььхъплчиьиыидчдюомпшдгячхылрпугамййырпбчуылояхоьккхзххлбйпеэпжцуд\r\nьпоццйчркщзйыяугыйзгтчухырзгыящснжыузгщенжуежсцмужвгълчфполопкпрсгвгжпбежыи\r\nсшцпусшжйопчфыьйсвъамщмуайгаткушлжкссшжнгжалйожтпзмюютуйльзрежкьмжацзшпштх\r\nачгшмжавмшсямвйгдссмжмржюржпззйьдшмуйрйымеукурмплпжпиоссдтюуььдпяиещмучузыр\r\nкшаоцхпрксрирмбсшжсйыльяксчрхлфьрйзгоршащхэгйзожьпубышъуппвтмоужьмсзхчрйдд\r\nтржалркйшгщяюйюылаззщдюжтбоъшеэдьфумытшпагтмгйьдзгличнньщявзпгсолсмбчщпыэй\r\nтгшпсхзфумссэжлрмкурьжмпуъайжмвйгфуяжпогжюшеохэгсчэмййуафяадвмвгмнчпчзьрхкшр\r\nбмупйдзфысогзмссмыопугжммшэджцщсвьоепмщймжшожащсвуйтмоюмщжзйпнпппыэйузьсшлй\r\nопгамшпрйудзсщжзщщопныуьдзрюшспгтжнчлмжуйсмюйяпшсмоцжомубзшщезьйзпапцдмосгню\r\nйовьмжеурсмтпзмюспзщтндчвьмшмпаюерьифыдщжкчркпаяькышгудьжусхыхдбэщжтржалр\r\nкйшгщпрдщцващнюмьхнммеппкжножкцмщжжундгйжжлгрръукйнбкйпгьцсджнюсэуйлжячуфяъпзд\r\nштысщыпялсщйотргщсомитмйлмзжлглъбаыигтжкэмшшябеячнэмвсхуьйтрйлзмъсщмзаспо\r\n";
            string key = "ПЕКХЙБХЪ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test15()
        {
            string ciphertext = "лвщэъвуянживэцаосъчгбршмъдюнумйтоэъуэпъщпмзуйшжсрухвшмыпячэчьмсэжрпжсйплэж\r\nэюьшыгжйьрэжняжьшыкщящштэщсвшсвфсчъйщэсшьжрвуышйщпэтзхфолфущъоуьуъэйсчш\r\nыащмзугющпщрттэшшжешошчуввъэомуэщвлэжэыжшнеащзоэжэтррьдэвьэуютаощузоэъвмгаов\r\nычпчъсяювъттяммафжъмзтзсжрызвпхншстюрэьщяэяузкюыуерщшззшкщячрымэвъщурщэзу\r\nыпэтшятжзмруэжыщырзпнънтожсщпъшййъжчвштасчъхакзшчпшщэззхстпюерщьндъжтюыуу\r\nсвяэшнатяущрсйтяшяцчъсощхавюичгяеащютбэтрзавэнвшзщънлнжваълшыаопмъдюнэязхяэнц\r\nужэоыизцтччмтлэвьуувъврюыцяосъэьтсышппфаэнхвъвсбмзкырщюокнзйъжэщпхрызщпмуо\r\nяюсэшвщзшлкатрэчлызщпмщгнчэзчрвдшршсщржтыжянухввйанръынбязмзкюмтмыаъсыузт\r\nзйзшттэмкфпшюмчъпзтзсуоэвмэшуюыжбсмэхжзяжащяшвхынщшзыыщсшнатююошжыоумьжю\r\nкщшяйзвмзумшэизрюэтяшэжыщырзпнщщхъжсвшшвжьънншзомгржнтэгузцпйыяьгпщыиепэююо\r\nмнтэгузсвгйвщхаыэощмштшзхтчтчушлщшщрщмсасывхыщшузхфвшмьпятъъужпънтспжэжтм\r\nтбушубтоасщряютзржыаящшйзщшаяшывдщшщутпиьшищзйешячщющриэщъъуйаоьубызщпмбро\r\nышуъзщщшзмъащэтзхфосъсмэхжзмрщаэщмгэоъъшскыээшкзщгрзхыочирьщьеъшшэтсзржюанр\r\nъынячрымэвяьмлвайчожвпыютрввэзмущюжъъжзкьшъьвыэъмнэйсэюсщясщхзщфшшъхыусщм\r\nукгсзурщррмзмяююмохзяээщжющошууъмэвювщасзцпозйзшьожчюепатыизжьюжьртоасщууюы\r\nэпшпэююузраопэмзъвнщбхзкшшыжпхсчъйтчжерзроуръхпщыиепэююошущяибчсщяэъщхуолъзм\r\nяжяшяцщсжзшрщьтутуввортуосссзжюайэшпюынчъжнхспштбуеузцчъсшнсоснкфмтфаочзя\r\nщкъшыаънборщэдрвжэеэошрожнъиынюэвшыщыэятшшотрзавээжвжащчмльтгжьмыкэнзрищрпр\r\nчзкынвшкщшасмсвгйнхзщзйвшййьюутхшбтзмкщъжтшуатаърщыщзюзмбснръынюррьхакрмсм\r\nлаэпштонеуъвтъъэрравпмюкщхнъиыныащуыбшнчюуопсярютяиынсмсэывжащчшрвщснръынж\r\nнчъжзщзнрыютзржуйдрщюотьжэщпжянзшвъврмъдятърьдтвцщшнстъъомэюьшжйтфсщууытш\r\nрвжащчхрэъоухэжшщямкзчщшлъдэоеъшкщаэохвщьюузмыщюшщцтусзфпэйсчьпчтччэмыажо\r\nмоошасрыаянвмнтаълутяюсншсттэъяхзтшзшяыщшяшшшбьржроыанюряоыизжюъэдзцьчым\r\nзитъсыруэщъъужчвъхохтаьмвутыэъшьйттрзавэичъхъгсъщпсенъувнажьрзжошуыхмаълч\r\nмыюэычутжшмвжшеныуъащохтхятъъуьтпсзвхоэнвммювшузвбпсщрттэшшчзкжнвштчошук\r\nроырорвщсчюппюанщмфаюмтмитъсырутайшяущячрымэээдъжпйпырыатщрщмувюишвйачшслт\r\nэжлщмптшвмлъбяурызщпмвхюолъчгпщыррвщжжъуйэщвчъжъщшхспжэжтзхфвюрьдэйвчшчвоы\r\nизцьчсщрйщъэънсорэямьныэъшьщшаолвщэжуэжняжьчгюзэжзмжозюсувдтрзавэщшщжсвыъмр\r\nутщшвжзтшурвъврущъвяибэжаъснузтзсжчзщзъъхтвыэерскыныупштлфущящуышнэщъъишсщ\r\nпьрзящчуъдюяэутхчъэчхпччнжшрблюшсмэхжзхроурхжхыюсччшоъжвмнсомярзозйпмьст\r\nчшнхыщюшщцдччузхсзссузщсшшышсвумжутъачьжящюшвштрнынжщпэтзхфосъымфаадъжп\r\nйшмвхыщвъшжчъсярстэшшжшзвдрнцзщошьдгтзшяуйдоюъпыщпмкивюнвуивьжзйзщусзфпэоь\r\nшъжъомъщхавючюатююоруэблдмыакъошмрщокянтанзмшдщртмущрюлып";
            string key = "МХООНМ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test16()
        {
            string ciphertext = "ьмъюртпмгйьрзхащбдщшщояэбюроллргпаншщххтяжрюсънуахысбдреаакцршфпхкщебшеяпхъ\r\nрпрэмърнтчяцоришнфъюяьржзэяуядххмянэкьвнрпуеоцчбблнцбфщдцббьсюяьеялпрънааюф\r\nшюувйдрйяжюдмпъчнтбмяднхьрбнярряжшмитюэтйрчрцщцрающщцрзкясалиючойрбнащлфъпъгк\r\nрэцъссеккычнычпъэеякфжърфкржъюнбюспеушючтняьвцщрртнстплбеэкмрхеюфсжанцъсхщх\r\nшбюаюнющпжпнччпрреанежьуущйвэечашлчящортьбятрепцяулвжвыэшуцлшойрбнайухпфжэе\r\nсюнбяешьбязюулвжъекюечацищмячпдрхэвяюряяшноурыжарзнсщцрршфщддбеашхяпкяшнузнс\r\nюйлыбъсхжукмынжчпърнраряэнфькфшсткибщртцдчвйхчпъумрылызхзьхбъюкцещбянпгязв\r\nжчуъфежряжбкдтхцкаъаращмряеьэютцьжэхцвюшщмдрмягемараомиакыгйрэлчщцрщеьойрщмърн\r\nфчпхврпькыехрщеаэюпуйянвжчебзхекоаоблбеэкяжрнрйкрянэтетпгдшмъэнчщаъаджзюочбьн\r\nрнькжрюолмлшхлцмыяетаюэкмъэхцойузнэкйрчмфщвибдяьянчкмынсчдбыюккбятрхцьялр\r\nрающйесчяэтдяьеюъхпуплвгръшцойрюпжюорщджэрдщншщптцогвъфюнбюхлъпъебибюжаорряосс\r\nлчвжээшпяцщняпбъюотьмышюибяпэенпйбзехарсвеяуоаоблшэчщисчкыахньхцнфишнзлйрщ\r\nнщввиайъьялбсяехлряцъюяуюшойгшюсэюцъпыфхяпряынмънэврлзхъэюяплчщцрахэкмиудяуе\r\nфчгащдлрьжрнуоббапдщечожлчмязхкэюшщптцогвърбпяякцурсжюлэнъамрхечвъонджьяпьк\r\nыехиывыэнфщхшолльоъзхжьвжюйлэхутъжукпшхлахцбюзьъющуржебыюйтшщрнхчлсюееч\r\nкжтсыцдиоежаъющянчкмыснчпабозьъышеибяшъшжкифопдзржъеибнхэшиююьшеткнюъехук\r\nыаэргечкртцдчщмрчячщбякецтмхумгвххчяцорргмъжюпурчйбсчяэтдяулыэдизяжянуъпывл\r\nшьбъюрлзйъъпвъжывяраряякищмъшлижддэютчдчйлрюцяэнпънрщпюяебынтюсюехиыпъюялос\r\nюокдтндънфщъчвциююбкетююэтняухязадщхыэехпбчвиръпъюотчбжсеящшзънуахзюйлэтъэдр\r\nэхчсепъншогдшвцщягчдяююпчерщкюхнжыноьвжюрфчбьнррзалзнхпмъшночдлшхондмшхл\r\nьуащдлбеэнллажжзэбьгртфдбэсщхяайъьоррхчэнубхьориэяэтдвнрсжъжзхьооопвжэмъудэн\r\nгдгхбзеяьъсбмлреаюхжурлвутпгщтпъбнвтмиайъзэнчлжэээувцщйдаюжаяцрнъъсйумчйууькцщ\r\nгхуямягцбйыщяряечэнсчпяуюббясщхпьпяжлиюющвотьглямлзхьэнфчяыпхтайячнлэечвюя\r\nтпжьбуънщвмдуршойрдхгтписнхояжьоъапиянсокванэсюжанръюжлмязхшщшжсеялцыфрряшш\r\nболбэбтаипбцщлряхэкхкпяцоблшхфчпртюцкбътючэшиьлшщлсшешашфчечэнгчнршсятхащ\r\nбдщхпэехпбчщллщхбапрянащмъюнбюхлтювтаъшблэсйтечсюжлнбщаъыоавйдвгячпииюоххмч\r\nтыеетплъаотпбэнрюабъвуучкуоряпцаофхпмбыхичактйжкдэнбъънээеяьъхтпячблдпдянцвх\r\nуънэкгррюцкхыщюбапрьржзэуббжжюгчпъсмъедяфнхщюшщядэшжыпвъмлтбкоршвбъъкяфхфпчц\r\nчпитоавмлэюцтклзюшюнряыятрлщджшхыююьшеткоатбъхюоатитеаокющшзпчхжецпноуехт\r\nлфтбяъюкпмжвяншчхтмргрълрдфхеъюяуяшщкюзнюъевреэввищючщаршэивмуббъпхкщебшеячб\r\nющджреауддурддсххечвесчкъуеяьъфопдзржъмрывжъррыйъъпвъжывяжпкъаншбнцтоиюэхвмр\r\nрмыыхеупдамдшххэшитечкцлщнчтртпйцбчжтбдюлъакжэмъухчюртцйгвхжпйшойряейоклснс\r\nщплбпдынфчдыаеолнуэнмьгбапрьржзэякуевппантзюущняыюхулыфеузхщвяушеущбдщхпшщн\r\nчмъшхшуяшвщжчмяваршежъюкюсивришэчйифьдшщптцогвх\r\n";
            string key = "ПЮЯОЮД";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test17()
        {
            string ciphertext = "кяавсяжацмьязюнпмюощсвырцклыэчзшпюэыэпжпннжысръдоягтюммятърлыруякмчнрруш\r\nфпцщюзждепуьмясчядьыэвптнчтявзжгомчожрвъсшъзцшндпеьщщхззеюнчъъьътрьпэвзмсх\r\nпыьрьлхпаяьчжяхппшсозгрхалюрсшгбпоэяхлцгпппэмоешушээцяцбхтвчггйлуыжъдпкрцлду\r\nфачоцщюуйипхсъэзхлцоуэпшткхябячюрментщюожицйтзъъхакрлършймнэачпумехмитшрлйбд\r\nцьнкагьлцреууцнъэътдплхябхъожчммьоншулцоуэпшткхябячюрментщюожицйтзъъхакрлър\r\nшймнэачпумкжфгтшрлйбдцьнкагьфуыгуулцнаыэомяхппшжувъсбезррыаяеыцнчзляиъэнвзг\r\nмхрыйкямсйужсщудсятяымсачбчпеъжкжфажнлыдмяцлыиумтрлоэщхфгнавэсудхвуьшмынс\r\nхццжьппзхблюинрсмпвшифпжхзжэъжоялцзшяхйкмбячодщяайкъзгдуочцсышняяшяпхщмгюъя\r\nчожхммьожыумфхурсзагпшсзпшьгнхэысшуъомуычмйгуяоыэвхийюачнопяълцреууррпчцж\r\nъхяъеуыстхцхбуоэдшатррлшмвоццэлюуъдтйчьащжапемчжвугфхршнщмамюззвъжкхпущэтлъа\r\nрршсдхянещтсчжаоеачшшкмкгццсзпчрпупзрзъцмужчузгмхрлрщмпосжцжзеяяуьччхяпрназо\r\nоудгпуыжлвдсбчуьзпбкфцэшмсзкпцжэожцтррлщшыдмяцтушиоцфпйюышетйцйъррпжюшхшшы\r\nяънгяшишнснияшзжкжфгтшхеяяфьнэъузхлцреуузюрчаэягжцъмэсвчгбхещсвырцклыэчзшон\r\nжыэорйавьчйуйзмкнцжъдлквбзшртмиебмиъдццклдсшзгтрьыиыудмювлышышеюжыиыыабг\r\nпчйъмтпхзъъэыгьншзяумхкочшиъхяъяошэзгяъвбзтруътюэззямйхоюзжчщмгхбнзшобжхчэя\r\nмугйлуьасъгпшсзпшьгудчжюшьихпщячщхптйпсиохчрнгязюжлсехтызхнкяпчйэьмгншрсзп\r\nдммьожшуъпюъячожкоеачсютдпъущюиэоцгпвляпкхмойючгмумчдсзпчоещклъычрнгязюыдм\r\nятзысмляяблпмзштъщяжттдпмкьэзпоцябъювхинхгыэчзгсюачаъръмопэизжгьяужъюхйъмкяъ\r\nцмлцпьтпвхиялбзъыцпнечщюмфятъачнъпжпшэтумганъучэзшюкбпяюьпъпюштучмитспвйзжх\r\nихвыжщжкцмбтьюпаягяътямлкеэгтуйдобзъыизрсеззюшьрамуынтжахьлщсвырцклыэщхпмпу\r\nшэфмлпнычпшьжхяззвужямпчнсзумлхопаыхщзрчзщмыляябтжтсгшмуъяьшюкрлщмохлцк\r\nьсъррпжюшхшшяекгщтазхппебшэчсдтезщноимнэхззпжоядушчуйпхлгчэнцйябаячухйхфуыг\r\nуупклцвжщшщэхезчпхфомущюмсмоещхфржцпнтяышумтхбхбюзюякзъъзхцрхахлэжопнвнстлък\r\nучпжъдлццьдэыуъеегячууикбтэапжденъвэъпяъщбзпямхтрртсоымдябнсзумлфьсшуйзтвь\r\nчнрздвющчнтпгфкпншхтиялъзшруяялашэчжюпначжщхпткпмжъдпбхтлюийзьнтщпшпжжбачп\r\nмтлясэыэпптосжцжзпехмитшчугоханмтхлявцнъъймехщгщшъдосочэьдиябгячмьъднблычв\r\nъсныщэчзмбыуупньъмечжэьжйхрьаъррптрпвчюзгпмкьжэьдгязлуюмкчлопньмкжоюзъъжх\r\nтнряювшнкрлжнвшщпхяъриеоярьжаувмзхблюивъсрщячемарначсьпппюглымжлрпчцсьмдтюэ\r\nщжьдлябчсоюлгняоыэшллябюязруляхашиъцацкртшюпфйюбзяшъяяппщъвхфйюряыркмбдцьн\r\nкеяяучээепхрпььсщзмфнзльзхвктпыюмогкочээжйпусъллъйиямдвжвзппюхтзучдпмчщюлт\r\nгкмпджыймтоьчнзпдоятэапжхтрчээзцкпнстспжаяпочззмжуньабмуяцгьтъогфцмкысчздол\r\nцреуумляззюшьзонщтъшыяяъбнэъумшещтмбпмпхьщщхззеюнчъусшпнуцаоыяенртшхвмюрчь\r\nаэжаядцюнззъйхьмиохщубюярзцккеачйыумиеачпшвъсяъзъшилчурьсчздпюавнслъуэакщшь\r\nляхшткщжяквущьшяйкруэнъшояищзсчсгешцщнспацебяъиоъмнэшйкздсвбзохвмфпцсжъдпббэт\r\nчопоуспвйзцтвющчнтпхрпоцнчдмулкщыужяялгчэщмънэщгсшзляьуыжлудждчнырзаяпойюо\r\nхпеяужъюхйъмчьщьхлхщбзшроцяпчнэ\r\n";
            string key = "ЦЮПЛНМХЪ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test18()
        {
            string ciphertext = "днечмаглнхбщдпытлъхдсчвкмъоцшвпцемэяхрэзчстеаарфеэудытмйтшюармждщдящдсюгх\r\nхзиефыгэвнссъояжарыюядальвэяшюекычмыдатжгэдиарлэмяйгмбфнбющтъчбъщшцйъибтвжъ\r\nанздйэчеяцнзтаэдбээляиэшюъияефыжэвмтрыгкмшебыалссвкътчзъшеыцмпжшнсримпыеэюм\r\nачваэпюйчъеьркдцдюухэвмурлцшэяцхвзнйээитвляядхыткйаънуцкстедъдсйцемжчщьуэръао\r\nфэъйътэрськыьэниэлчюхйаэоыйавбвмузнезцячроэчрицбоиюедчрцгядхжчюйэвецщдфавйэп\r\nюйзхвяцнпыышщздпыхвяцнпыышжщзиыыяцекеоибрбэоюедцтаувшюждлебфпъцнуядечъййщде\r\nчзасцелхдйжяцнжцсебикытййсгещячфавйжонсщэдътвнюэпыююсррвчюцешвмхзчеопхзцшжае\r\nфувимжцджданыхяэвюссвржщдвяафжтвэыхкыщдбцволэйхувоарфвынебэдоящдлшщуяаржбшйц\r\nхбъвчсэоеръййънюаючечъеаюхечихшзиезшсценйиэмывчвъцвцюмстбюбъймбхкжжйгядхотму\r\nжшмжчфевшшзцсебикытвнргюшайпднюждммэсмлшцеаждъдхйуебъуйяжхъгрчбцелбщоэяэаэрбй\r\nчдшзаауыедъдисиэмышюпыияпюфсэецъжэвъбэшюнйшинъслйхэмчрлеьынуюуьйвчццимвэм\r\nывоуъымпцсебиэпебйсфеатвнтедрбэояфныцнйхэмызъсувядальвэяшюекычмыжэкжфюархоъ\r\nинамхждщджъйтаефыдьгщэяцвюсэсьжцгйуйецюбмуврмбалшецъохсгънчргачецъцкеувдэзнйэс\r\nмъцнаошбяуйиядерюгаиеедщоэиэмывбижихфдйпманщвбидипждьмщъопдвятедъчщуяаюююмпжне\r\nтюйтпиэчрсржияпюяпящджъдйсцебдйвъзнхдйфлфпыъажцълджлсбиэбвюащеитююфавйядлеуъж\r\nыюиръъгсвмвчришрфжяцшзэлмцъвжцфмзфеазйишецурофъбэизижцыюбекудзнсюмсрэмчюммэ\r\nсмъалспыкпвнжпгюьюсеаебяъдйнинцонеюжбэяавбжръщьоъдюхргсщхрясдпмднтюкеуэмыяоуъ\r\nымпеюссбецтйуждмъцнмюеяэвюйбжрыщавргюхъвзъимъйарыюсаючйчсяхрмвмжмжчистемыьар\r\nжщеэзюсргюшрйичвйътрйэелдиарлэсцтаувшюодсвъьпяэюйэвецщзижюяхрмвэъбжвмьюгстзхст\r\nйрармжхърлтэвмнръзяьаебжъьжхвяцншряфпъдшкждхыцйуъаюэвнфдшецтвщжнещейиыдншюъс\r\nхэкътаояъръщьоъаьжцнмуэяпддхъшющцнйюэмыюуьйэмыямэяхрмяосуъмъэдзыйяъцнсппхфтщ\r\nуяаедбэгчъбяпнжпфпытйиыилчвимжъябщаиъыюцвгйзхючждвяюлбтрйэелщюбйцфншрцецсяпи\r\nнсрекжвбмьдеарюсбимлвгцуъоаюмвъължпнфъбэивтечхнсъэнцъяжсажюйрчзфевъгчзйичвйъ\r\nююръзнндйхъдеуюмвяинхъйиэжнрлшжчэмыяюечднтюпйчелжъэгргюшважцсмжэйвъгюптиьцге\r\nчъшдгэмчюмвманцюлепхньжэйцтръдксэефыдапмдшзопыжартючсаъруюфвъгюэюджиисгвлжъв\r\nбцюлряйвчюъсыхяэвюссвмыячяжхржцимщдюузмжээдътэрыэларщсцвкюбйыжхяъбрцаъубэйхъй\r\nмытаубърждэфаймъфлйзйвжъвйюгеуайпязюодсвъфнбщатжгбъуйхъшюсцсебикытйяргюшвиехъ\r\nмявнжпхояжйчдпечзетъинщесвъбчузкуыдхщрзвсхеарюсбихрбээчецъцйцьвйяэюсэщмъв\r\n";
            string key = "ЯВЮЯРЭЕ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }

        [TestMethod]
        public void Cryptanalyze_Test19()
        {
            string ciphertext = "ейрфыбйясюяэляюпынмирбаыфюешэппяспъшпяенрйясюяэынуйыиюдйыгннсндътиужхеэющ\r\nясснуоэрмжбшбефъжбжяэентйяысяссюфушоэянцлнхифюжтъющтхчающщрдярэкъряэппазллчг\r\nъкнкюэйесэшеагщацлдъхжцнбрупъсноецтисэоэшпюоыюйъоньжяюжзйпчлбллнсйнмынношлс\r\nвгамжтюотбирикмдъфяхюшбуаыуъчгъоьтсийзэзснхтжбсуящгчсшълъотфыигчпвяаннзракэ\r\nфнуйыкаензсэяэняжнйлсжмявэемуэддыаъжхупыщфикоцэдэпхаппояркыфсянсеагтиыхесающн\r\nпеайьашуйывщяскхугшсэфдвпчетесисинрияптийжяеблэлйннюпщэюрйгратъжпяожсйицъпюою\r\nтюсмсншритбпашуйъкъиядплфэцюрпвгшимфгямжцсубыосйщипжхжлахюслаазипылннъннтпкм\r\nодптпжянуояфолнгнугюфыцяъдссъннтпъолкююгчфтлкубтфъпефпюцэтмдющощършунмстхшб\r\nшрьлубясвъосвцэпчъяшбющсгнсггфъжбънрлмфшюбрфшлъспыоъфбязжняжнчгъьжжюэйесэн\r\nюбтчоппебтсрорпъфэйщрржрмфюыюайумадгятсмжнсрущфчфшзбшфьхнцутфъенапровхкыош\r\nовнюшуьаъжпъдюочрибппрспясгтивицътслэфшбтнцыимъфыющтнйбшимнмжнаеплфжтъюшия\r\nшпшьниляаэьстеучпояоюсгщяэзебсжизлмысюяжянбтчашяшффслбикыяспстебрэкьррърэд\r\nэхпдийюшдглднъюьеэйщиюрещупрсгнбпчоьрдыояордбабяиудяюйшовжюэйоашрлапьхнурлмш\r\nаргпъцэмжяебпоичдецсмеплцятйрмфожрсеъжнпшжйпукжфуашллюрсеъидятслйяюгйэнноэчпва\r\nъующцыфжнсрщчиьдпупнлнтйъоюфчсеэйпотхецспосмнхгчфрлмъячоцрдптзишврлбчоьлм\r\nжфамнируджднжэбашаьрмжьюфчсечйсаыдпшпшажуяплнфюлнчзспеирчбажэтншубфылоыт\r\nэьсгнцщтесээцщтфплдызйьюрнчнсяюфпълюотиьжяэсэпнцдсьнирпджгаянпосмэгсюржеапюц\r\nчьаьуйяинсйилдпочюрлшбъсчрббтчфедецспосфнбчзирияптжлсжхжпшяэххэсмсчлмяфд\r\nаюрцъбпдауряфпарзюцчффъжнтпяордебмжишимясзфчжмънэечиръонбэоэчйенэмйъкьфппюзб\r\nзияхеъсслжунцожсиуъхбшсжнюбтчопуйывкмжгпяоюопфебтйооркжишиблджммбиоюссюясше\r\nчбыиьрбяожфзрдчбьошипяоэлжиыжвэяэяхцчьаъжпъажмсббсйртширъмйкэьхьйефъннжди\r\nгжфючйскаехчсьоярбъхрюшрхбурщоветпрфыдхчбълсхяцднужхеэчуадлйэйырмяюсбфишгр\r\nъосцнэхчеюошяюейрфыищцпщяэжхспъсэцмыграплдяйяоылюебщяжяхщбыожянтфнуэтлдтсаю\r\nтюяцътчхюъцсрюрпъоиюпянюгчфэзечйпаылпъмйлжшмъсюипляцпчижынцапрыввягъкнурапэн\r\nнлбюрммйфеэйьаьрцубпиляетпраблджмйннпцчппфшлеюпюфчцкбпунняхжячожкмъсмкнннрщ\r\nенэпмъеэьнунсулясшэчбщоюрлялсрчдгдхсхннюалнлжрйъодфкснфйьаъжпъдяорвнюающюдй\r\nыяэрыилчпяоедяъдэйчивылнрютнбяэсьясэсмиасюэрнхртнрйпкэоечоаъедьжыьтыибъкш\r\nоялхбмэмнфоабптлтсшужршрбяонпэжнщбьфудбъяжлжретпьошзеспозспйялюоыюйъжжесоэс\r\nгрфюуерашащваэйьфшиюугьцнжмъгзтщтнапеаюуйъраъцдмд";
            string key = "ЯБНАНДЮ";

            var (_, foundKey) = VigenereCipher.Cryptanalyze(ciphertext.Replace(" ", ""), _russianAlphabet);

            Assert.AreEqual(key, foundKey, "Found key should match the original key.");
        }
    }
}
